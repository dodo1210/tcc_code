function Debug(e){var t=document.getElementById("debug");MyrIsDefined(t)&&(t.innerHTML=e)}function DebugWait(e){for(var t=(new Date).getTime(),r=t;t+e>r;)r=(new Date).getTime()}function SetLoadTimeOut(e,t,r){MyrIsDefined(t.loadTimer)&&clearTimeout(t.loadTimer),t.loadTimer=e.setTimeout(MyrTimeoutWait,1e3*r,t)}function MyrInitAllAtOnLoad(){function e(e,t,r){e.addEventListener?e.addEventListener(t,r,MyrCtx.faux):e.attachEvent&&e.attachEvent("on"+t,r)}MyrCtx.debug=MyrCtx.faux,MyrCtx.audioFailSafe=MyrCtx.vrai,MyrCtx.buttons=[0,0,0],MyrCtx.button=0,MyrCtx.myrTab=[],MyrCtx.myrTimer={},MyrCtx.myrTimeOutLoad=20,MyrCtx.svgHeader="<svg xml:space='preserve' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1'  text-rendering='geometricPrecision' style='overflow:hidden;' ",MyrCtx.zoomtab=[100,125,150,200,250,300],MyrCtx.myrwebLogo="<defs><path id='wsvgs1' d='M 22.5 98 C 0 78 0 58 0 50 C 0 42 0 22 25 2 C 29 2 43.75 15 50 20 C 56.25 15 71 2 75 2 C 91.5 20 91.5 44 91.5 46 C 91.5 55 91.5 68 75 83 C 85 70 85 55 85 50 C 85 42 85 35 75 15 C 56.25 30 52 33 50 33 C 48 33 43.75 30 25 15  C 6.5 30 6.5 47 6.5 50 C 6.5 54 6.5 80 22.5 98z M 50 82 L 60 90 C 57 88 53 86 50 86 C 47 86 43 88 40 90 L 50 82z '/><g id='myrwebLogo' stroke-linecap='round' stroke-linejoin='round' stroke='#000000' fill-opacity='1' transform='translate(-20 -20) scale(1.4)'><use xlink:href='#wsvgs1' fill='#0000FF' stroke='#0000FF' /><use xlink:href='#wsvgs1' transform='rotate(180 50 50)' fill='#FF0000' stroke='#FF0000'/></g></defs>",MyrPrepareThemes(MyrCtx),document.body.onmousedown=function(e){var t;e=e||window.event,"which"in e?t=3==e.which?2:1:"button"in e&&(t=e.button),t--,3>t&&0===MyrCtx.buttons[t]&&(++MyrCtx.buttons[t],MyrCtx.button=MyrCtx.buttons[0]+(MyrCtx.buttons[1]<<1)+(MyrCtx.buttons[2]<<2),MyrManageMouse("click"))},document.body.onmouseup=function(e){var t;e=e||window.event,"which"in e?t=3==e.which?2:1:"button"in e&&(t=e.button),t--,3>t&&1==MyrCtx.buttons[t]&&(--MyrCtx.buttons[t],MyrCtx.button=MyrCtx.buttons[0]+(MyrCtx.buttons[1]<<1)+(MyrCtx.buttons[2]<<2),MyrManageMouse("release"))},document.body.onmousemove=function(e){var t,r;e=e||window.event,t=e.clientX,r=e.clientY;for(var o=0;o<MyrCtx.myrTab.length;o++){var a=MyrCtx.myrTab[o].unclippedFather.getBoundingClientRect();t>=a.left&&t<=a.right&&r>=a.top&&r<=a.bottom?MyrCtx.myrTab[o].mouse.inObj=MyrCtx.vrai:MyrCtx.myrTab[o].mouse.inObj=MyrCtx.faux,MyrCtx.myrTab[o].mouse.x=t-a.left,MyrCtx.myrTab[o].mouse.y=r-a.top,MyrManageMouseOnObj(MyrCtx.myrTab[o],"move")}},e(document,"mouseout",function(e){null!==e.relatedTarget&&null!==e.toElement||(MyrManageMouse("release"),MyrCtx.button=MyrCtx.buttons[0]=MyrCtx.buttons[1]=MyrCtx.buttons[2]=0)});var t=document.getElementsByClassName("myrweb");if(t&&t.length){for(var r=0;r<t.length;r++){var o={};console.time("Browsing page"),MyrCtx.myrTab.push(o),o.index=r,MyrMenuNew(o,"popup"),o.sync={},o.sync.displayMode="line",o.sound={},o.sound.playState=MyrCtx.STATE_STOPPED,o.sound.runtime={},o.sound.duration=0,o.sound.playMode={},o.sound.playMode.metronome={},o.sound.playMode.metronome.before=o.sound.playMode.metronome.bar=o.sound.playMode.metronome.beat=MyrCtx.faux,o.sound.playMode.metronome.volume=.5,o.sound.playMode.detune=o.sound.playMode.scheduleddetune=0,o.sound.playMode.tempo=o.sound.playMode.scheduledtempo=1,o.sound.playMode.loopMode=0,o.file=[],o.focus=MyrCtx.faux,o.toolfocus=null,o.mouse={},o.mouse.x=o.mouse.y=o.mouse.clickx=o.mouse.clicky=o.mouse.clicktime=0,o.mouse.stilldown=o.mouse.inObj=MyrCtx.faux,o.mouse.clickedtype="",o.mouse.clickeddata="",t[r].onmouseout=function(e){},t[r].oncontextmenu=function(e){return Debug("CONTEXT MENU"),!1},t[r].onmousedown=function(e){Debug("START CLICK")},t[r].onmouseup=function(e){Debug("END CLICK")},t[r].setAttribute("tabindex",1e3+r),t[r].onkeypress=function(e){return MyrManageKeyPress(this,e,"key")},t[r].onkeydown=function(e){return MyrManageKeyPress(this,e,"ctrlkey")},t[r].onfocus=function(e){return MyrManageKeyPress(this,e,"focus")},t[r].onblur=function(e){return MyrManageKeyPress(this,e,"out")},o.origwidth=o.width=t[r].clientWidth,o.origheight=o.height=t[r].clientHeight,0===o.origheight&&(o.origwidth=o.width=800,o.origheight=o.height=250,t[r].style.width=o.width+"px",t[r].style.height=o.height+"px"),o.args={},o.unclippedFather=t[r],MyrSetUndraggable(o.unclippedFather);var a=o.unclippedFather.dataset.id;if(MyrIsDefined(a)&&(o.inlinedata=window["data_"+a+"_varb64"],window["data_"+a+"_varb64"]=null),!MyrIsDefined(o.inlinedata)&&(o.inlinedata=o.unclippedFather.dataset.b64,o.unclippedFather.dataset.b64=null,!MyrIsDefined(o.inlinedata))){var i=o.unclippedFather.getElementsByClassName("myrweb-b64");MyrIsDefined(i)&&(i=i[0]),MyrIsDefined(i)&&i.nodeName.match(/\bDIV\b/i)&&(o.inlinedata=i.innerText||i.textContent)}o.unclippedFather.innerHTML="",MyrCompleteStyle(o.unclippedFather,"overflow:visible;position:relative;border:solid 1px"),o.fatherDiv=MyrCreateUndraggableElement("div"),MyrCompleteStyle(o.fatherDiv,"z-index:1;overflow:hidden;position:absolute;left:0px;top:0px;width:"+o.unclippedFather.clientWidth+"px;height:"+o.unclippedFather.clientHeight+"px"),o.unclippedFather.appendChild(o.fatherDiv),o.isLoaded=MyrCtx.faux,o.isError=MyrCtx.faux,console.timeEnd("Browsing page"),MyrStartWait(o),console.time("Load"+o.index),MyrLoadMyrweb(o),SetLoadTimeOut(window,o,MyrCtx.myrTimeOutLoad)}console.timeEnd("Init")}}function MyrDisplayPlayedBar(){var e;for(i=0;i<MyrCtx.myrTab.length;i++)obj=MyrCtx.myrTab[i],obj.sound.playState==MyrCtx.STATE_PLAYING&&"none"!=obj.sync.displayMode&&(e=MyrSoundTime(obj),MyrDisplayCurrentPos(obj,e))}function MyrStopDisplayNumber(e){MyrIsDefined(e.counterDiv)&&e.counterDiv.parentElement.removeChild(e.counterDiv),e.counterDiv=null}function MyrDisplayNumber(e,t,r,o,a){var i=e.width*e.page.zoom/e.page.pagewidth;r=parseInt(r)*i,o=parseInt((o-e.page.xoffset)*i),a=parseInt((a-e.page.yoffset)*i),MyrStopDisplayNumber(e),e.counterDiv=MyrCreateUndraggableElement("div"),MyrCompleteStyle(e.counterDiv,"z-index:9999;overflow:hidden;position:absolute;left:"+(o-50)+"px;top:"+(a-50)+"px;width:100px;height:100px;");var n=e.index+"-counter",s=MyrCtx.svgHeader+"width='100' height='100' viewBox='-50 -50 100 100'><text id='"+n+"' ";s+="x='0' y='0' font-family='Verdana' font-size='"+r+"' font-weight='bold' text-anchor='middle' dominant-baseline='middle' opacity='0.4'>",s+="<animateTransform attributeType='XML' attributeName='transform' type='scale' from='0.5' to='1' begin='0s' dur='0.35s' calcMode='spline' keySplines='0.4, 0, 0.2, 1'/>",s+="<animateTransform attributeType='XML' attributeName='transform' type='scale' from='1' to='0.5' begin='0.45s' dur='0.35s' calcMode='spline' keySplines='0.4, 0, 0.2, 1' />",s+="<animate attributeName='opacity' attributeType='CSS' begin='0s' dur='0.4s' from='0' to='0.4'></animate>",s+="<animate attributeName='opacity' attributeType='CSS' begin='0.4s' dur='0.4s' from='0.4' to='0'></animate>",s+="<animate attributeName='opacity' attributeType='CSS' begin='0.8s' dur='1s' from='0' to='0'></animate>",setTimeout(MyrStopDisplayNumber,750,e),s+=t+"</text></svg>",e.counterDiv.innerHTML=s,e.pageview.div.appendChild(e.counterDiv)}function MyrDisplayCurrentPos(e,t){var r,o,a,i,n,s,l,d=e.sound.playMode.tempo;if(MyrIsDefined(d)||(d=1),t+="bar"==e.sync.displayMode?.2:MyrCtx.NB_MS_POS_MUSIQUE/1e3,e.page.div.height){var y,c;for("view"==e.page.viewType?(s=MyrSafeGet(e,"Myrweb[0].Graphics[0].Score["+e.page.viewIndex+"].AreaList[0].Area"),y=e.sync.area,c=MyrCtx.vrai):(s=MyrSafeGet(e,"Myrweb[0].Graphics[0].Lyrics["+e.page.viewIndex+"].AreaList[0].Area"),y=e.sync.lyrics[e.page.viewIndex].area,c=MyrCtx.faux),r=0,MyrIsDefined(e.sync.lastAreaIndex)&&(r=e.sync.lastAreaIndex,0>r?r=0:r>=y.length&&(r=y.length-1),y[r].time/d>t&&(r=0));r<y.length-1&&y[r+1].time/d<=t;r++);if(MyrIsDefined(s)&&r<y.length&&y[r].time/d<=t){var u=0,f=-1;r<y.length-1&&(f=(y[r+1].time-y[r].time)/d,f>0&&(u=(t-y[r].time/d)/f)),u>1?u=1:0>u&&(u=0),o=y[r].areaindex-1;for(var m=1,M=0;r>M;M++)y[M].areaindex==y[r].areaindex&&m++;if(MyrUpdateAnnotations(e,o+u,m),e.sound.lastbar=o+u,a=s[o],MyrIsDefined(a)){var p=a.Frame[0];if(e.sync.lastAreaIndex!=r){if(c&&p.right<=p.left?p=e.sync.lastAreaBox:e.sync.lastAreaBox=p,e.sync.lastAreaIndex=r,c){for(var g=r+1,h=MyrCtx.vrai;g<y.length&&h==MyrCtx.vrai;){var v=y[g].areaindex-1,b=s[v];MyrIsDefined(b)&&(b.Frame[0].left>=b.Frame[0].right||b.Frame[0].left==p.left&&b.Frame[0].top==p.top)?g++:h=MyrCtx.faux}g-r>1&&MyrDisplayNumber(e,g-r,35,(p.right+p.left)/2,(p.bottom+p.top)/2-25)}}else p=e.sync.lastAreaBox;i=a.Long[0].value-1,i!=e.page.currentPage&&MyrDisplayPage(e,i,MyrCtx.faux),n=e.width*e.page.zoom/e.page.pagewidth;var x=MyrCtx.faux;if(MyrIsDefined(e.sync.lastarea)||(e.sync.lastarea={left:-1,right:-1}),(p.left<e.sync.lastarea.left||p.top!=e.sync.lastarea.top)&&(x=MyrCtx.vrai),x!==e.sync.isImmediate){var D;D=x?0:MyrCtx.NB_MS_POS_MUSIQUE/1e3,MyrSetTransition(e,e.page.divcursor,"all "+D+"s "+("bar"==e.sync.displayMode?"ease":"linear")),e.sync.isImmediate=x}if("bar"==e.sync.displayMode)e.sync.lastarea.left==p.left&&e.sync.lastarea.top==p.top||(MyrSetDivPos(e.page.divcursor,(i*e.page.pagewidth+p.left)*n,p.top*n),l=p.right-p.left,0>=l&&(l=2),MyrSetDivSize(e.page.divcursor,l*n,(p.bottom-p.top)*n));else if(r<y.length-1){var P,k=i*e.page.pagewidth+p.left+(p.right-p.left)*(t-y[r].time/d)/(y[r+1].time/d-y[r].time/d);P=MyrIsDefined(e.args.playmarkerwidth)?e.args.playmarkerwidth:8,MyrSetDivPos(e.page.divcursor,(k-P/2)*n,p.top*n),MyrSetDivSize(e.page.divcursor,P*n,(p.bottom-p.top)*n)}e.sync.lastarea.left=p.left,e.sync.lastarea.top=p.top,MyrAutoView(e,p)}}}e.keyboard.div.height&&MyrKbdManage(e,MyrSoundTime(e))}function MyrAutoView(e,t){var r={};if(r.left=e.page.xoffset,r.top=e.page.yoffset,r.right=r.left+e.page.pagewidth/e.page.zoom,r.bottom=r.top+e.page.pagewidth*e.pageview.div.height/(e.pageview.div.width*e.page.zoom),dleft=t.left-r.left,dright=r.right-t.right,dtop=t.top-r.top,dbottom=r.bottom-t.bottom,dleft<0||dright<0||dtop<0||dbottom<0){var o=0,a=0;dleft<0?o=dright>-dleft?dleft:(dleft-dright)/2:dright<0&&(o=dleft>-dright?-dright:(dleft-dright)/2),dtop<0?a=dbottom>-dtop?dtop:(dtop-dbottom)/2:dbottom<0&&(a=dtop>-dbottom?-dbottom:(dtop-dbottom)/2),0===o&&0===a||(e.page.xoffset+=o,e.page.yoffset+=a,MyrApplyZoomOffsetToPage(e,MyrCtx.faux,MyrCtx.faux))}var i=document.activeElement;if(!e.sync.touchedscroll&&e.sync.autoscroll&&MyrIsDefined(e.page.divcursor)&&(i==e.fatherDiv||i==e.unclippedFather)){var n=e.page.divcursor.getBoundingClientRect();if(n.top<0||n.left<0||n.bottom>(window.innerHeight||document.documentElement.clientHeight)||n.right>(window.innerWidth||document.documentElement.clientWidth)){var s=0,l=0;n.top<0?l=-n.top:n.bottom>(window.innerHeight||document.documentElement.clientHeight)&&(l=(window.innerHeight||document.documentElement.clientHeight)-n.bottom),n.left<0?s=-n.left:n.right>(window.innerWidth||document.documentElement.clientWidth)&&(s=(window.innerWidth||document.documentElement.clientWidth)-n.right),window.scrollBy(-s,-l)}var d=document.documentElement,y=(window.pageXOffset||d.scrollLeft)-(d.clientLeft||0),c=(window.pageYOffset||d.scrollTop)-(d.clientTop||0);e.sync.lastscrollposx>=0&&e.sync.lastscrollposx!=y||e.sync.lastscrollposy>=0&&e.sync.lastscrollposy!=c?e.sync.touchedscroll=MyrCtx.vrai:(e.sync.lastscrollposx=y,e.sync.lastscrollposy=c)}}function MyrDownloadData(e,t,r,o){var a=new Blob([r],{type:t}),i=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if("http"!=window.location.href.substr(0,4)&&(o=MyrCtx.faux),MyrIsDefined(o)&&o||!navigator.msSaveBlob)if(MyrIsDefined(o)&&o&&navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(a,e);else{var n=URL.createObjectURL(a),s=document.createElement("a");s.type=t,s.href=n,s.style.visibility="hidden",i||MyrIsDefined(o)&&o||!MyrIsDefined(s.download)?(s.download=e,s.target="_blank"):s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s)}else navigator.msSaveBlob(a,e)}function MyrAction(e,t){function r(e,t,r,o){MyrIsDefined(o)&&(MyrDlogAddItem(e,m,"fontWeight: bold;color: #606060"," "+r+" ","---",0,null,"newline left middle",0,0),MyrDlogAddItem(e,m,"static",o,"---",0,null,"right middle",0,0))}var o,a,i=t.split(" ");switch(t=i[0].trim(),MyrIsDefined(i[1])?(a=i[1].trim(),a.match(/^[0-9\-+]/)&&(a=a.match(/\./)?parseFloat(a):parseInt(a))):a=null,t){case"action_zoom":MyrSetPageZoom(e,a/100,MyrCtx.faux);break;case"action_page":break;case"action_displaybars":e.page.displaybars=a,MyrCreateBarNum(e);break;case"action_viewpart":MyrSetDisplayView(e,"view",a);break;case"action_viewlyrics":MyrSetDisplayView(e,"lyrics",a);break;case"action_volume":MyrSoundSetGeneralVolume(e,a);break;case"action_metronomebefore":e.sound.playMode.metronome.before^=MyrCtx.vrai;break;case"action_metronomebar":e.sound.playMode.metronome.bar^=MyrCtx.vrai,MyrSoundChangeMetronome(e);break;case"action_metronomebeat":e.sound.playMode.metronome.beat^=MyrCtx.vrai,MyrSoundChangeMetronome(e);break;case"action_detune":e.sound.playMode.scheduleddetune=a,MyrSoundChangeData(e);break;case"action_tempo":e.sound.playMode.scheduledtempo=a,MyrSoundChangeData(e);break;case"action_mixer":MyrMixAction(e,parseInt(a),i[2],parseFloat(i[3]));break;case"action_download":MyrDownloadData(e.file[a].name,e.file[a].mime,e.file[a].data,MyrCtx.faux);break;case"action_print":var n=e.page.divgraph.innerHTML,s=e.page.view[e.page.viewIndex],l=[];if(l[0]="",MyrIsDefined(a)&&a>0)for(var o=0;o<s.anno.length;o++)if(s.anno[o].alphaMusicNo>0){var d=s.anno[o].str,y=d.match(/<defs>([\s\S]*)<\/defs>/i);MyrIsDefined(y)&&(l[0]+=y[1]+"\n");var c=d.match(/<\/defs>([\s\S]*)<\/svg>/i);MyrIsDefined(c)&&(c="<!-- Annotation "+(o+1)+" -->\n<g opacity='"+s.anno[o].alphaMusicNo+"' transform='translate("+s.anno[o].frame.left+" "+s.anno[o].frame.top+")' >"+c[1]+"</g>\n<!-- Fin Annotation "+(o+1)+" -->\n",MyrIsDefined(l[s.anno[o].numPage+1])||(l[s.anno[o].numPage+1]=""),l[s.anno[o].numPage+1]+=c)}var u=DoConvertSVGtoPDF(n,e.nbPages,l);n=null;var f=MyrSafeGet(e,"Myrweb[0].Header[0].$name");MyrIsDefined(f)||(f="untitled"),f=f.replace(/\.[^\.]*$/,"")+".pdf",MyrDownloadData(f,"application/pdf",u,MyrCtx.vrai),u=null;break;case"action_info":var m=MyrDlogGetDlogIndexByTag(e,"system_info");if(m>=0)MyrDlogClose(e,"system_info");else if(m=MyrDlogNew(e,"system_info",MyrThemeGetRawIcon(e,e.theme.info,25,25,2,2,2,2,.6,2,"#000000","#E0E0E0"),MyrCtx.vrai),m>=0){var M=myrweb_version.match(/ *([^ ]+) +Build +([^ ]+) +Compiled +[^ ]+ +([^ ]+) +(\d\d?) +(\d?\d:\d?\d)[^ ]+ +(\d+) *$/);MyrDlogAddItem(e,m,"fontWeight: bold","Myrweb App","mwstat",0,null,"newline center middle",0,0),MyrDlogAddItem(e,m,"static","Version: ","verstat",0,null,"newline left middle",0,0),MyrDlogAddItem(e,m,"static",M[1],"verval",0,null,"right middle",0,0),MyrDlogAddItem(e,m,"static","Build: ","buildstat",0,null,"newline left middle",0,0),MyrDlogAddItem(e,m,"static",M[2],"buildval",0,null,"right middle",0,0),MyrDlogAddItem(e,m,"static",MyrThemeGetRawIcon(e,e.theme.calendar,18,18,2,0,0,0,1,2,"#606060","#606060"),"compstat",0,null,"newline left middle",0,0),MyrDlogAddItem(e,m,"static",M[3]+" "+M[4]+" "+M[6]+", "+M[5],"compval",0,null,"right middle",0,0),MyrDlogAddItem(e,m,"fontSize: smaller",MyrWebCopyright,"copystat",0,null,"newline right middle",0,10),MyrDlogOpen(e,m,e.unclippedFather,"right top persistent",-10,e.toolheight,e.theme)}break;case"action_fileinfo":var m=MyrDlogGetDlogIndexByTag(e,"file_info");if(m>=0)MyrDlogClose(e,"file_info");else{var p=MyrSafeGet(e,"Myrweb[0].Header[0].$title");if(p=MyrStrLimit(p,30),m=MyrDlogNew(e,"file_info",MyrThemeGetRawIcon(e,e.theme.fileinfo,20,20,0,-1,0,-1,.6,2,"#000000","#A0A0A0")+" "+p,MyrCtx.vrai),m>=0){var g=MyrSafeGet(e,"Myrweb[0].Header[0].$composer");MyrIsDefined(g)&&MyrDlogAddItem(e,m,"static",MyrStrLimit(g,30),"---",0,null,"newline center middle",0,0);var h=MyrSafeGet(e,"Myrweb[0].Header[0].$remarks");MyrIsDefined(h)&&MyrDlogAddItem(e,m,"fontStyle:italic",MyrStrLimit(h,30),"---",0,null,"newline center middle",0,0);var v=MyrSafeGet(e,"Myrweb[0].Header[0].$email");if(MyrIsDefined(v)){if(v.indexOf("@")>0){var b=v.match(/([+\-\.0-9_A-Za-z]+@[+\-\.0-9_A-Za-z]+\.[+\-\.0-9_A-Za-z]+)/);v=v.replace(/<?[+\-\.0-9_A-Za-z]+@[+\-\.0-9_A-Za-z]+\.[+\-\.0-9_A-Za-z]+>?/,""),v=v.replace(/[<>\'\"&]/g,""),v.length<2&&(v=b[1]),v="<a href='mailto:"+b[1]+"'>"+v+"</a>"}r(e,m,"@",v)}var x=MyrSafeGet(e,"Myrweb[0].Header[0].$duration");if(MyrIsDefined(x)){var D=e.sound.playMode.tempo;MyrIsDefined(D)||(D=1),x/=1e3,x/=D;var P,k,w;P=parseInt(x/3600),k=parseInt((x-3600*P)/60),w=parseInt(x-3600*P-60*k);var F="";P&&(F+=P+"h "),(P||k)&&(F+=k+"mn "),F+=w+"s",r(e,m,MyrThemeGetRawIcon(e,e.theme.duration,17,17,7,2,2,2,1,2,"#606060","#606060"),F)}var C=MyrSafeGet(e,"Myrweb[0].Header[0].$soundBaseLevel");if(C>=0&&6>=C){var S=["LT","ST","XT","MP","WE","SE","Gold"];r(e,m,MyrThemeGetRawIcon(e,e.theme.instrument,30,24,0,0,0,0,1,0,"none","#606060"),S[C])}var T=MyrSafeGet(e,"Myrweb[0].Header[0].$audioQuality");if(T>=0){var I=MyrThemeGetRawIcon(e,e.theme.light,20,24,2,2,2,2,1,2,"none","#606060"),A=MyrThemeGetRawIcon(e,e.theme.heavy,20,20,2,2,2,2,1,2,"#606060","#606060"),L=MyrThemeGetRawIcon(e,e.theme.square,10,10,2,2,2,7,1,2,"#606060","#606060"),G=MyrThemeGetRawIcon(e,e.theme.square,10,10,2,2,2,7,1,2,"#606060","none"),E=MyrSafeGet(e,"Myrweb[0].Header[0].$audioQuality"),_=I+" ";for(o=0;E>=o;o++)_+=L;for(;5>=o;o++)_+=G;_+=" "+A,r(e,m," MP3",_)}r(e,m,MyrThemeGetRawIcon(e,e.theme.track,25,25,7,2,2,2,1,1.5,"#606060","#606060"),e.sound.track.length),r(e,m,MyrThemeGetRawIcon(e,e.theme.calendar,18,18,7,0,0,0,1,2,"#606060","#606060"),MyrSafeGet(e,"Myrweb[0].Header[0].$date"));var z=MyrThemeGetRawIcon(e,e.theme.powered,10,10,2,2,2,2,1,1,"none","#606060");MyrDlogAddItem(e,m,"fontSize: smaller",z,"---",0,null,"newline left middle",0,10),MyrIsDefined(MyrSafeGet(e,"Myrweb[0].Header[0].$appName"))?MyrDlogAddItem(e,m,"fontSize: smaller",MyrSafeGet(e,"Myrweb[0].Header[0].$appName"),"---",0,null,"left middle",0,10):MyrDlogAddItem(e,m,"fontSize: smaller","??","---",0,null,"left middle",0,10),MyrIsDefined(MyrSafeGet(e,"Myrweb[0].Header[0].$appVers"))&&MyrDlogAddItem(e,m,"fontSize: smaller"," v"+MyrSafeGet(e,"Myrweb[0].Header[0].$appVers"),"---",0,null,"left middle",0,10),MyrIsDefined(MyrSafeGet(e,"Myrweb[0].$copyright"))?MyrDlogAddItem(e,m,"fontSize: smaller",MyrSafeGet(e,"Myrweb[0].$copyright"),"copystat",0,null,"right middle",0,10):MyrDlogAddItem(e,m,"fontSize: smaller",MyrWebCopyright,"copystat",0,null,"right middle",0,10),MyrDlogOpen(e,m,e.unclippedFather,"right top persistent",-20,e.toolheight,e.theme)}}break;case"action_playstate":switch(a){case MyrCtx.STATE_PLAYING:switch(e.sound.playState){case MyrCtx.STATE_STOPPED:e.sync.touchedscroll=MyrCtx.faux,e.sync.lastscrollposx=-1,e.sync.lastscrollposy=-1,MyrSoundPlay(e);break;case MyrCtx.STATE_PAUSED:MyrSoundDepause(e);break;case MyrCtx.STATE_PLAYING:MyrSoundStop(e),MyrUpdateAnnotations(e,-1)}break;case MyrCtx.STATE_PAUSED:switch(e.sound.playState){case MyrCtx.STATE_PAUSED:MyrSoundDepause(e);break;case MyrCtx.STATE_PLAYING:MyrSoundPause(e)}break;case MyrCtx.STATE_STOPPED:e.sound.playState!=MyrCtx.STATE_STOPPED&&(MyrSoundStop(e),MyrUpdateAnnotations(e,-1))}break;case"action_playrelpos":MyrSoundRelativeJump(e,a);break;case"action_kbd_octave":e.keyboard.octaveshift=a,MyrKbdDraw(e);break;case"action_kbd_viewstaff":e.sync.staff[a]^=MyrCtx.vrai,MyrKbdDraw(e)}}function MyrManageKeyPress(e,t,r){var o,a,i=!0,n=null;for(o=0;o<MyrCtx.myrTab.length;o++)MyrCtx.myrTab[o].unclippedFather===e&&(n=MyrCtx.myrTab[o]);if(null!==n){if(a=0,"focus"==r){for(n.unclippedFather.style.boxShadow=n.theme.focusshadow,o=0;o<MyrCtx.myrTab.length;o++)MyrCtx.myrTab[o].focus=MyrCtx.faux;n.focus=MyrCtx.vrai,null!==n.toolfocus&&MyrToolbarGainFocus(n,n.toolfocus)}else"out"==r?(n.unclippedFather.style.boxShadow="",n.focus==MyrCtx.vrai&&null!==n.toolfocus&&MyrToolbarLoseFocus(n,n.toolfocus),n.focus=MyrCtx.faux):"ctrlkey"==r?8===t.keyCode||46===t.keyCode||27===t.keyCode||13===t.keyCode?i=MyrToolbarProcessKey(n,n.toolfocus,t.keyCode):a=t.keyCode:(a=t.charCode||t.key||t.keyCode||t.which,n.focus==MyrCtx.vrai&&null!==n.toolfocus&&(i=MyrToolbarProcessKey(n,n.toolfocus,a),a=0));a>0&&(a!=MyrCtx.lastCar||MyrCtx.lastCarTime+125<=(new Date).getTime())&&(MyrCtx.lastCarTime=(new Date).getTime(),MyrCtx.lastCar=a,32==a?(MyrAction(n,"action_playstate "+MyrCtx.STATE_PLAYING),MyrToolbarUpdate(n),i=!1):37==a?(n.sound.playState==MyrCtx.STATE_PLAYING?(MyrAction(n,"action_playrelpos -1"),MyrToolbarUpdate(n)):(target=n.page.currentPage-1,target<0&&(target=0),MyrDisplayPage(n,target,MyrCtx.faux)),i=!1):39==a&&(n.sound.playState==MyrCtx.STATE_PLAYING?(MyrAction(n,"action_playrelpos 1"),MyrToolbarUpdate(n)):(target=n.page.currentPage+1,target>n.nbPages-1&&(target=n.nbPages-1),MyrDisplayPage(n,target,MyrCtx.faux)),i=!1))}return i===!1&&t.preventDefault(),i}function MyrManageMouseOnObj(e,t){var r,o,a,i,n=e.mouse.x,s=e.mouse.y,l=MyrCtx.button,d="",y="";if(1==e.index&&Debug("MOUSE "+t+" X="+n+"Y="+s+" B="+l+" S="+e.mouse.stilldown),d="none",y=MyrDlogLocate(e,n,s),""!==y)d="dlog";else if(MyrIsDefined(e.toolbar)&&MyrIsDefined(e.toolbar.tool)){var c=s;if(c>=0)if(c<e.title.div.height)d="title";else if(c-=e.title.div.height,c<e.toolbar.div.height)for(d="tool",r=0;r<e.toolbar.tool.length;r++){var u=e.toolbar.tool[r];n>u.screenleft&&n<u.screenright&&(d="tool",y=r)}else c-=e.toolbar.div.height,c<e.pageview.div.height?(d="page",y=0):(c-=e.pageview.div.height,d="keyboard",y=0)}if("move"==t)if(e.mouse.stilldown)0===e.mouse.dragstate&&(Math.abs(n-e.mouse.clickx)>4||Math.abs(s-e.mouse.clicky)>4)&&(e.mouse.dragstate=1,e.mouse.lastdragx=e.mouse.clickx,e.mouse.lastdragy=e.mouse.clicky),"tool"==e.mouse.clickedtype?"volume"==e.toolbar.tool[e.mouse.clickeddata].tag&&MyrToolbarClickTool(e,e.mouse.clickeddata):"dlog"==e.mouse.clickedtype?(i=e.mouse.clickeddata.split(" "),0===e.mouse.dragstate&&MyrDlogProcessItem("click",e,i[0],i[1]),1==e.mouse.dragstate&&MyrDlogProcessItem("drag",e,i[0],i[1])):"page"==e.mouse.clickedtype&&1==e.mouse.dragstate&&(o=e.mouse.x-e.mouse.lastdragx,a=e.mouse.y-e.mouse.lastdragy,(o||a)&&(MyrIsDefined(e.page.xoffset)||(e.page.xoffset=e.page.yoffset=0),MyrIsDefined(e.page.zoom)||(e.page.zoom=1),o=o*e.page.pagewidth/(e.width*e.page.zoom),a=a*e.page.pagewidth/(e.width*e.page.zoom),e.page.xoffset-=o,e.page.yoffset-=a,MyrApplyZoomOffsetToPage(e,MyrCtx.faux,MyrCtx.vrai))),e.mouse.lastdragx=e.mouse.x,e.mouse.lastdragy=e.mouse.y;else if(MyrIsDefined(e.toolbar)&&MyrIsDefined(e.toolbar.tool))for(r=0;r<e.toolbar.tool.length;r++)"tool"==d&&y==r?e.toolbar.tool[r].nextundermouse=MyrCtx.vrai:e.toolbar.tool[r].nextundermouse=MyrCtx.faux;if("click"==t){var f=Date.now();if(Math.abs(e.mouse.clickx-n)<4&&Math.abs(e.mouse.clicky-s)<4&&f<e.mouse.clicktime+400)return void MyrManageMouseOnObj(e,"dblclick");2==l&&"page"==d&&(MyrMenuClear(e,0),MyrAddMenuItemsZoom(e),MyrAddMenuItemsPart(e),MyrAddMenuItemsLyrics(e),MyrPopup(e)),2==l&&"keyboard"==d&&(MyrMenuClear(e,0),MyrAddMenuItemsKbd(e),MyrPopup(e)),e.mouse.clicktime=f,e.mouse.clickx=n,e.mouse.clicky=s,e.mouse.dragstate=0,e.mouse.clickedtype=d,e.mouse.clickeddata=y,e.mouse.stilldown=MyrCtx.vrai,"tool"==d?MyrToolbarClickTool(e,y):"dlog"==d?(i=e.mouse.clickeddata.split(" "),MyrDlogProcessItem("click",e,i[0],i[1])):e.toolfocus&&MyrToolbarLoseFocus(e,e.toolfocus)}else 0===l&&(e.mouse.stilldown=MyrCtx.faux);MyrToolbarUpdate(e)}function MyrInstanceHasOpenMenu(){for(var e=0;e<MyrCtx.myrTab.length;e++)if(MyrIsDefined(MyrCtx.myrTab[e].menu)&&MyrCtx.myrTab[e].menu.opened>=0)return MyrCtx.myrTab[e];return null}function MyrManageMouse(e){if("click"==e){var t=MyrInstanceHasOpenMenu();if(t&&t.menu.managemouseevt("click",t,-1))return}for(var r=0;r<MyrCtx.myrTab.length;r++)if(MyrCtx.myrTab[r].mouse.inObj)return void MyrManageMouseOnObj(MyrCtx.myrTab[r],e)}function MyrXhrError(e,t){"file:"===window.location.protocol&&alert("Could not download "+t.src+". It might be due to your browser preventing Javascript downloads on local files (file://).\nPlease retry to view pages once uploaded to an actual HTTP server."),MyrError(t,"Error loading "+t.src,e.statusText)}function MyrLoadMyrweb(e){var t,r;if(MyrParseArgs(e,e.unclippedFather.dataset.myrweb),e.src=e.args.src,!MyrIsDefined(e.src)){console.time("atob");var o=window.atob(e.inlinedata.replace(/=?[\000- ]+/g,""));console.timeEnd("atob"),console.time("string2array"),e.inlinedata=null;var a=o.length,i={};for(i.buffer=new Uint8Array(new ArrayBuffer(a)),i.size=a,t=0;a>t;t++)i.buffer[t]=o.charCodeAt(t);return o=null,console.timeEnd("string2array"),i.index=0,void(MyrParseChunkLevel(i,i.size,e,0,e.index)?(i.buffer=null,i=null,MyrProcessMyrwebData(e)):(i.buffer=null,i=null,MyrError(e,"Error loading inline data")))}if("html"==e.src.split(".").pop()||"htm"==e.src.split(".").pop()){r=new XMLHttpRequest;try{r.open("GET",e.src+"?nocache="+Math.random(),!0)}catch(n){return void MyrError(e,"Error getting "+e.src+":",n)}r.responseType="text",r.storage=e,r.onprogress=function(e){SetLoadTimeOut(window,r.storage,MyrCtx.myrTimeOutLoad)},r.onload=function(e){if(2===r.readyState||3===r.readyState)SetLoadTimeOut(window,r.storage,MyrCtx.myrTimeOutLoad);else if(4===r.readyState){var o=r.storage;if(200===r.status&&!o.isError){var a,i;if(a=/varb64[\s]*=[\s]*\"([^\"]*)\"/i,i=r.responseText.match(a),(!MyrIsDefined(i)||!MyrIsDefined(i[1])||i[1].length<=6)&&(a=/data-b64[\s]*=[\s]*\"([^\"]*)\"/i,i=r.responseText.match(a),(!MyrIsDefined(i)||!MyrIsDefined(i[1])||i[1].length<=6)&&(a=/class=\"myrweb-b64\"[^>]*>([^<]*)</i,i=r.responseText.match(a))),MyrIsDefined(i)&&MyrIsDefined(i[1])&&i[1].length>6){i=window.atob(i[1].replace(/=?[\000- ]+/g,""));var n=i.length,s={};for(s.buffer=new Uint8Array(new ArrayBuffer(n)),s.size=n,t=0;n>t;t++)s.buffer[t]=i.charCodeAt(t);i=null,s.index=0,MyrParseChunkLevel(s,s.size,o,0,o.index)?(s.buffer=null,s=null,MyrProcessMyrwebData(o)):(s.buffer=null,s=null,MyrError(o,"Error parsing "+r.storage.src," data"))}else MyrError(o,"Error: "+r.storage.src," empty data")}}},r.onerror=MyrCallback(MyrXhrError,r,e);try{r.send(null)}catch(n){MyrError(e,"Error loading "+e.src+":",n)}}else{r=new XMLHttpRequest;try{r.open("GET",e.src+"?nocache="+Math.random(),!0)}catch(n){return void MyrError(e,"Error getting "+e.src+":",n)}r.responseType="arraybuffer",r.storage=e,r.onprogress=function(e){SetLoadTimeOut(window,r.storage,MyrCtx.myrTimeOutLoad)},r.onload=function(e){if(2===r.readyState||3===r.readyState)SetLoadTimeOut(window,r.storage,MyrCtx.myrTimeOutLoad);else if(4===r.readyState){var t=r.storage;if(200!==r.status||t.isError)MyrError(t,"Error loading "+r.storage.src,r.statusText);else{var o={};o.buffer=new Uint8Array(r.response),o.size=o.buffer.length,o.index=0,MyrParseChunkLevel(o,o.size,t,0,t.index)?(o.buffer=null,o=null,r.response=r=null,MyrProcessMyrwebData(t)):(o.buffer=null,o=null,MyrError(t,"Error loading "+r.storage.src,"Incorrect data"))}}},r.onerror=MyrCallback(MyrXhrError,r,e);try{r.send(null)}catch(n){MyrError(e,"Error loading "+e.src+":",n)}}}function MyrSetTitle(e){var t,r,o,a,i="";if(e.title.div.height>0){if(t=Math.floor(.76*e.title.div.height),e.isLoaded==MyrCtx.vrai){var n=e.sound.playMode.tempo;if(MyrIsDefined(n)||(n=1),i=e.args.title,MyrIsDefined(i)||(i="{name}"),a=MyrSafeGet(e,"Myrweb[0].Synchro[0].Score[0].AreaTime[0].Time"),null!==a){a=Math.floor(a[a.length-1].time/n);var s=parseInt(a/3600),l=parseInt(a/60)%60,d=a%60;a=(s>0?(10>s?"0"+s:s)+"h":"")+(10>l?"0"+l:l)+"m"+(10>d?"0"+d:d)+"s"}else a="";i=i.replace("{name}",MyrSafeGet(e,"Myrweb[0].Header[0].$title")),i=i.replace("{composer}",MyrSafeGet(e,"Myrweb[0].Header[0].$compose")),i=i.replace("{remarks}",MyrSafeGet(e,"Myrweb[0].Header[0].$remarks")),i=i.replace("{date}",MyrSafeGet(e,"Myrweb[0].Header[0].$date")),i=i.replace("{duration}",a)}else i="Loading "+e.args.src;r=MyrIsDefined(e.theme.titleface)?e.theme.titleface:"normal",o=MyrIsDefined(e.theme.titleweight)?e.theme.titleweight:"normal",MyrIsDefined(e.theme.titlecolor)?color=MyrCreateGradient(e.theme.titlecolor,!1):color="",e.title.div.innerHTML="<div style='margin-left:10px;text-align: center;vertical-align:top;font-family:"+e.theme.titlefont+";font-size:"+t+"px;font-style:"+r+";font-weight:"+o+";color:"+color+"'>"+i+"</div>"}}function MyrDisplayPage(e,t,r){e.page.currentPage=t,MyrApplyZoomOffsetToPage(e,MyrCtx.vrai,r),MyrToolbarUpdate(e)}function MyrCreateBarNum(e){var t="";if("view"==e.page.viewType&&e.page.displaybars==MyrCtx.vrai){for(var r="",o=MyrSafeGet(e,"Myrweb[0].Graphics[0].Score["+e.page.viewIndex+"].AreaList[0].Area"),a=0;a<o.length;a++){var i=o[a].Frame[0].left+e.page.pagewidth*(o[a].Long[0].value-1),n=o[a].Frame[0].top,s=o[a].Frame[0].right-o[a].Frame[0].left,l=o[a].Frame[0].bottom-o[a].Frame[0].top,d=l/6;r+="<text opacity='0.2' x='"+(i+s/2)+"' y='"+(n+l/2)+"'  text-anchor='middle'  font-size='"+d+"' font-family='sans-serif' font-weight='bolder' fill='#000000' stroke='none'>"+(a+1)+"</text>"}t=MyrCtx.svgHeader+" viewBox='0 0 "+e.nbPages*e.page.pagewidth+" "+e.svgHeight+"'>",MyrIsDefined(e.page.view[e.page.viewIndex].annotationsSvg)&&(t+=e.page.view[e.page.viewIndex].annotationsSvg),t+="<g id='MyrBar-"+e.index+"'>"+r+"</g>",t+="</svg>"}else"view"===e.page.viewType&&MyrIsDefined(e.page.view[e.page.viewIndex].annotationsSvg)&&(t=MyrCtx.svgHeader+" viewBox='0 0 "+e.nbPages*e.page.pagewidth+" "+e.svgHeight+"'>"+e.page.view[e.page.viewIndex].annotationsSvg+"</svg>");e.page.divenrich.innerHTML=t,MyrResetAnnotations(e)}function MyrApplyZoomOffsetToPage(e,t,r){var o,a,i=document.getElementById("MyrPg-"+e.index);if(MyrIsDefined(e.page.zoom)||(e.page.zoom=1),o=e.page.zoom,i&&e.page.div.height){var n,s,l=e.page.currentPage;if(MyrIsDefined(e.page.xoffset)){n=e.page.xoffset,s=e.page.yoffset,0>n&&(n=0),0>s&&(s=0),n>e.page.pagewidth-e.page.pagewidth/o&&(n=e.page.pagewidth-e.page.pagewidth/o);var d=e.page.pagewidth*e.pageview.div.height/e.width;s>d-d/o&&(s=d-d/o),e.page.xoffset=n,e.page.yoffset=s}else n=s=0;r?a="":MyrIsDefined(e.page.div.style.transition)&&""!==e.page.div.style.transition||(a="all 0.5s ease-in-out"),MyrIsDefined(a)&&MyrSetTransition(e,e.page.div,a),n=-e.width*o*(l+n/e.page.pagewidth),s=o*(-e.width*s/e.page.pagewidth),t&&(a=r?"":"all 0.5s ease-in-out",MyrSetTransition(e,e.page.divenrich,a),MyrSetTransition(e,e.page.divselect,a),MyrSetTransition(e,e.page.divgraph,a),MyrSetDivSize(e.page.divgraph,e.width*e.nbPages*o,e.pageview.div.height*o),MyrSetDivSize(e.page.divenrich,e.width*e.nbPages*o,e.pageview.div.height*o),MyrSetDivSize(e.page.divselect,e.width*e.nbPages*o,e.pageview.div.height*o),MyrSetDivSize(e.page.div,e.width*e.nbPages*o,e.pageview.div.height*o),MyrSetWatermark(e,e.page.divselect)),MyrSetDivPos(e.page.div,n,s)}MyrSetPageBackPict(e)}function MyrSetPageZoom(e,t,r){var o,a;o=e.page.xoffset+e.page.pagewidth/(2*e.page.zoom),a=e.page.yoffset+e.page.zoom*e.page.pageheight/(2*e.page.zoom),e.page.zoom=t,e.page.xoffset=o-e.page.pagewidth/(2*e.page.zoom),e.page.yoffset=a-e.page.zoom*e.page.pageheight/(2*e.page.zoom),MyrIsDefined(r)||(r=MyrCtx.vrai),MyrApplyZoomOffsetToPage(e,MyrCtx.vrai,r)}function MyrSetPageWindowSize(e,t,r,o){var a=r+e.title.div.height+e.toolbar.div.height+e.position.div.height+e.keyboard.div.height;MyrSetDivSize(e.unclippedFather,t,a),MyrSetDivSize(e.fatherDiv,t,a),e.page.div.height&&(MyrIsDefined(e.page.zoom)||(e.page.zoom=1),MyrSetDivSize(e.pageview.div,t,r),MyrSetDivSize(e.page.div,t*o*e.page.zoom,r*e.page.zoom),MyrSetDivSize(e.page.divgraph,t*o*e.page.zoom,r*e.page.zoom),MyrSetDivSize(e.page.divenrich,t*o*e.page.zoom,r*e.page.zoom),MyrSetDivSize(e.page.divselect,t*o*e.page.zoom,r*e.page.zoom),MyrSetWatermark(e,e.page.divselect)),e.keyboard.div.height&&MyrSetDivPos(e.keyboard.div,0,r+e.title.div.height+e.toolbar.div.height+e.position.div.height)}function MyrSetPageBackPict(e){var t=e.page[e.page.viewType][e.page.viewIndex];if(MyrIsDefined(t.backpict)){t.backpict.dupMode="fitwidth",t.backpict.scalable=1;var r,o,a,i,n;switch(r=t.backpict.rect.right-t.backpict.rect.left,o=t.backpict.rect.bottom-t.backpict.rect.top,
a=e.width,i=e.pageview.height,MyrIsDefined(t.backpict.scalable)&&t.backpict.scalable?(r*=e.page.zoom,o*=e.page.zoom,i*=e.page.zoom,a*=e.page.zoom,n=e.page.div.style):n=e.pageview.div.style,n.backgroundImage=t.backpict.data,t.backpict.dupMode="mosaic",t.backpict.dupMode){case"fitwidth":style=a+"px auto";break;case"fitheight":style="auto "+i+"px";break;case"fitboth":style=a+"px "+i+"px";break;case"contain":style="contain";break;case"cover":style="cover";break;case"mosaic":default:style=r+"px "+o+"px"}n.backgroundSize=style}else e.pageview.div.style.backgroundImage=e.page.div.style.backgroundImage="",e.pageview.div.style.backgroundSize=e.page.div.style.backgroundSize="auto auto"}function MyrSetDisplayView(e,t,r){var o=e.page[t][r];if(!MyrIsDefined(o)){for(alert("Impossible to view "+t+" #"+r);r>0&&!MyrIsDefined(e.page[t][r]);)r--;t="view"==t?"lyrics":"view",o=e.page[t][r]}MyrIsDefined(o)&&(e.nbPages=o.nbpages,e.svgWidth=o.width,e.svgHeight=o.height,e.page.viewType=t,e.page.viewIndex=r,e.page.pagewidth=o.pagewidth,e.page.pageheight=o.height,e.page.divgraph.innerHTML=MyrCtx.svgHeader+" viewBox='0 0 "+e.nbPages*e.page.pagewidth+" "+e.svgHeight+"' id='MyrPg-"+e.index+"'><g>"+o.data+"</g></svg>",MyrCreateBarNum(e),MyrSetPageWindowSize(e,e.width,o.height*e.width/e.page.pagewidth),MyrDisplayPage(e,0,MyrCtx.vrai))}function MyrUpdateAnnotations(e,t,r){var o,a,i;if("view"===e.page.viewType)for(o=e.page.view[e.page.viewIndex],a=0;a<o.anno.length;a++)if(i=0>t?o.anno[a].alphaMusicNo:(0===o.anno[a].repeat||o.anno[a].repeat==r)&&t>=o.anno[a].firstBar-1&&t<o.anno[a].lastBar-1?o.anno[a].alphaMusicRange:o.anno[a].alphaMusicYes,i!=o.anno[a].lastopacity){var n=document.getElementById(o.anno[a].idunique);MyrIsDefined(n)&&(o.anno[a].lastopacity=i,n.style.opacity=i,n.setAttribute("opacity",i))}}function MyrResetAnnotations(e){var t,r;if("view"===e.page.viewType){for(r=e.page.view[e.page.viewIndex],t=0;t<r.anno.length;t++)r.anno[t].lastopacity=-1;e.sound.playState==MyrCtx.STATE_STOPPED?MyrUpdateAnnotations(e,-1):MyrUpdateAnnotations(e,e.sound.lastbar)}}function MyrBuildOneAnnotationSvg(e,t,r,o,a){var i=MyrSafeGet(e,"SvgFile[0]");if(!MyrIsDefined(i))return"";i=i.str,i=i.replace(/<svg [^>]*>/gi,""),i=i.replace(/<\/svg[^>]*>/gi,""),0>r&&(r=0);var n=e.$frame.left+a*e.$numPage;return i="<g transform='translate("+n+","+e.$frame.top+")' id='"+o+"' opacity='"+t+"' transition='all "+r+"s ease' style='transition:all "+r+"s ease'>"+i+"</g>"}function MyrBuildAnnotationsSvg(e,t,r,o){var a,i,n="";if(e.anno=[],null!==t&&(i=MyrSafeGet(t,"Anno"),null!==i))for(a=0;a<i.length;a++){e.anno[a]={};for(var s in i[a])"$"===s.substring(0,1)&&(e.anno[a][s.substring(1)]=i[a][s]);e.anno[a].idunique=r+"-"+a,e.anno[a].lastopacity=-1,e.anno[a].alphaSpeed<=0?transdur=0:transdur=(Math.max(e.anno[a].alphaMusicNo,e.anno[a].alphaMusicYes,e.anno[a].alphaMusicRange)-Math.min(e.anno[a].alphaMusicNo,e.anno[a].alphaMusicYes,e.anno[a].alphaMusicRange))/(60*e.anno[a].alphaSpeed),e.anno[a].str=MyrSafeGet(i[a],"SvgFile[0].str"),n+=MyrBuildOneAnnotationSvg(i[a],e.anno[a].alphaMusicNo,transdur,e.anno[a].idunique,o)}return n}function MyrExtractBackground(e,t){var r,o,a,i,n=MyrSafeGet(e,t);if(MyrIsDefined(n)){i={};var s,l=MyrSafeGet(n,"Frame[0]");if(null!==l&&(i.rect={left:l.left,top:l.top,right:l.right,bottom:l.bottom}),i.dupMode=n.$dupMode,i.scalable=n.$scalable,"yes"==i.scalable?i.scalable=1:"no"==i.scalable&&(i.scalable=0),i.scalable=parseInt(i.scalable),a="",s=MyrSafeGet(n,"SvgFile[0]"),null!==s)o=s.str,a="svg+xml";else{if(s=MyrSafeGet(n,"PngFile[0]"),null===s)return null;for(o="",r=0;r<s.data.length;r++)o+=String.fromCharCode(s.data[r]);a="png"}i.data='url("data:image/'+a+";base64,"+btoa(o)+'")'}return i}function MyrParseArgs(e,t){var r;if(MyrIsDefined(t)){r=t.split(";");for(var o={},a=0;a<r.length;a++){var i;i=r[a].split(/=/),MyrIsDefined(i[0])&&MyrIsDefined(i[1])&&(i[0]=i[0].trim().toLowerCase(),"src"!=i[0]&&(i[1]=i[1].trim()),""!==i[0]&&(o[i[0]]=i[1]))}"yes"==o.minimal&&(e.args.titleheight=8,e.args.toolheight=16,e.args.timeheight=6,e.args.scoreview="no",e.args.keyboard="no");for(var n in o)e.args[n]=o[n]}}function MyrSetWatermark(e,t){}function MyrPrepareObj(e){MyrParseArgs(e,"theme=moon;tools=default;titlebar=no;titleheight=16;toolbar=yes;toolheight=40;timebar=no;timeheight=8;scoreview=yes;keyboard=no;keyboardheight=60");var t=MyrSafeGet(e,"Myrweb[0].Header[0].$commands");MyrParseArgs(e,t),MyrParseArgs(e,e.unclippedFather.dataset.myrweb),MyrIsDefined(e.args.playmarker)&&(e.sync.displayMode=e.args.playmarker),MyrIsDefined(e.args.autoscroll)?e.sync.autoscroll=MyrBool(e.args.autoscroll):e.sync.autoscroll=MyrCtx["true"],MyrIsDefined(e.args.playmetronomestart)&&(e.sound.playMode.metronome.before=MyrBool(e.args.playmetronomestart)),MyrIsDefined(e.args.playmetronomebeat)&&(e.sound.playMode.metronome.beat=MyrBool(e.args.playmetronomebeat)),MyrIsDefined(e.args.playmetronomebar)&&(e.sound.playMode.metronome.bar=MyrBool(e.args.playmetronomebar)),MyrIsDefined(e.args.playloop)&&(e.sound.playMode.loop=MyrBool(e.args.playloop)),MyrIsDefined(e.args.playstart)&&(e.sound.playMode.start=parseFloat(e.args.playstart)),MyrIsDefined(e.args.playend)&&(e.sound.playMode.end=parseFloat(e.args.playend)),MyrIsDefined(e.args.playtempo)&&(e.sound.playMode.scheduledtempo=parseFloat(e.args.playtempo)/100),MyrIsDefined(e.args.playdetune)&&(e.sound.playMode.scheduleddetune=parseFloat(e.args.playdetune)),MyrIsDefined(e.args.useaudiofailsafe)&&(e.sound.useAudioFailSafe=MyrBool(e.args.useaudiofailsafe)),MyrIsDefined(e.args.animationratio)&&(e.animationRatio=parseFloat(e.args.animationratio)),"yes"==e.args.minimal?e.minimal=MyrCtx.vrai:e.minimal=MyrCtx.faux,e.title={},"no"!=e.args.titlebar?(MyrIsDefined(e.args.titleheight)?height=parseInt(e.args.titleheight):height=12,e.title.div=MyrCreateUndraggableElement("div",115),e.title.div.style.position="absolute",MyrSetDivPos(e.title.div,0,0),MyrSetDivSize(e.title.div,e.width,height),e.title.div.style.backgroundColor="#D8D8D8",e.fatherDiv.appendChild(e.title.div),e.title.versiondiv=MyrCreateUndraggableElement("div",116),e.title.versiondiv.style.position="absolute",MyrSetDivPos(e.title.versiondiv,200,0),MyrSetDivSize(e.title.versiondiv,e.width,height),MyrSetTransition(e,e.title.versiondiv,"all 3s ease"),MyrCompleteStyle(e.title.versiondiv,"vertical-align:middle;text-align:right;font-family:sans-serif;font-size:9px;font-weight:normal;text-shadow:1px 1px 0px rgba(255,255,255,0.8);color:rgba(0,0,0,0.4)"),e.title.versiondiv.innerHTML="Myrweb v."+MyrWebVersion+" "+MyrWebCopyright,e.title.versiondiv.onmouseover=function(e){this.style.left="0px",this.style.visibility="visible"},e.title.versiondiv.onmouseout=function(e){this.style.left="200px",this.style.visibility="hidden"},e.fatherDiv.appendChild(e.title.versiondiv)):(e.title.div={},e.title.div.height=0),MyrIsDefined(e.args.toolheight)?e.toolheight=parseInt(e.args.toolheight):e.toolheight=40,e.toolbar={},e.toolbar.div=MyrCreateUndraggableElement("div",110),e.toolbar.div.style.position="absolute",MyrSetDivPos(e.toolbar.div,0,e.title.div.height),MyrSetDivSize(e.toolbar.div,e.width,e.toolheight),e.toolbar.div.style.backgroundColor="#D8D8D8",e.fatherDiv.appendChild(e.toolbar.div),e.toolbar.background=MyrCreateUndraggableElement("div",120),MyrSetDivPos(e.toolbar.background,0,0),e.toolbar.background.style.position="absolute",MyrSetDivSize(e.toolbar.background,e.width,e.toolheight),e.toolbar.div.appendChild(e.toolbar.background),MyrInitTheme(e,e.args),MyrToolbarChange(e,!1),MyrSetTitle(e),e.position={},e.position.div={},e.position.div.height=0,MyrInitTheme(e,e.args),e.minimal?(e.pageview={},e.pageview.div={},e.pageview.div.height=0,e.page={},e.page.div={},e.page.div.height=0,e.keyboard={},e.keyboard.div={},e.keyboard.div.height=0,e.unclippedFather.style.height=e.fatherDiv.style.height=e.title.div.height+e.toolbar.div.height+e.position.div.height+"px"):("no"!=e.args.scoreview?(e.pageview={},e.pageview.div=MyrCreateUndraggableElement("div",40),e.pageview.div.style.position="absolute",MyrSetDivPos(e.pageview.div,0,e.title.div.height+e.toolbar.div.height+e.position.div.height-1),height=e.height-e.title.div.height-e.toolbar.div.height-e.position.div.height-20,height<=0&&(height=1),MyrSetDivSize(e.pageview.div,e.width,height),e.pageview.div.style.backgroundColor="#FFFF0F",MyrIsDefined(e.theme.pagebgcolor)&&MyrSetDivBackground(e.pageview.div,e.theme.pagebgcolor),e.fatherDiv.appendChild(e.pageview.div),e.page={},e.page.zoom=1,e.page.displaybars=MyrCtx.faux,e.page.xoffset=e.page.yoffset=0,e.page.div=MyrCreateUndraggableElement("div",40),e.page.div.style.position="absolute",MyrSetDivPos(e.page.div,0,0),MyrSetDivSize(e.page.div,e.width,height),e.pageview.div.appendChild(e.page.div),e.page.divgraph=MyrCreateUndraggableElement("div",50),e.page.divgraph.style.position="absolute",MyrSetDivPos(e.page.divgraph,0,0),MyrSetDivSize(e.page.divgraph,e.width,e.pageview.div.height),e.page.div.appendChild(e.page.divgraph),e.page.divselect=MyrCreateUndraggableElement("div",70),e.page.divselect.style.position="absolute",e.page.divselect.style.zIndex=3e3,MyrSetDivPos(e.page.divselect,0,0),MyrSetDivSize(e.page.divselect,e.width,e.pageview.div.height),MyrSetWatermark(e,e.page.divselect),e.pageview.div.appendChild(e.page.divselect),e.page.divcursor=MyrCreateUndraggableElement("div",80),e.page.divcursor.style.position="absolute",MyrSetDivPos(e.page.divcursor,0,0),MyrSetDivSize(e.page.divcursor,0,0),MyrIsDefined(e.args.playpositionopacity)?opacity=e.args.playpositionopacity/100:opacity=.5,MyrIsDefined(e.args.playpositioncolor)?e.page.divcursor.style.backgroundColor=MyrGetRGBA(e.args.playpositioncolor,opacity):e.page.divcursor.style.backgroundColor=MyrGetRGBA("#64FF64",opacity),MyrSetTransition(e,e.page.divcursor,"all "+MyrCtx.NB_MS_POS_MUSIQUE/1e3+"s ease"),e.page.div.appendChild(e.page.divcursor),e.page.divenrich=MyrCreateUndraggableElement("div",90),e.page.divenrich.style.position="absolute",MyrSetDivPos(e.page.divenrich,0,0),MyrSetDivSize(e.page.divenrich,e.width,e.pageview.div.height),e.page.div.appendChild(e.page.divenrich)):(e.pageview={},e.pageview.div={},e.pageview.div.height=0,e.page={},e.page.div={},e.page.div.height=0),"no"!=e.args.keyboard?(e.keyboard={},e.keyboard.div=MyrCreateUndraggableElement("div",200),height=parseInt(e.args.keyboardheight),e.keyboard.div.style.position="absolute",MyrSetDivPos(e.keyboard.div,0,e.title.div.height+e.toolbar.div.height+e.position.div.height+e.pageview.div.height),MyrSetDivSize(e.keyboard.div,e.width,height),MyrKbdDraw(e),e.fatherDiv.appendChild(e.keyboard.div)):(e.keyboard={},e.keyboard.div={},e.keyboard.div.height=0),e.page.currentPage=0,e.page.data=null),e.look=e.args.look,"undefined"!=typeof e.args.volume?e.sound.generalVolume=e.args.volume/100:e.sound.generalVolume=.8,MyrApplyTheme(e)}function MyrProcessMyrwebData(e){var t,r,o,a,i,n,s,l;if(console.timeEnd("Load"+e.index),e.isLoaded=MyrCtx.vrai,MyrStopWait(e),MyrPrepareObj(e),s=MyrSafeGet(e,"Myrweb[0].FileList[0].File"),null!==s)for(t=0;t<s.length;t++){var d=s[t].$type;switch(e.file[t]={},e.file[t].name=MyrSafeGet(e,"Myrweb[0].FileList[0].$name")+"."+d,d){case"xml":e.file[t].mime="application/vnd.recordare.musicxml+xml";break;case"mid":e.file[t].mime="audio/midi";break;case"kar":e.file[t].mime="audio/midi";break;case"pdf":e.file[t].mime="application/pdf";break;case"myr":e.file[t].mime="application/x-myriad-music";break;case"mus":e.file[t].mime="application/x-myriad-music";break;default:e.file[t].mime="application/octet-stream"}e.file[t].data=MyrSafeGet(s[t],"Data[0].data")}if(e.page.div.height>0){if(e.page.backpict=MyrExtractBackground(e,"Myrweb[0].Graphics[0].Backgr[0]"),e.page.view=[],i=MyrSafeGet(e,"Myrweb[0].Graphics[0].Score"),null!==i)for(t=0;t<i.length;t++)e.page.view[t]={},e.page.view[t].nbpages=i[t].$numberOfPages,e.page.view[t].name=i[t].$name,MyrIsDefined(e.page.view[t].name)||(e.page.view[t].name="~"+(t+1)+"~"),e.page.view[t].backpict=MyrExtractBackground(i[t],"Backgr[0]"),r=MyrSafeGet(i[t],"Picture[0].SvgFile[0].str"),o=MyrGetXMLValue(r,"svg","viewBox"),a=o.split(" "),a.length<4&&(a=o.split(",")),a.length>=4&&(e.page.view[t].height=parseInt(a[3]),e.page.view[t].width=parseInt(a[2])),e.page.view[t].pagewidth=e.page.view[t].width/e.page.view[t].nbpages,e.page.view[t].annotationsSvg=MyrBuildAnnotationsSvg(e.page.view[t],MyrSafeGet(i[t],"AnnoList[0]"),"Anno-"+e.index+"-"+t,e.page.view[t].pagewidth),r=r.replace(/<\/svg>/gi,""),e.page.view[t].data=MyrDeleteSvgHeader(r),MyrSafeDispose(i[t],"Picture[0].SvgFile[0].str");if(e.page.lyrics=[],n=MyrSafeGet(e,"Myrweb[0].Graphics[0].Lyrics"),null!==n)for(t=0;t<n.length;t++)e.page.lyrics[t]={},e.page.lyrics[t].name=n[t].$name,e.page.lyrics[t].nbpages=n[t].$numberOfPages,e.page.lyrics[t].nbpages>1&&(e.page.lyrics[t].nbpages=1),e.page.lyrics[t].backpict=MyrExtractBackground(n[t],"Backgr[0]"),r=MyrSafeGet(n[t],"Picture[0].SvgFile[0].str"),o=MyrGetXMLValue(r,"svg","viewBox"),a=o.split(" "),a.length<4&&(a=o.split(",")),a.length>=4&&(e.page.lyrics[t].height=parseInt(a[3]),e.page.lyrics[t].width=parseInt(a[2])),e.page.lyrics[t].pagewidth=e.page.lyrics[t].width/e.page.lyrics[t].nbpages,r=r.replace(/<\/svg>/gi,""),e.page.lyrics[t].data=MyrDeleteSvgHeader(r),MyrSafeDispose(n[t],"Picture[0].SvgFile[0].str");e.page.view.length>0?MyrSetDisplayView(e,"view",0):MyrSetDisplayView(e,"lyrics",0)}else MyrSetPageWindowSize(e,e.width,0,0);MyrInitSound(e),e.sound.canJump=MyrCtx.vrai,e.sound.track=[];var y=MyrSafeGet(e,"Myrweb[0].Audio[0].Track");if(null!==y){for(e.sound.nbTracks=y.length,t=0;t<e.sound.nbTracks;t++){e.sound.track[t]={},e.sound.track[t].name=MyrSafeGet(y[t],"$name");for(var c in y[t])"MpgFile"==c?(e.sound.track[t].data=y[t].MpgFile[0].data,e.sound.track[t].mime="audio/mpeg",MyrSafeDispose(y[t],"MpgFile[0]")):"WavFile"==c?(e.sound.track[t].data=y[t].WavFile[0].data,e.sound.track[t].mime="audio/wav",MyrSafeDispose(y[t],"WavFile[0]")):"OggFile"==c&&(e.sound.track[t].data=y[t].OggFile[0].data,e.sound.track[t].mime="audio/ogg",MyrSafeDispose(y[t],"OggFile[0]"));e.sound.useAudioFailSafe&&0===e.sound.track[t].$bitRate&&(e.sound.canJump=MyrCtx.faux),e.sound.track[t].data&&(e.sound.track[t].panningtrim=MyrSafeGet(y[t],"$panning"),e.sound.track[t].panning=0,MyrInitSoundTrack(e,t,e.sound.track[t].data.buffer,e.sound.track[t].mime))}MyrSafeDispose(e,"Myrweb[0].Audio[0].Track")}if(e.sync.area=MyrSafeGet(e,"Myrweb[0].Synchro[0].Score[0].AreaTime[0].Time"),MyrSafeDispose(e,"Myrweb[0].Synchro[0].Score[0].AreaTime[0].Time"),e.sync.staff=[],l=MyrSafeGet(e,"Myrweb[0].Synchro[0].Score[0].NoteList[0].Staff"),null!==l){for(t=0;t<l.length;t++)e.sync.staff[t]={},e.sync.staff[t].onKbd=MyrCtx.vrai,e.sync.staff[t].id=l[t].$uniqueId,e.sync.staff[t].panning=l[t].$panning,e.sync.staff[t].name=l[t].$name,e.sync.staff[t].note=l[t].Note,e.sync.staff[t].area=e.sync.area;MyrSafeDispose(e,"Myrweb[0].Synchro[0].Score[0].NoteList[0].Staff")}if(elt=MyrSafeGet(e,"Myrweb[0].Synchro[0].Score[0].NoteList[0].Metronom[0]"),null!==elt?(e.sync.metronome={},e.sync.metronome.name="metronome",e.sync.metronome.note=elt.Event,MyrSafeDispose(e,"Myrweb[0].Synchro[0].Score[0].NoteList[0].Metronom[0]")):e.sync.metronome=null,e.sync.lyrics=[],l=MyrSafeGet(e,"Myrweb[0].Synchro[0].Lyrics"),null!==l){for(t=0;t<l.length;t++)e.sync.lyrics[t]={},e.sync.lyrics[t].id=l[t].$uniqueId,e.sync.lyrics[t].name=l[t].$name,e.sync.lyrics[t].area=MyrSafeGet(l[t],"AreaTime[0].Time");MyrSafeDispose(e,"Myrweb[0].Synchro[0].Lyrics")}MyrSetTitle(e),MyrToolbarChange(e)}function MyrStartWait(e){var t=60,r=9,o=16;if(!MyrIsDefined(MyrCtx.waitSvg)){var a=MyrCtx.svgHeader+" viewBox='-30 -30 160 160'>";if(MyrIsDefined(MyrCtx.myrwebLogo))a+=MyrCtx.myrwebLogo;else{a+="<defs><g id='myrwebLogo'>";for(var i=0;r>i;i++){var n=6.28*(i/r),s=50+50*Math.cos(n),l=50-50*Math.sin(n),d=o-o*i/r,y=1-i/r;a+="<circle cx='"+s+"' cy='"+l+"' r='"+d+"' stroke='none' opacity='"+y+"'/>"}a+="</g></defs>"}a+="<style>",a+="@keyframes MyrWait{ 0% {transform: scale(0); fill:#00FF00;} 1% {transform: scale(1);fill:#00FF00;} 1.1% {transform: rotate(0);fill:#00FF00;} 99% {transform: rotate("+2*MyrCtx.myrTimeOutLoad*360+"deg); fill:#FF0000;} 99.1% {transform: scale(1); fill:#FF0000;} 100% {transform: scale(0); fill:#FF0000;}}",a+="</style>",a+="<g  style='strokeWidth:0;transform-origin: 50px 50px;animation: MyrWait "+4*MyrCtx.myrTimeOutLoad+"s linear;animation-fill-mode: forwards;'>",a+="<use xlink:href='#myrwebLogo'/>",a+="</g></svg>",MyrCtx.waitSvg=a}MyrIsDefined(e.waitDiv)||(e.waitDiv=MyrCreateUndraggableElement("div",1e3));var c,u,f,m;f=t,m=t,e.fatherDiv.clientWidth<t&&(f=e.fatherDiv.clientWidth),e.fatherDiv.clientHeight<t&&(m=e.fatherDiv.clientHeight),c=(e.fatherDiv.clientWidth-f)/2,u=(e.fatherDiv.clientHeight-m)/2,e.waitDiv.style.position="absolute",MyrSetDivPos(e.waitDiv,c,u),MyrSetDivSize(e.waitDiv,f,m),e.waitDiv.innerHTML=MyrCtx.waitSvg,e.fatherDiv.appendChild(e.waitDiv)}function MyrStopWait(e){MyrIsDefined(e.waitDiv)&&e.waitDiv.parentElement.removeChild(e.waitDiv),e.waitDiv=null}function MyrTimeoutWait(e){delete e.loadTimer,e.isLoaded||MyrError(e,"Impossible to load "+e.src)}function MyrGetXMLValue(e,t,r){var o,a=new RegExp("<"+t+"\\s([^>]*)","gi");return o=a.exec(e),o&&o.length>1&&(a=new RegExp(r+"\\s*=\\s*[\\\"\\']([^\\\"\\']*)","gi"),o=a.exec(o[1]),o&&o.length>1)?o[1]:""}function MyrError(e,t,r){var o,a,i;if(!e.isError){e.isError=MyrCtx.vrai;var n=56;e.unclippedFather.clientWidth<n+100&&(e.unclippedFather.style.width=n+100+"px"),e.unclippedFather.clientHeight<n+40?(e.unclippedFather.style.height=n+40+"px",o=e.unclippedFather.clientWidth/2,a=e.unclippedFather.clientHeight/2,i=.75,o/=.75):(i=1,o=e.unclippedFather.clientWidth/2,a=e.unclippedFather.clientHeight/2);var s=MyrCtx.svgHeader;s+="viewBox='0 0 "+e.unclippedFather.clientWidth+" "+e.unclippedFather.clientHeight+"'>",s+="<rect x='0' y='0' width='"+e.unclippedFather.clientWidth+"' height='"+e.unclippedFather.clientHeight+"' fill='#000000' opacity='0.8'/>",s+="<g transform='scale("+i+")'>",s+="<rect x='"+(o-n/2)+"' y='"+(a-n/2)+"' width='"+n+"' height='"+n+"'",s+=" stroke='#FFFFFF' stroke-width='2'  stroke-linecap='round' stroke-dasharray='4,4' opacity='0.6' fill='none' />",s+="<circle cx='"+o+"' cy='"+a+"' r='"+n/3+"' fill='#FFFFFF' opacity='0.5'/>",s+="<circle cx='"+(o-n/8)+"' cy='"+(a-n/20)+"' r='"+n/13+"' fill='#000000' opacity='0.6'/>",s+="<circle cx='"+(o+n/8)+"' cy='"+(a-n/20)+"' r='"+n/13+"' fill='#000000' opacity='0.6'/>";var l=o,d=a+n/2,y=n/3,c=-3.14/3,u=3.14-c,f=l+y*Math.cos(c),m=d+y*Math.sin(c),M=l+y*Math.cos(u),p=d+y*Math.sin(u);s+="<path d='M "+f+" "+m+" A "+y+" "+y+" 0 0 0 "+M+" "+p+"' stroke='#000000' stroke-width='2' opacity='0.6' fill='none'/>",s+="<text text-anchor='middle' x='"+o+"' y='"+(a+n)+"' fill='#FFFFFF' stroke='none' font-family='sans-serif' font-size='12px'>"+t+"</text>",MyrIsDefined(r)&&(s+="<text text-anchor='middle' x='"+o+"' y='"+(a+n+14)+"' fill='#FFFFFF' stroke='none' font-family='sans-serif' font-size='12px'>"+r+"</text>"),s+="</g></svg>",e.unclippedFather.clientWidth<60&&(e.unclippedFather.style.width="60px"),e.unclippedFather.clientHeight<60&&(e.unclippedFather.style.height="60px"),e.unclippedFather.innerHTML=s}}function MyrMixAction(e,t,r,o){t<e.sound.track.length&&MyrIsDefined(r)&&MyrIsDefined(o)&&("active"!=r||MyrIsDefined(e.sound.solotrack)||MyrSetTrackActive(e,t,parseInt(o)),"solo"==r&&MyrSetTrackSolo(e,t,parseInt(o)),"volume"==r?MyrSetTrackVolume(e,t,parseFloat(o)):"panning"==r&&MyrSetTrackPanning(e,t,parseFloat(o))),MyrSoundChangeData(e)}function MyrMixDoItem(e,t,r,o){var a,i,n,s,l,d,y;if(a=r.tag.split("_"),i=a[1],n=parseInt(a[2]),"update"==o){var c,u=!MyrIsDefined(e.sound.solotrack),f=document.getElementById("Myr-"+e.index+"-"+t.tag+"-"+r.tag),m=[];if(m[0]={},m[0].opacity=.3,m[0].bgcolor="#A0A0A0",m[0].fgcolor="#000000",m[1]={},m[1].opacity=1,m[1].bgcolor="#E0E0D0",m[1].fgcolor="#404040",m[2]={},m[2].opacity=1,m[2].fgcolor="#404040","on"==i)m[2].bgcolor="#00FF00",c=u?e.sound.track[n].active?2:1:0,f.style.fill=m[c].bgcolor,f.style.stroke=m[c].fgcolor,f.style.opacity=m[c].opacity;else if("off"==i)m[2].bgcolor="#FF0000",c=u?e.sound.track[n].active?1:2:0,f.style.fill=m[c].bgcolor,f.style.stroke=m[c].fgcolor,f.style.opacity=m[c].opacity;else if("solo"==i)m[2].bgcolor="#FF00FF",c=e.sound.solotrack==n?2:1,f.style.fill=m[c].bgcolor,f.style.stroke=m[c].fgcolor,f.style.opacity=m[c].opacity;else if("vol"==i)s=document.getElementById("MyrThumb-"+e.index+"-"+r.tag),s&&s.setAttribute("transform","translate("+e.sound.track[n].volume*r.toolscale+")"),!u&&n!=e.sound.solotrack||u&&0===e.sound.track[n].active?MyrToolSetActiveState(e,e.index+"-"+r.tag,"inactive",MyrCtx.faux):MyrToolSetActiveState(e,e.index+"-"+r.tag,"active",MyrCtx.faux);else if("pan"==i){if(s=document.getElementById("MyrThumb-"+e.index+"-"+r.tag)){var M=e.sound.track[n].panning;M=0>M?-1+(e.sound.track[n].panningtrim+1)*(M+1):1-(1-e.sound.track[n].panningtrim)*(1-M),s.setAttribute("transform","translate("+(M*r.toolscale/2+r.toolscale/2)+")")}!u&&n!=e.sound.solotrack||u&&0===e.sound.track[n].active?MyrToolSetActiveState(e,e.index+"-"+r.tag,"inactive",MyrCtx.faux):MyrToolSetActiveState(e,e.index+"-"+r.tag,"active",MyrCtx.faux)}}else"over"==o||"click"!=o&&"drag"!=o||("off"==i?MyrAction(e,"action_mixer "+n+" active 0"):"on"==i?MyrAction(e,"action_mixer "+n+" active 1"):"solo"==i?MyrAction(e,"action_mixer "+n+" solo 1"):"vol"==i?(l=e.mouse.x-t.box.left-r.x,d=e.mouse.y-t.box.top-r.y,y=20*r.size.height/100,l=(l-y)/(r.size.width-2*y),0>l?l=0:l>1&&(l=1),MyrAction(e,"action_mixer "+n+" volume "+l)):"pan"==i&&(l=e.mouse.x-t.box.left-r.x,d=e.mouse.y-t.box.top-r.y,y=20*r.size.height/100,l=(l-y)/(r.size.width-2*y),0>l?l=0:l>1&&(l=1),l=2*(l-.5),e.sound.track[n].panningtrim&&(l=l<e.sound.track[n].panningtrim?-1+(l+1)/(e.sound.track[n].panningtrim+1):l>e.sound.track[n].panningtrim?1-(1-l)/(1-e.sound.track[n].panningtrim):0),MyrAction(e,"action_mixer "+n+" panning "+l)),MyrDlogUpdate(e,t));console.log("MyrMixDoItem")}function MyrMixTable(e){var t=MyrDlogGetDlogIndexByTag(e,"mixer");if(t>=0)MyrDlogClose(e,"mixer");else if(t=MyrDlogNew(e,"mixer",MyrThemeGetRawIcon(e,e.theme.mixer,25,25,2,2,2,2,.7,2,"#000000","#E0E0E0"),MyrCtx.vrai),t>=0){for(var r=e.dlog.list[t],o=0;o<e.sound.track.length;o++){MyrDlogAddItem(e,t,"static",MyrStrLimit(e.sound.track[o].name,20),"name"+o,0,null,"newline left middle",10,0),MyrDlogAddTool(e,t,e.theme.volume,150,23,30,0,"mixer_vol_"+o,MyrMixDoItem,"center",0,5);var a="mixer_solo_"+o,i="Myr-"+e.index+"-"+r.tag+"-"+a;content=MyrThemeGetRawIcon(e,e.theme.mixtracksolo,18,18,2,5,2,2,1,2,"000000","E0E0E0",i),MyrDlogAddItem(e,t,"static",content,a,0,MyrMixDoItem,"right middle",0,0),a="mixer_on_"+o,i="Myr-"+e.index+"-"+r.tag+"-"+a,content=MyrThemeGetRawIcon(e,e.theme.mixtrackon,18,18,2,5,2,2,1,2,"000000","E0E0E0",i),MyrDlogAddItem(e,t,"static",content,a,0,MyrMixDoItem,"right middle",0,0),a="mixer_off_"+o,i="Myr-"+e.index+"-"+r.tag+"-"+a,content=MyrThemeGetRawIcon(e,e.theme.mixtrackoff,18,18,2,5,2,2,1,2,"000000","E0E0E0",i),MyrDlogAddItem(e,t,"static",content,a,0,MyrMixDoItem,"right middle",4,0),e.sound.useAudioFailSafe||MyrDlogAddTool(e,t,e.theme.stereo,150,10,0,0,"mixer_pan_"+o,MyrMixDoItem,"newline center",0,-10)}MyrDlogOpen(e,t,e.unclippedFather,"center topquarter persistent",0,0,e.theme)}}function MyrProgressBarOpen(e,t,r){var o=MyrDlogNew(e,t,"",MyrCtx.faux,300);if(o>=0){for(var a=0;r>a;a++)MyrDlogAddItem(e,o,"static","-","txt"+a,0,null,"newline left middle",0,0),MyrDlogAddItem(e,o,"progress","-","bar"+a,0,null,"newline center middle",0,0);MyrDlogOpen(e,o,e.unclippedFather,"center middle persistent",0,e.toolheight,e.theme)}return o}function MyrProgressBarSet(e,t,r,o,a){console.log(t+" "+r+"="+o+" "+a),MyrDlogSetItemValue(e,t,"txt"+r,MyrStrLimit(o,20)),MyrDlogSetItemValue(e,t,"bar"+r,a)}function MyrProgressBarClose(e,t){MyrDlogClose(e,t)}function MyrIsDefined(e){return"undefined"!=typeof e&&null!==e}function MyrBool(e){if(!MyrIsDefined(e))return MyrCtx["false"];switch(e.toString().toLowerCase()){case"1":case"true":case"yes":case"y":case"on":return MyrCtx.vrai;default:return MyrCtx.faux}return MyrCtx.faux}function MyrDeleteSvgHeader(e){var t=e.indexOf("<svg ");return t>=0&&(t=e.indexOf(">",t+1),t>=0)?e.substr(t+1):e}function MyrReplaceSVGTokens(obj,toolindex,str,forcedwidth){var width,objindex,bgcolor,fill,stroke,both,sboth,shadow,autoshadow,hmargin,vmargin;return width=MyrIsDefined(obj.toolbar)&&MyrIsDefined(obj.toolbar.tool)&&toolindex>=0&&toolindex<obj.toolbar.tool.length?obj.toolbar.tool[toolindex].width100:MyrIsDefined(forcedwidth)?forcedwidth:100,objindex=obj.index,bgcolor=obj.theme.bgcolor,fill="stroke='none'",stroke="fill='none'",both="",shadow="fill='#000000' opacity='0.1' stroke='none'",sboth="fill='"+obj.theme.stroke+"'",autoshadow="transform='translate(7,7)' fill='#000000' opacity='0.1' stroke='none'",hmargin=parseFloat(obj.theme.hmargin),vmargin=parseFloat(obj.theme.vmargin),str=str.replace(/\[([^\]]+)\]/gi,function(match,val){return eval(val).toString()})}function MyrStrLimit(e,t){return e.length>t&&(e=e.substr(0,t-3)+"..."),e}function MyrToggleFullScreen(e){document.mozFullScreen||document.webkitFullScreen?document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}function MyrSafeGet(e,t){var r,o,a=t.split(/[\.\[]/),i=e;for(r=0;r<a.length&&MyrIsDefined(i);r++)o=a[r].replace("]",""),i=i[o];return MyrIsDefined(i)||(i=null),i}function MyrSafeDispose(obj,path){null!==MyrSafeGet(obj,path)&&eval("obj."+path+"=null;")}function MyrSetDivSize(e,t,r){MyrIsDefined(e)&&(t>=0&&(e.width=parseFloat(t),e.style.width=t+"px"),r>=0&&(e.height=parseFloat(r),e.style.height=r+"px"))}function MyrSetDivPos(e,t,r){MyrIsDefined(e)&&(e.style.left=t+"px",e.style.top=r+"px")}function MyrSetTransition(e,t,r){if(MyrIsDefined(e.animationRatio))if(0===e.animationRatio)r="";else{var o=/([\d\.]+)s/g;r=r.replace(o,function(t,r){return e.animationRatio*parseFloat(r)/100+"s"})}t.setAttribute("transition",r),t.style.transition=r}function MyrStartTimer(e,t,r){MyrIsDefined(MyrCtx.myrTimer[e])||(MyrCtx.myrTimer[e]={},MyrCtx.myrTimer[e].id=window.setInterval(t,r),MyrCtx.myrTimer[e].count=0)}function MyrStopTimer(e){window.clearInterval(MyrCtx.myrTimer[e].id),MyrCtx.myrTimer[e]=null}function MyrCallback(e){for(var t=[],r=0;r<arguments.length-1;r++)t[r]=arguments[r+1];return function(r){var o=e.apply(this,t);return console.log(o+" "+(r||window.event)),o==MyrCtx.vrai&&(r||window.event).stopPropagation(),o}}function MyrCreateUndraggableElement(e,t){var r=document.createElement(e);return r.style="overflow:hidden; -moz-user-select: -moz-none; -khtml-user-select: none; -webkit-user-select: none; -ms-user-select: none; user-select: none;",r.setAttribute("unselectable","on"),r.setAttribute("draggable","false"),MyrIsDefined(t)&&(r.style.zIndex=t),r}function MyrSetUndraggable(e){e.style.MozUserSelect="-moz-none",e.style.KhtmlUserSelect="none",e.style.WebkitUserSelect="none",e.style.MsUserSelect="none",e.style.userSelect="none",e.style.overflow="hidden",e.setAttribute("unselectable","on"),e.setAttribute("draggable","false")}function MyrCompleteStyle(e,t){if(MyrIsDefined(t)){var r=t.split(";");for(var o in r)if(r[o].length>3){var a=r[o].split(":"),i=a[0].replace(/-([a-z])/g,function(e){return e[1].toUpperCase()}).trim();e.style[i]=a[1],"transform"==i&&(i=i.substr(0,1).toUpperCase()+i.substr(1),e.style["Ms"+i]=a[1],e.style["Webkit"+i]=a[1],e.style["Moz"+i]=a[1],e.style["O"+i]=a[1])}}}function MyrGetRGBA(e,t){var r=e,o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return o&&(r="rgba("+parseInt(o[1],16)+","+parseInt(o[2],16)+","+parseInt(o[3],16)+","+t+")"),r}function MyrCreateGradient(e,t){var r=e.split(" "),o="";if(0===r[0].indexOf("#")||0===r[0].indexOf("rgb"))return r[0];for(var a=1,i=r[a++];a<r.length;a+=3){var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r[a+1]);o+=", rgba("+parseInt(n[1],16)+","+parseInt(n[2],16)+","+parseInt(n[3],16)+","+r[a+2]+") "+r[a]}return o=MyrIsDefined(t)&&t!==!1?"linear-gradient("+i+"deg"+o+")":"-webkit-linear-gradient("+(90-i)+"deg"+o+");-ms-linear-gradient("+(90-i)+"deg"+o+");linear-gradient("+i+"deg"+o+")"}function MyrSetDivBackground(e,t){if(MyrIsDefined(t))if(t=MyrCreateGradient(t),"#"==t.substr(0,1))e.style.backgroundColor=t;else for(var r=t.split(";"),o=0;o<r.length;o++)e.style.background=r[o];else e.style.background=e.style.backgroundColor=""}function MyrPrepareThemes(e){e.theme=[],e.theme.unknown="100 <text x='30' y='90' font-family='Helvetica,Arial,	sans-serif' font-weight='bolder' font-size='120' [both]>?</text>",e.theme.moon={},e.theme.moon.hmargin="30",e.theme.moon.vmargin="30",e.theme.moon.focusshadow="0px 0px 5px 2px rgba(128,128,128,0.4)",e.theme.moon.overtransition="0.15s ease",e.theme.moon.notoverfill="#FFFFFF",e.theme.moon.notoverstroke="#FFFFFF",e.theme.moon.notoverstrokewidth="0",e.theme.moon.notoveropacity="0",e.theme.moon.notoverscale="0",e.theme.moon.overfill="#FFFFFF",e.theme.moon.overstroke="#FFFFFF",e.theme.moon.overstrokewidth="0",e.theme.moon.overopacity="0.4",e.theme.moon.overscale="1",e.theme.moon.over="<ellipse cx='[width/2]' cy='50' ry='[50+vmargin*0.8]'	 rx='[width/2+hmargin]' stroke='none'/>",e.theme.moon.transition="0.4s ease",e.theme.moon.pulsetransition="0.7s ease",e.theme.moon.pulsefill="#FFFFFF",e.theme.moon.inactivestroke="#A0A0A0",e.theme.moon.inactivestrokewidth="0",e.theme.moon.inactivefill="#A0A0A0",e.theme.moon.inactiveopacity="0.2",e.theme.moon.inactivescale="0.80",e.theme.moon.stroke="#707070",e.theme.moon.strokewidth="6",e.theme.moon.fill="#A0C0A0",e.theme.moon.opacity="1",e.theme.moon.scale="1",e.theme.moon.dlogclosebox="100 <rect x='10' y='10' width='80' height='80' [both] fill='#F0C0C0'/>   <path d='M 30 30 L 70 70 M 70 30 L 30 70' [stroke]/>",e.theme.moon.mixtrackoff="100 <circle cx='50' cy='50' r='50' [both] />                                <path d='M 22 22 L 78 78 M 78 22 L 22 78' [stroke] />",e.theme.moon.mixtrackon="100 <circle cx='50' cy='50' r='50' [both] />                                <path d='M 25 40 L 48 80 C 48 70 70 20  75 20' [stroke] />",e.theme.moon.mixtracksolo="100 <circle cx='50' cy='50' r='50' [both] />                                <path d='m 66,30 c 0,-8 -7,-13 -18,-13 -17,0 -21,7 -21,16 -0,16 45,9 45,36 -0,9 -6,15 -21,15 -15,0 -23,-3 -24,-16' [stroke] />",e.theme.moon.pgpop="100 <path d='M 50 0 L 30 20 L 30 100 L 100 100 	L 100 0z'[both] /><path d='M 60 10 L 50 0 L 30 20 L 40 30 L 60 30z' [shadow] />	<path d='M 50 0 L 30 20 L 50 20z' [fill] />",e.theme.moon.pgm="100 <path d='M 0 50 L 20 30 L 20 70z' [fill]/>	<path d='M 50 0 L 30 20 L 30 100 L 100 100 L 100 0z'[both] /><path d='M 60 10	 L 50 0 L 30 20 L 40 30 L 60 30z' [shadow] />	<path d='M 50 0 L 30 20 L 50 20z' [fill] />",e.theme.moon.pgmr="60 <path d='M 30 50 L 50 30 L 50 70z' [both]/>",e.theme.moon.pgp="100 <path d='M 100 50 L 80 30 L 80 70z' [fill]/>	<g transform='translate(-30,0)'>	<path d='M 50 0 L 30 20 L 30 100 L 100 100 L 100 0z'[both] />	<path d='M 60 10 L 50 0 L 30 20 L 40 30 L 60 30z' [shadow] />	<path d='M 50 0 L 30 20 L 50 20z' [fill] /></g>",e.theme.moon.pgpr="60 <path d='M 30 50 L 10 30 L 10 70z' [both]/>",e.theme.moon.pgfield="200 <rect x='-20' y='5' width='240' height='90' 	[both] fill='#F0F0F0'/><text id='MyrText-[objindex]-[toolindex]' x='0' y='77'	 font-family='Arial,sans-serif' font-weight='normal' font-size='65'	 stroke='none' fill='black'>-</text>",e.theme.moon.zoompop="100 <path d='M 58 72 L 83 97 	Q 100 100 97 83 L 72 58z' [both]/>	<circle cx='35' cy='35' r='35' [stroke]/>	<circle cx='35' cy='35' r='40' [stroke]/>	<ellipse cx='30' cy='20' rx='14' ry='10' fill='#FFFFFF' 	stroke='none' opacity='0.6'/>",e.theme.moon.zoomm="100 <path d='M 20 35 L 50 35' [stroke]/>	<path d='M 58 72 L 83 97 Q 100 100 97 83 L 72 58z' [both]/>	<circle cx='35' cy='35' r='35' [stroke]/>	<circle cx='35' cy='35' r='40' [stroke]/>	<ellipse cx='30' cy='20' rx='14' ry='10' fill='#FFFFFF' 	stroke='none' opacity='0.6'/>",
e.theme.moon.zoommr="100 <g style='transform-origin:50px 50px'	 transform='scale(0.6)'>	<path d='M 20 35 L 50 35' [stroke]/>	<path d='M 58 72 L 83 97 Q 100 100 97 83 L 72 58z' [both]/>	<circle cx='35' cy='35' r='35' [stroke]/>	<circle cx='35' cy='35' r='40' [stroke]/>	<ellipse cx='30' cy='20' rx='14' ry='10' fill='#FFFFFF'	 stroke='none' opacity='0.6'/></g>",e.theme.moon.zoomp="100 <path d='M 80 35 L 50 35 M 65 20 L 65 50'	 [stroke]/><path d='M 42 72 L 17 97 Q 0 100 3 83 L 28 58z' [both]/>	<circle cx='65' cy='35' r='35' [stroke]/><circle cx='65' 	cy='35' r='40' [stroke]/>	<ellipse cx='60' cy='20' rx='14' ry='10' fill='#FFFFFF' 	stroke='none' opacity='0.6'/>",e.theme.moon.zoompr="100 <g style='transform-origin:50px 50px'	 transform='scale(-0.6,0.6)'>	<path d='M 20 35 L 50 35 M 35 20 L 35 50' [stroke]/>	<path d='M 58 72 L 83 97 Q 100 100 97 83 L 72 58z' [both]/>	<circle cx='35' cy='35' r='35' [stroke]/>	<circle cx='35' cy='35' r='40' [stroke]/>	<ellipse cx='30' cy='20' rx='14' ry='10' fill='#FFFFFF' stroke='none'	 opacity='0.6'/></g>",e.theme.moon.zoomfield="200 <rect x='5' y='5' width='190' height='90' 	[both] fill='#F0F0F0'/>",e.theme.moon.print="100 <path d='M0 76 L 0 44 C 0 38 5 33 11 33 L 89 33	C 95 33 100 38 100 44 L 100 76z' [both]/>	<path d='M 28 0 L72 0 L 72 24 L 28 24z' [both]/>	<path d='M22 76 L 22 100 L 78 100 L 78 76' [stroke]/>	<circle cx='84' cy='45' r='5' [stroke]/>",e.theme.moon.play="100 <path d='M 0 0 L 0 100 L 100 50z' 	transform='translate(15,0)' [both]/>",e.theme.moon.pause="100 <path d='M 10 0 L 10 100 L 40 100 L 40 0z	 M 60 0 L 60 100 L 90 100 L 90 0z' [both]/>",e.theme.moon.stop="100 <path d='M 0 0 L 0 100 L 100 100 L 100 0z' [both]/>",e.theme.moon.volume="300 <path d='M 10 40 L [width-10] 40 Q [width]	 50 [width-10] 60 L 10 60 Q 0 50 10 40z' [both]/>	<g id='MyrThumb-[objindex]-[toolindex]' >	<circle cx='0' cy='50' r='25' [autoshadow]/>	<circle cx='0' cy='50' r='25' [both]/></g>",e.theme.moon.volume2="200 <g><clipPath id='vol-[objindex]-[toolindex]'>	<path d='M 0 75 L [width] 25 L [width] 75z' clip-rule='nonzero'/>	</clipPath><g clip-path='url(#vol-[objindex]-[toolindex])'>	<rect id='MyrThumb-[objindex]-[toolindex]' x='-[width]' y='0' height='100'	 width='[width]' [fill]'></g><path d='M 0 75 L [width] 25 L [width] 75z'	 [stroke]/>",e.theme.moon.mixer="100 <rect x='0' y='0' width='100' height='100' [fill]/>	<line x1='25' y1='25' x2='25' y2='75' [stroke]/>	<line x1='50' y1='25' x2='50' y2='75' [stroke]/>	<line x1='75' y1='25' x2='75' y2='75' [stroke]/>	<circle cx='25' cy='54' r='12' [both]/>	<circle cx='50' cy='37' r='12' [both]/>	<circle cx='75' cy='63' r='12' [both]/>",e.theme.moon.mixer2="100 <rect x='10' y='15' width='80' height='15' [both]/>	<rect x='10' y='40' width='80' height='15' [both]/>	<rect x='10' y='65' width='80' height='15' [both]/>",e.theme.moon.metronome="100 <path d='M10 100 L 90 100 L 60 0 L 40 0z' 	stroke-linejoin='round' [both]/> 	<path stroke-linecap='round' d='M 30 70 	L 70 70 M 50 70 L 85 15' [stroke]/>",e.theme.moon.metronome2="100 <path d='M32 15 L 68 15 L 82 70 L 18 70z'	 fill-opacity='0.4' stroke-width='4' [both]/> 	<path d='M 10 95 L 90 95 L 80 70 L 20 70z M 34 15 Q 50 -15 66 15z' 	stroke-linejoin='round' [both]/><path d='M 50 70 L 80 20' [stroke]/>",e.theme.moon.rewind="100 <path d='M 10 50 L 50 10 L 50 50 L90 10 	L 90 90 L 50 50 L50 90z' [both]/>",e.theme.moon.fastfw="100 <path d='M 90 50 L 50 10 L 50 50 L10 10 	L 10 90 L 50 50 L50 90z' [both]/>",e.theme.moon.view="100 <path d='M 0 64 Q 50 -19 100 64 Q 50 94 0 64z'	 fill='white' fill-opacity='0.4' [stroke]/>	<circle cx='50' cy='50' r='28' [both]/>	<circle cx='50' cy='50' r='13' opacity='0.4' stroke='none' fill='#000000'/>	<circle cx='45' cy='39' r='10' opacity='0.6' stroke='none' fill='#FFFFFF'/>",e.theme.moon.fileinfo="100 <circle cx='50' cy='50' r='40' [both]/>	<text x='35' y='73' font-family='serif' font-size='80' font-weight='bolder'	 font-style='italic' opacity='0.8' stroke='none' fill='#FFFFFF'>i</text>",e.theme.moon.info="100 "+e.myrwebLogo+"<circle cx='50' cy='50' r='50' [both]/><g stroke-width='3' transform='translate(22 22) scale(0.56)' opacity='0.7'><use xlink:href='#myrwebLogo'/></g>",e.theme.moon.detune="60 <path d='m 0,0 5,0 0,50 c 0,7 15,6 15,0 l 0,-50 5,0	0,52 c 0,5 -10,8 -10,8 l 0,15 c 0,0 3,1 3,5 0,4 -2.5,5.5 -5.5,5.5 C 9.5,85.5 7,84 7,80 7,76 10,75 10,75 L 10,60 C 10,60 0,57 0,52 z' [both] />",e.theme.moon.detune2="100 <g transform='rotate(-25,30,80)'>	<ellipse cx='30' cy='80' rx='20' ry='12' [sboth]/>	<ellipse cx='28' cy='72' rx='12' ry='5' stroke='none' [fill] opacity='0.6'/>	</g><path d='M 49 74 L 49 0 M 80 10 L 80 90 M 70 20	 L 80 10 L 90 20 M 70 80 L 80 90 L 90 80' stroke-linecap='round' [stroke]/> ",e.theme.moon.download="100 <rect x='10' y='60' width='80' height='35' 	opacity='0.5' [both]/>	<path d='M 50 70 L 75 40 L 60 40 L 60 10 L 40 10 L 40 40 L 25 40z' 	stroke-linejoin='round' [both]/>",e.theme.moon.fast="600 <path d='M 422,2 C 392,1 421,122 408,192 c -13,49 -40,10 -178,8 -101,1 -155,125 -155,170 -88,-33 -70,114 7,67 0,0                            31,28 55,35 139,27 70,-26 160,-18 32,-6 207,77 135,-22 6,-25 54,-37 61,-98 7,-60 -4,-84 -4,-84 0,0 53,54 83,26 31,-29                            3,-110 -63,-138 0,0 29,-136 1,-135 C 481,3 472,109 462,122 c -12,-6 2,-123 -40,-120 z' [fill]/>",e.theme.moon.slow="600 <path  d='M 247,6 C 93,3 65,195 65,195 l -56,33 72,0 c 0,0 -3,72 21,88 25,16 101,11 82,-12 -18,-23 -49,-45 -34,-57                            15,-12 160,-9 200,14 40,23 10,47 29,58 18,11 67,16 67,-10 0,-26 -62,-47 -28,-52 34,-5 37,-34 52,-64 14,-29 9,-74 40,-78                            30,-3 19,31 46,28 26,-2 34,-11 32,-51 C 590,52 573,14 535,9 497,3 461,117 449,116 437,114 401,8 247,6 z' [fill]/>",e.theme.moon.tickbefore="600 <rect x='200' y='0' width='200' height='200' [stroke]/><rect x='400' y='0' width='200' height='200' [stroke]/>                                    <circle cx='100' cy='100' r='50' [fill]/>",e.theme.moon.tickbar="600 <rect x='200' y='0' width='200' height='200' [stroke]/><rect x='400' y='0' width='200' height='200' [stroke]/>                                    <circle cx='200' cy='100' r='50'  [fill]/>                                     <circle cx='400' cy='100' r='50' [fill]/>                                     <circle cx='600' cy='100' r='50' [fill]/>",e.theme.moon.tickbeat="600 <rect x='200' y='0' width='200' height='200' [stroke]/><rect x='400' y='0' width='200' height='200' [stroke]/>                                     <circle cx='200' cy='100' r='50' [fill]/>                                     <circle cx='300' cy='100' r='50' [fill]/>                                     <circle cx='400' cy='100' r='50' [fill]/>                                     <circle cx='500' cy='100' r='50' [fill]/>                                     <circle cx='600' cy='100' r='50' [fill]/>",e.theme.moon.magnifier="100 <path d='M 58 72 L 83 97 Q 100 100 97 83 L 72 58z' [both]/>                        	<circle cx='35' cy='35' r='35' [stroke]/>                        	<circle cx='35' cy='35' r='40' [stroke]/>                        	<ellipse cx='30' cy='20' rx='14' ry='10' fill='#FFFFFF'                         	stroke='none' opacity='0.6'/>",e.theme.moon.instrument="500 <path d='m 493,5 c 7,9 -0,13 -2,25 -14,1 -14,4 -17,8 0,9 27,8 17,20 -13,11 -14,-19 -21,-15 -2,2 -3,4 -5,7 4,10 27,9                                 12,22 -10,9 -11,-23 -18,-15 -19,23 -77,86 -86,95 2,4 34,30 12,71 -21,30 -46,27 -47,40 -21,-13 -34,1 -44,14 -9,12 -15,33 1,49                                -17,4 -11,33 -35,54 -13,10 -29,19 -48,18 -30,-4 -51,-18 -63,-29 -12,-11 -37,-44 -38,-62 -2,-20 8,-30 21,-46 13,-17 43,-20 52,-38                                15,17 32,5 44,-3 11,-8 28,-30 11,-40 15,-6 12,-21 30,-42 11,-16 52,-27 85,-2 35,-37 63,-65 78,-80 9,-8 -29,-7 -18,-21 11,-12                                17,15 24,14 3,-2 8,-6 12,-10 -1,-3 -29,-7 -16,-20 9,-8 16,20 21,14 4,-4 13,-9 12,-22 7,-4 17,-11 24,-4 z' [fill]/>",e.theme.moon.duration="100 <circle cx='50' cy='50' r='50' [stroke]/><path d='M 40 10 L 50 50 L 75 50' [stroke]/>",e.theme.moon.calendar="100 <path d='M 0 10 L 20 10 L 20 20 L 30 20 L 30 10 L 70 10 L 70 20 L 80 20 L 80 10 L 100 10 L 100 40 L 0 40z' [fill]/>                                    <path d='M 0 40 L 0 100 L 100 100 L 100 40 L 90 40 L 90 90 L 10 90 L 10 40z' [fill] />                                    <path d='M 22 0 L 22 18 L 28 18 L 28 0z'  [fill] />                                     <path d='M 72 0 L 72 18 L 78 18 L 78 0z'  [fill] />",e.theme.moon.track="100 <path d='M 0 50 L 5 50 L 10 30 L 15 70 L 20 20 L 25 80 L 30 25 L 35 75 L 40 10 L 45 90 L 50 0                                             L 55 100 L 60 15 L 65 85 L 70 40 L 75 60 L 80 45 L 85 55 L 90 50 L 100 50' [stroke]/>",e.theme.moon.light="250 <path d='M 1,280 C -2,277 21,234 21,234 14,155 54,110 94,59 L 128,79 108,46 C 149,2 218,-4 226,3                                    254,29 184,150 143,187 l -52,-9 41,22 C 92,234 82,199 34,242 23,254 5,282 1,280 z' [fill]/>",e.theme.moon.heavy="500 <path d='M 90 110 0 390 500 390 410 110z' [both]/><circle cx='250' cy='80' r='80' [stroke]/>",e.theme.moon.square="100 <rect x='0' y='0' width='100' height='100' [both]/>",e.theme.moon.powered="60 <path d='M 0,76 0,35 C 0,0 67,0 68,33 l 0,43 z M 0,83 l 66,6 0,25 -66,0 z' [fill] />                                    <circle cx='25' cy='45' r='12' stroke='none' fill='#FFFFFF'/> <circle cx='29' cy='47' r='3' fill='#FF0000' stroke='none'/>                                    <circle cx='53' cy='45' r='12' stroke='none' fill='#FFFFFF'/> <circle cx='57' cy='47' r='3' fill='#FF0000' stroke='none'/>",e.theme.moon.overlay="50 <rect x='0' y='0' width='30' height='50' [both]/><rect x='15' y='15' width='35' height='55' opacity='0.3' stroke='none' fill='#000000'/>",e.theme.moon.note="100 <path d='m 22,152 c -48,32 -7,67 32,39 29,-20 23,-40 23,-40 C 75,16 74,0 74,0 L 70,0 72,141 c 0,0 -23,-6 -49,11 z' [fill]/>",e.theme.moon.txt="100 <path d='M 0 0 l 65 0 M 30 0 l 0 67  M 49 67 L 72 38 M 49 38 l 23 28 M 88 21 c 0,0 0,36 0,42 0,7 12,2 12,2 M 80 34 L 95 34' [stroke]/>",e.theme.moon.barnum="400 <rect x='0' y='20' width='200' height='160' [stroke]/><rect x='200' y='20' width='200' height='160' [stroke]/>                                <path d='M 155 200 L 155 0 L 245 200 L 245 0' fill='none' stroke-width='40' stroke='#000000'/>",e.theme.moon.stereo="100 <g id='MyrThumb-[objindex]-[toolindex]' >    	<path d='M -25 90 L 0 10 L 25 90z' [both]/></g>",e.theme.moon.pagebgcolor="#FFFFF9",e.theme.moon.bgcolor="#E0E0F0",e.theme.moon.toolbarbackground="gradient 180 0% #000000 0.4 	3% #FFFFFF 1 10% #FFFFFF 0.5 50% #FFFFFF 0 	51% #000000 0 90% #000000 0.1 100% #000000 0.25",e.theme.moon.titlebackground="gradient 45 0% #FFFFFF 0.3 100% #000000 0.1",e.theme.moon.positionbackground="gradient -90 0% #FFFFFF 0.3 	100% #000000 0.1",e.theme.moon.keyboardbackground="gradient -10 40% #000000 1 	80% #AAAAAA 1 100% #000000 1",e.theme.moon.toolbarshadow="0px 2px 10px 2px rgba(0,0,0,0.2)",e.theme.moon.positionshadow="0px 2px 5px 2px rgba(0,0,0,0.3)",e.theme.moon.dialogbox="border-style: solid;border-width: 1px;	border-color:#A0A0A0;border-radius:3px;	box-shadow:2px 2px 3px 3px rgba(130,130,130,0.40);	padding:0px 0px 0px 0px;",e.theme.moon.dialogboxopen="transform:scale(1);transition:transform 0.27s ease-in-out;	transform-origin:50% 5%",e.theme.moon.dialogboxbgcolor="#FFF6F0",e.theme.moon.dialogboxclose="transform:scale(0.6,0)",e.theme.moon.dialogtitle="",e.theme.moon.dialogtitlebgcolor="#FFD070",e.theme.moon.titletextstyle="font-family:Lucida Grande,Lucida Sans Unicode,	Lucida Sans,Geneva,Verdana,sans-serif;font-size:16px;font-weight: bold;color:#404040",e.theme.moon.statictextstyle="font-family:Lucida Grande,Lucida Sans Unicode,	Lucida Sans,Geneva,Verdana,sans-serif;font-size:14px;color:#000000",e.theme.moon.menupanebgcolor="#F8F8FF",e.theme.moon.menupane="border-style: solid;border-width: 1px;	border-color:#A0A0A0;border-radius:3px;	box-shadow:2px 2px 3px 3px rgba(130,130,130,0.40);	padding:8px 24px 8px 8px;transition:transform 0.1s ease;	transform-origin:50% 5%",e.theme.moon.menupaneopen="transform:scale(1)",e.theme.moon.menupaneclose="transform:scale(0.6,0)",e.theme.moon.menuitem="cursor:pointer;padding-left:4px;padding-right:8px;	width:100%;transition:all 0.2s ease",e.theme.moon.menuitemover="background-color:#A0C0A0",e.theme.moon.menuitemidle="background:none",e.theme.moon.menufontfamily="Lucida Grande,Lucida Sans Unicode,	Lucida Sans,Geneva,Verdana,sans-serif",e.theme.moon.menufontsize=14,e.theme.moon.menufontweight="bold",e.theme.moon.menufontextra="rgba(128,128,128,0.99)",e.theme.moon.menufontidle="text-shadow:0px 0px 0px",e.theme.moon.menufontover="text-shadow:0px 0px 3px #FFFFFF",e.theme.moon.menufontdisabled="color:rgba(0,0,0,0.15)",e.theme.moon.menuseparator="stroke-width='2' stroke='black'	 opacity='0.1'",e.theme.moon.menumarksize=12.5,e.theme.moon.menumark1="<path d='M 10 40 Q 30 55 40 80 Q 55 35 95 5'	 stroke-width='20' stroke='#80C080' fill='none' />",e.theme.moon.menumark2="<circle cx='50' cy='50' r='40' fill='#FF0000'	 stroke='#B08080' stroke-width='20'/>",e.theme.moon.menumark3="<circle cx='50' cy='50' r='40' fill='#00FF00'	 stroke='#80B080' stroke-width='20'/>",e.theme.moon.titlefont="Helvetica,Arial,sans-serif",e.theme.moon.titleweight="bold",e.theme.moon.titlecolor="#F0F0F0"}function MyrApplyTheme(e){MyrIsDefined(e.toolbar)&&e.toolbar.div.height&&(MyrSetDivBackground(e.toolbar.div,e.theme.toolbarbackground),MyrIsDefined(e.theme.toolbarshadow)&&(e.toolbar.div.style.boxShadow=e.theme.toolbarshadow,e.toolbar.div.style.overflow="visible"),MyrIsDefined(e.toolbar.tool)&&MyrToolbarChange(e)),MyrIsDefined(e.title)&&e.title.div.height&&(MyrSetDivBackground(e.title.div,e.theme.titlebackground),MyrIsDefined(e.theme.titleshadow)&&(e.title.div.style.boxShadow=e.theme.titleshadow,e.title.div.style.overflow="visible")),MyrIsDefined(e.position)&&e.position.div.height&&(MyrSetDivBackground(e.position.div,e.theme.positionbackground),MyrIsDefined(e.theme.positionshadow)&&(e.position.div.style.boxShadow=e.theme.positionshadow,e.position.div.style.overflow="visible")),MyrIsDefined(e.keyboard)&&e.keyboard.div.height&&(MyrSetDivBackground(e.keyboard.div,e.theme.keyboardbackground),MyrIsDefined(e.theme.keyboardshadow)&&(e.keyboard.div.style.boxShadow=e.theme.keyboardshadow,e.keyboard.div.style.overflow="visible")),e.fatherDiv.style.backgroundColor=e.theme.bgcolor}function MyrThemeGetRawIcon(e,t,r,o,a,i,n,s,l,d,y,c,u){var f,m,M;MyrIsDefined(a)||(a=0),MyrIsDefined(i)||(i=0),MyrIsDefined(n)||(n=0),MyrIsDefined(s)||(s=0),MyrIsDefined(l)||(l=1),MyrIsDefined(d)||(d=3),MyrIsDefined(y)||(y="#404040"),MyrIsDefined(c)||(c="#000000");var p=/(^\d+) (.*$)/.exec(t);m=parseInt(p[1]),f=r/m,M=parseInt(o/f),r=parseInt(r+a+n),o=parseInt(o+i+s),a=parseInt(a/f),i=parseInt(i/f),n=parseInt(n/f),s=parseInt(s/f),d/=f;var g=MyrCtx.svgHeader+"width='"+r+"' height='"+o+"'viewBox='"+-a+" "+-i+" "+(m+a+n)+" "+(M+i+s)+"'><g ";return MyrIsDefined(u)&&(g+="id='"+u+"' "),g+="style='opacity:"+l+";stroke-width:"+d+";stroke:"+y+";fill:"+c+"' >"+MyrReplaceSVGTokens(e,tag,p[2],m)+"</g></svg>"}function MyrInitTheme(e,t){var r,o=t.theme;e.theme={},MyrIsDefined(o)&&MyrIsDefined(MyrCtx.theme[o])||(o="moon"),e.themename=o;for(r in MyrCtx.theme[o])e.theme[r]=MyrCtx.theme[o][r];e.theme.unknown=MyrCtx.theme.unknown,MyrIsDefined(e.args.toolhmargin)&&(e.theme.hmargin=parseInt(e.args.toolhmargin)),MyrIsDefined(e.args.toolvmargin)&&(e.theme.vmargin=parseInt(e.args.toolvmargin));for(r in t)0===r.indexOf("theme-")&&(e.theme[r.substr(6)]=t[r]);MyrApplyTheme(e)}function MyrToolsetAddToList(e,t){var r=t.split("-");if(MyrIsDefined(r[1])&&""!==r[1].trim()||(r[1]="std"),r[0]=r[0].trim(),r[1]=r[1].trim(),"default"!=r[0]){MyrToolsetDeleteFromList(e,r[0]);var o={};o.toolname=r[0],o.toolparam=r[1],e.push(o)}else for(var a="rewind pause play fastfw volume mixer metronome detune view page-complete zoom download print fileinfo info",i=a.split(" "),n=0;n<i.length;n++)MyrToolsetAddToList(e,i[n])}function MyrToolsetDeleteFromList(e,t){for(var r=0;r<e.length;r++)if(e[r].toolname==t)return void e.splice(r,1)}function MyrToolsetIsInList(e,t){for(var r=0;r<e.length;r++)if(e[r].toolname==t)return MyrCtx.vrai;return MyrCtx.faux}function MyrToolsetCreateList(e,t){MyrIsDefined(e.args.toolset)||(e.args.toolset="default");var r=e.args.toolset.split(" "),o=[];t&&(r=[]);for(var a=0;a<r.length;a++)MyrIsDefined(r[a])&&r[a].length>1&&("-"==r[a].substr(0,1)?MyrToolsetDeleteFromList(o,r[a].substr(1)):("+"==r[a].substr(0,1)&&(r[a]=r[a].substr(1)),MyrToolsetAddToList(o,r[a])));if(e.isLoaded){MyrIsDefined(e.page)&&(e.page.div.height&&MyrIsDefined(e.page.view)?(0===e.page.view.length&&MyrToolsetDeleteFromList(o,"measures"),e.page.view.length+e.page.lyrics.length<=1&&MyrToolsetDeleteFromList(o,"view"),0===e.page.view.length&&0===e.page.lyrics.length&&(MyrToolsetDeleteFromList(o,"zoom"),MyrToolsetDeleteFromList(o,"page"))):(MyrToolsetDeleteFromList(o,"page"),MyrToolsetDeleteFromList(o,"view"),MyrToolsetDeleteFromList(o,"measures"),MyrToolsetDeleteFromList(o,"zoom")));var i=e.sound.nbTracks;MyrIsDefined(i)||(i=0),MyrIsDefined(e.sync.staff)&&0!==e.sync.staff.length||MyrToolsetDeleteFromList(o,"keyboard");var n=1;MyrIsDefined(e.sync.metronome)&&0!==e.sync.metronome.length||(n=0),MyrToolsetIsInList(o,"keyboard")&&i++,i+=n,0===i?(MyrToolsetDeleteFromList(o,"play"),MyrToolsetDeleteFromList(o,"stop"),MyrToolsetDeleteFromList(o,"pause"),MyrToolsetDeleteFromList(o,"fastfw"),MyrToolsetDeleteFromList(o,"rewind"),MyrToolsetDeleteFromList(o,"timeslider"),MyrToolsetDeleteFromList(o,"volume"),MyrToolsetDeleteFromList(o,"mixer"),MyrToolsetDeleteFromList(o,"keyboard")):1==i&&MyrToolsetDeleteFromList(o,"mixer"),MyrIsDefined(e.file)&&0!==e.file.length||MyrToolsetDeleteFromList(o,"download"),MyrIsDefined(e.sync)&&MyrIsDefined(e.sync.metronome)||0===i&&MyrToolsetDeleteFromList(o,"metronome")}return o}function MyrToolbarGainFocus(e,t){switch(t.tag){case"pgfield":default:t.edittext=(e.page.currentPage+1).toString()}t.updated=!1,MyrToolbarUpdate(e)}function MyrToolbarLoseFocus(e,t){if(null!==t){switch(t.tag){case"pgfield":default:t.edittext=null}e.toolfocus=null,t.updated=!1,MyrToolbarUpdate(e)}}function MyrToolbarProcessKey(e,t,r){var o,a=!0;if(t&&null!==t.edittext){if(8==r||46==r)t.edittext.length>0&&(t.edittext=t.edittext.substr(0,t.edittext.length-1)),a=!1;else if(r>=48&&57>=r)t.edittext+=(r-48).toString(),a=!1;else if(27==r)MyrToolbarLoseFocus(e,e.toolfocus),e.toolfocus=null,a=!1;else if(13==r){switch(t.tag){case"pgfield":default:o=parseInt(t.edittext),1>o?o=1:o>e.nbPages&&(o=e.nbPages),e.page.currentPage=o-1,MyrDisplayPage(e,e.page.currentPage,MyrCtx.faux)}MyrToolbarLoseFocus(e,e.toolfocus),e.toolfocus=null,a=!1}t.updated=!1,MyrToolbarUpdate(e)}return a}function MyrToolbarInitTool(e,t,r){var o,a,i,n,s,l;if(s=t.screenwidth,l=t.screenheight,MyrIsDefined(s)||(s=1),MyrIsDefined(l)||(l=1),t.tag=r,MyrIsDefined(e.theme[r])||(r="unknown"),o=e.theme[r],n=/(^\d+) (.*$)/.exec(o),t.width100=i=parseFloat(n[1]),t.width=i+2*parseFloat(e.theme.hmargin),t.height=100+2*parseFloat(e.theme.vmargin),t.nextundermouse=t.undermouse=MyrCtx.faux,s>1){o=n[2],o=MyrReplaceSVGTokens(e,t.index,o),o="<g id='Myr-"+t.tag+"-"+e.index+"-"+t.index+"' fill='"+MyrCreateGradient(e.theme.inactivefill,MyrCtx.vrai)+"' stroke='"+MyrCreateGradient(e.theme.inactivestroke,MyrCtx.vrai)+"' stroke-width='"+e.theme.inactivestrokewidth+"' opacity='"+e.theme.inactiveopacity+"' style='transition:all "+e.theme.transition+";transform-origin: 50% 50%; transform:scale("+e.theme.inactivescale+","+e.theme.inactivescale+")'>"+o+"</g>",a="<g id='MyrOver-"+t.tag+"-"+e.index+"-"+t.index+"' opacity='"+e.theme.notoveropacity+"' fill='"+MyrCreateGradient(e.theme.notoverfill,MyrCtx.vrai)+"' stroke='"+MyrCreateGradient(e.theme.notoverstroke,MyrCtx.vrai)+"' transform='scale("+e.theme.notoverscale+","+e.theme.notoverscale+")' style='transition: all "+e.theme.overtransition+";transform-origin: 50% 50%; transform:scale("+e.theme.notoverscale+","+e.theme.notoverscale+")'>"+e.theme.over+"</g>",a=MyrReplaceSVGTokens(e,t.index,a),o=a+o;var d="<style>";d+=" @keyframes MyrPulse-"+e.index+" { 0% {fill:"+MyrCreateGradient(e.theme.pulsefill,MyrCtx.vrai)+";} 100% {fill:"+MyrCreateGradient(e.theme.fill,MyrCtx.vrai)+";}}",d+=" @-moz-keyframes MyrPulse-"+e.index+" { 0% {fill:"+MyrCreateGradient(e.theme.pulsefill,MyrCtx.vrai)+";} 100% {fill:"+MyrCreateGradient(e.theme.fill,MyrCtx.vrai)+";}}",d+=" </style>",o=d+o,o=MyrCtx.svgHeader+"width='"+s+"' height='"+l+"' viewBox='"+-parseFloat(e.theme.hmargin)+" "+-parseFloat(e.theme.vmargin)+" "+t.width+" "+t.height+"'>"+o+"</svg>",t.svg=o,MyrIsDefined(t.div)&&(t.div.innerHTML=t.svg)}}function MyrToolbarAddTool(e,t,r,o){var a;MyrIsDefined(o)||(o=1),e.toolbar.tool[r]=a={},e.toolbar.tool[r].index=r,e.toolbar.tool[r].gap=o,MyrToolbarInitTool(e,a,t)}function MyrToolSetActiveState(e,t,r,o){var a=document.getElementById("Myr-"+t),i=document.getElementById("MyrOver-"+t);a&&("inactive"==r?(a.style.animation="",a.style.transition="all "+e.theme.transition,a.style.fill=MyrCreateGradient(e.theme.inactivefill,MyrCtx.vrai),a.style.stroke=MyrCreateGradient(e.theme.inactivestroke,MyrCtx.vrai),a.style.strokeWidth=e.theme.inactivestrokewidth,a.style.opacity=e.theme.inactiveopacity,a.style.transform="scale("+e.theme.inactivescale+","+e.theme.inactivescale+")"):"hilited"==r?(a.style.animation="MyrPulse-"+e.index+" "+e.theme.pulsetransition+" infinite alternate",a.style.fill=e.theme.pulsefill,a.style.stroke=e.theme.stroke,a.style.strokeWidth=e.theme.strokewidth,a.style.opacity=e.theme.opacity,a.style.transform="scale("+e.theme.scale+","+e.theme.scale+")"):(a.style.animation="",a.style.transition="all "+e.theme.transition,a.style.fill=e.theme.fill,a.style.stroke=e.theme.stroke,a.style.strokeWidth=e.theme.strokewidth,a.style.opacity=e.theme.opacity,a.style.transform="scale("+e.theme.scale+","+e.theme.scale+")"),i&&(o&&"inactive"!=r?(i.style.fill=MyrCreateGradient(e.theme.overfill,MyrCtx.vrai),i.style.stroke=MyrCreateGradient(e.theme.overstroke,MyrCtx.vrai),i.style.strokeWidth=e.theme.overstrokewidth,i.style.opacity=e.theme.overopacity,i.style.transform="scale("+e.theme.overscale+","+e.theme.overscale+")"):(i.style.fill=MyrCreateGradient(e.theme.notoverfill,MyrCtx.vrai),i.style.stroke=MyrCreateGradient(e.theme.notoverstroke,MyrCtx.vrai),i.style.strokeWidth=e.theme.notoverstrokewidth,i.style.opacity=e.theme.notoveropacity,i.style.transform="scale("+e.theme.notoverscale+","+e.theme.notoverscale+")")))}function MyrToolbarDrawTool(e,t,r,o,a){var i=document.getElementById("Myr-"+t.tag+"-"+e.index+"-"+t.index);if(MyrInstanceHasOpenMenu()&&(o=MyrCtx.faux),i&&(t.updated==MyrCtx.faux||r!=t.state||o!=t.undermouse||a!=t.pos)){if(MyrToolSetActiveState(e,t.tag+"-"+e.index+"-"+t.index,r,o),t.pos!=a){var n=document.getElementById("MyrThumb-"+e.index+"-"+t.index);n&&n.setAttribute("transform","translate("+a*t.width100+")");var s=document.getElementById("MyrText-"+e.index+"-"+t.index);s&&(s.textContent?s.textContent=a:s.innerText=a),t.pos=a}t.state=r,t.undermouse=o,t.updated=MyrCtx.vrai}}function MyrToolbarIsToolActive(e,t){var r;if(!e.isLoaded||!MyrIsDefined(e.page))return MyrCtx.faux;switch(r=MyrIsDefined(e.sound.track)&&e.sound.track.length>0||MyrIsDefined(e.sync.metronome)&&e.sync.metronome.active,t){case"view":return MyrCtx.vrai;case"pgfield":case"pgpop":return e.sound.playState!=MyrCtx.STATE_STOPPED?MyrCtx.faux:e.nbPages>1?MyrCtx.vrai:MyrCtx.faux;case"pgp":case"pgpr":return e.sound.playState!=MyrCtx.STATE_STOPPED?MyrCtx.faux:e.page.currentPage<e.nbPages-1?MyrCtx.vrai:MyrCtx.faux;case"pgm":case"pgmr":return e.sound.playState!=MyrCtx.STATE_STOPPED?MyrCtx.faux:e.page.currentPage>0?MyrCtx.vrai:MyrCtx.faux;case"zoompop":case"zoomfield":return MyrCtx.vrai;case"zoomp":case"zoompr":return 100*e.page.zoom<MyrCtx.zoomtab[MyrCtx.zoomtab.length-1]-5?MyrCtx.vrai:MyrCtx.faux;case"zoomm":case"zoommr":return 100*e.page.zoom>MyrCtx.zoomtab[0]+5?MyrCtx.vrai:MyrCtx.faux;case"measures":return MyrCtx.vrai;case"volume":return r;case"play":return MyrAreAllTracksReady(e)?e.sound.playState==MyrCtx.STATE_PLAYING?2:r:MyrCtx.faux;case"pause":return MyrAreAllTracksReady(e)?e.sound.playState==MyrCtx.STATE_PAUSED?2:r:MyrCtx.faux;case"stop":return MyrAreAllTracksReady(e)?e.sound.playState==MyrCtx.STATE_STOPPED?MyrCtx.faux:r:MyrCtx.faux;case"rewind":case"fastfw":return MyrAreAllTracksReady(e)?r:MyrCtx.faux;case"mixer":return MyrAreAllTracksReady(e)?MyrCtx.vrai:MyrCtx.faux;case"view":return MyrCtx.vrai;case"download":return MyrCtx.vrai;case"print":return MyrCtx.vrai;case"metronome":return MyrIsDefined(e.sync.metronome)&&e.sync.metronome.active?2:MyrAreAllTracksReady(e)?MyrCtx.vrai:MyrCtx.faux;case"detune":return MyrAreAllTracksReady(e)?MyrCtx.vrai:MyrCtx.faux;case"info":return MyrCtx.vrai;case"fileinfo":return MyrCtx.vrai;default:return MyrCtx.faux}}function MyrToolbarGetToolList(e){var t,r="";for(t=0;t<e.length;t++)r+=e[t].toolname+"="+e[t].toolparam+"/";return r}function MyrToolbarChange(e,t){var r,o=e.toolbar.toollist,a=MyrToolsetCreateList(e,t);if(e.toolbar.toollist=MyrToolbarGetToolList(a),!MyrIsDefined(o)||o!=e.toolbar.toollist){if(MyrIsDefined(e.toolbar.tool)){for(r=0;r<e.toolbar.tool.length;r++)e.toolbar.div.removeChild(e.toolbar.tool[r].div),e.toolbar.tool[r].div=null;e.toolbar.tool=null}e.toolbar.tool=[];var i=0;for(r=0;r<a.length;r++)"page"==a[r].toolname?"complete"==a[r].toolparam?(MyrToolbarAddTool(e,"pgmr",i++,0),MyrToolbarAddTool(e,"pgfield",i++,0),MyrToolbarAddTool(e,"pgpr",i++)):"reduced"==a[r].toolparam?MyrToolbarAddTool(e,"pgpop",i++):(MyrToolbarAddTool(e,"pgm",i++),MyrToolbarAddTool(e,"pgp",i++)):"volume"==a[r].toolname?MyrToolbarAddTool(e,"volume",i++):"zoom"==a[r].toolname?"complete"==a[r].toolparam?(MyrToolbarAddTool(e,"zoommr",i++,0),MyrToolbarAddTool(e,"zoomfield",i++,0),MyrToolbarAddTool(e,"zoompr",i++)):"reduced"==a[r].toolparam?MyrToolbarAddTool(e,"zoompop",i++):(MyrToolbarAddTool(e,"zoomm",i++),MyrToolbarAddTool(e,"zoomp",i++)):"detune"==a[r].toolname?MyrIsDefined(e.sound.useAudioFailSafe)&&e.sound.useAudioFailSafe!=MyrCtx.faux||MyrToolbarAddTool(e,a[r].toolname,i++):"metronome"==a[r].toolname?MyrToolbarAddTool(e,a[r].toolname,i++):"rewind"==a[r].toolname||"fastfw"==a[r].toolname?e.sound.canJump&&MyrToolbarAddTool(e,a[r].toolname,i++):MyrToolbarAddTool(e,a[r].toolname,i++);var n,s=0;for(j=0;j<e.toolbar.tool.length;j++)s+=e.toolbar.tool[j].width100;0===s||e.minimal?n=e.toolbar.div.height:(n=100*e.width/s,n>e.toolbar.div.height&&(n=e.toolbar.div.height));var l=0,d=0;for(j=0;j<e.toolbar.tool.length;j++)e.toolbar.tool[j].screenheight=n,e.toolbar.tool[j].screenwidth=n*e.toolbar.tool[j].width/e.toolbar.tool[j].height,l+=e.toolbar.tool[j].screenwidth,d+=e.toolbar.tool[j].gap;e.minimal&&(e.width=l,e.unclippedFather.style.width=e.fatherDiv.style.width=e.toolbar.div.style.width=l+"px");var y=(e.width-l)/(d+1),c=(e.toolbar.div.height-n)/2;y>n&&(y=n);var u=y;for(j=0;j<e.toolbar.tool.length;j++)e.toolbar.tool[j].screenleft=u,e.toolbar.tool[j].screenright=u+e.toolbar.tool[j].screenwidth,e.toolbar.tool[j].screentop=c,u+=e.toolbar.tool[j].screenwidth,e.toolbar.tool[j].div=MyrCreateUndraggableElement("div",130),e.toolbar.tool[j].div.style.position="absolute",MyrSetDivPos(e.toolbar.tool[j].div,e.toolbar.tool[j].screenleft,e.toolbar.tool[j].screentop),MyrSetDivSize(e.toolbar.tool[j].div,e.toolbar.tool[j].screenwidth,e.toolbar.tool[j].screenheight),e.toolbar.div.appendChild(e.toolbar.tool[j].div),MyrToolbarInitTool(e,e.toolbar.tool[j],e.toolbar.tool[j].tag),u+=e.toolbar.tool[j].gap*y}MyrToolbarUpdate(e,MyrCtx.vrai)}function MyrToolbarUpdate(e,t){if(MyrIsDefined(e)&&MyrIsDefined(e.toolbar)&&MyrIsDefined(e.toolbar.tool))for(var r=0;r<e.toolbar.tool.length;r++){var o,a,i=e.toolbar.tool[r];o=MyrToolbarIsToolActive(e,i.tag),o=o==MyrCtx.faux?"inactive":o==MyrCtx.vrai?"active":"hilited","volume"==i.tag?a=MyrIsDefined(e.sound.generalVolume)?e.sound.generalVolume:.8:"pgfield"==i.tag&&(a=MyrIsDefined(e.page)&&MyrIsDefined(e.page.currentPage)?e.page.currentPage+1:1),MyrIsDefined(i.edittext)&&(a=i.edittext+"|"),i.state==o&&i.pos==a&&i.nextundermouse==i.undermouse&&i.updated&&t!=MyrCtx.vrai||(t&&(i.updated=MyrCtx.faux),MyrToolbarDrawTool(e,i,o,i.nextundermouse,a))}}function MyrIsToolPresent(e,t){for(var r=0;r<e.toolbar.tool.length;r++)if(e.toolbar.tool[r].tag==t)return MyrCtx.vrai;return MyrCtx.faux}function MyrToolbarClickTool(e,t){var r,o,a,i,n,s=e.toolbar.tool[t];if(n=e.toolfocus,"inactive"!=s.state)if("pgm"==s.tag||"pgmr"==s.tag)i=e.page.currentPage-1,0>i&&(i=0),MyrDisplayPage(e,i,MyrCtx.faux);else if("pgp"==s.tag||"pgpr"==s.tag)i=e.page.currentPage+1,i>e.nbPages-1&&(i=e.nbPages-1),MyrDisplayPage(e,i,MyrCtx.faux);else if("volume"==s.tag){var l=(s.width-s.width100)/2;l=s.screenwidth-s.screenwidth*(s.width100/s.width),o=(e.mouse.x-s.screenleft-l)/(s.screenwidth-2*l),0>o?o=0:o>1&&(o=1),MyrAction(e,"action_volume "+o),s.updated=MyrCtx.faux}else if("zoompop"==s.tag||"zoomfield"==s.tag||2==MyrCtx.button&&("zoomp"==s.tag||"zoompr"==s.tag||"zoomm"==s.tag||"zoommr"==s.tag))a=MyrIsDefined(e.page.zoom)?e.page.zoom:1,MyrMenuClear(e,0),MyrAddMenuItemsZoom(e),MyrPopup(e);else if("zoomp"==s.tag||"zoompr"==s.tag){for(a=MyrIsDefined(e.page.zoom)?e.page.zoom:1,r=0;r<MyrCtx.zoomtab.length&&100*e.page.zoom>MyrCtx.zoomtab[r]+5;r++);r<MyrCtx.zoomtab.length-1&&MyrAction(e,"action_zoom "+MyrCtx.zoomtab[r+1])}else if("zoomm"==s.tag||"zoommr"==s.tag){for(a=MyrIsDefined(e.page.zoom)?e.page.zoom:1,r=0;r<MyrCtx.zoomtab.length&&100*e.page.zoom>MyrCtx.zoomtab[r]+5;r++);r>0&&MyrAction(e,"action_zoom "+MyrCtx.zoomtab[r-1])}else"mixer"==s.tag?MyrMixTable(e):"play"==s.tag?MyrAction(e,"action_playstate "+MyrCtx.STATE_PLAYING):"pause"==s.tag?MyrAction(e,"action_playstate "+MyrCtx.STATE_PAUSED):"stop"==s.tag?MyrAction(e,"action_playstate "+MyrCtx.STATE_STOPPED):"fastfw"==s.tag?MyrAction(e,"action_playrelpos 1"):"rewind"==s.tag?MyrAction(e,"action_playrelpos -1"):"view"==s.tag?(MyrMenuClear(e,0),MyrAddMenuItemsPart(e),MyrAddMenuItemsLyrics(e),MyrPopup(e)):"metronome"==s.tag?(MyrMenuClear(e,0),MyrAddMenuItemsMetronome(e),MyrAddMenuItemsTempo(e),MyrPopup(e)):"detune"==s.tag?(MyrMenuClear(e,0),MyrAddMenuItemsDetune(e),MyrPopup(e)):"download"==s.tag?(MyrMenuClear(e,0),MyrAddMenuItemsDownload(e,MyrIsToolPresent(e,"print")),MyrPopup(e)):"print"==s.tag?MyrAction(e,"action_print"):"pgfield"==s.tag?e.toolfocus=s:"info"==s.tag?MyrAction(e,"action_info"):"fileinfo"==s.tag&&MyrAction(e,"action_fileinfo");e.focus&&(n!=e.toolfocus&&MyrToolbarLoseFocus(e,n),null!==e.toolfocus&&e.focus&&MyrToolbarGainFocus(e,e.toolfocus)),MyrToolbarUpdate(e)}function MyrMenuNew(e,t){MyrIsDefined(e.menu)||(e.menu={},e.menu.opened=-1),MyrIsDefined(e.menu.list)||(e.menu.list=[]);var r={};return r.tag=t,r.item=[],r.height=0,r.width=0,e.menu.list.push(r),e.menu.list.length-1}function MyrMenuAddItem(e,t,r,o,a,i){var n=e.menu.list[t];MyrIsDefined(n.item)||(n.item=[]);var s={};return s.value=o,MyrIsDefined(a)?s.tag=a:s.tag=0,MyrIsDefined(i)?s.enabled=i:s.enabled=MyrCtx.vrai,"-"==o.charAt(0)?(s.separator=MyrCtx.vrai,s.enabled=MyrCtx.faux,s.value=o.substr(1)):s.separator=MyrCtx.faux,s.mark=r,n.item.push(s),n.item.length-1}function MyrMenuClear(e,t){if(MyrIsDefined(e.menu)&&e.menu.lastopened>=0){for(var r=e.menu.list[e.menu.lastopened],o=0;o<r.item.length;o++)r.item[o].div&&e.menu.div.removeChild(r.item[o].div),r.item[o].div=null;e.menu.fatherDiv=null,e.menu.lastopened=-1}if(t>=0&&MyrIsDefined(e.menu)&&MyrIsDefined(e.menu.list)&&t<e.menu.list.length){var a=e.menu.list[t];a.item=[]}}function MyrMenuDelete(e,t){e.menulist[t]=null,e.menulist.splice(t,1)}function MyrMenuManage(e,t,r){var o;if(t.menu.opened>=0){if(r>=0)return o=t.menu.list[t.menu.opened].item[r],"over"==e&&o.enabled?(""!==t.menu.theme.menufontidle&&MyrMenuItemSetFontStyle(o,t.menu.theme,MyrCtx.vrai),MyrCompleteStyle(o.div,t.menu.theme.menuitemover),t.menu.lastoveritem=r):"out"==e&&(""!==t.menu.theme.menufontidle&&MyrMenuItemSetFontStyle(o,t.menu.theme,MyrCtx.faux),
MyrCompleteStyle(o.div,t.menu.theme.menuitemidle),t.menu.lastoveritem=-1),"click"==e&&(""!==t.menu.theme.menufontidle&&MyrMenuItemSetFontStyle(o,t.menu.theme,MyrCtx.faux),MyrCompleteStyle(o.div,t.menu.theme.menuitemidle),t.menu.processclick(t,t.menu.tag,o.tag),MyrMenuClose(t),t.menu.lastoveritem=-1),MyrCtx.vrai;if("click"==e)return t.menu.lastoveritem>=0&&t.menu.processclick(t,t.menu.tag,t.menu.list[t.menu.opened].item[t.menu.lastoveritem].tag),MyrMenuClose(t),t.menu.lastoveritem=-1,MyrCtx.vrai}return MyrCtx.faux}function MyrMenuItemSetFontStyle(e,t,r){var o="font-family:"+t.menufontfamily+";font-size:"+t.menufontsize+"px;font-weight:"+t.menufontweight+";";o+=e.enabled?r?t.menufontover:t.menufontidle:t.menufontdisabled;var a=e.div.getElementsByTagName("span");MyrIsDefined(a[0])&&MyrCompleteStyle(a[0],o)}function MyrMenuItemSetContent(e,t,r,o){var a="";t.mark>0&&(a=r["menumark"+t.mark],t.enabled||(a="<g opacity=0.3>"+a+"</g>")),MyrIsDefined(a)||(a=""),a="<svg width='"+r.menumarksize+"' height='"+r.menumarksize+"' viewBox='0 0 100 100'>"+a+"</svg>";var i="font-family:"+r.menufontfamily+";font-size:"+r.menufontsize+"px;font-weight:"+r.menufontweight+";";if(i+=t.enabled?o?r.menufontover:r.menufontidle:r.menufontdisabled,t.separator){var n="",s=(e.menu.maxitemwidth-t.width)/2;console.log("line "+s),s>0&&(n="<svg width='"+s+"' height='"+r.menumarksize+"' viewBox='0 0 "+s+" "+r.menumarksize+"'><path d='M 0 "+r.menumarksize/2+" l "+s+" 0' "+r.menuseparator+"/></svg>"),t.div.innerHTML="<center><table cellpadding='0' cellspacing='0'><tr><td width='"+s+"'>"+n+"</td><td style='white-space: nowrap;"+i+"' > "+t.value+" </td><td width='"+s+"'>"+n+"</td></td></tr></table></center>"}else t.div.innerHTML="<table cellpadding='0' cellspacing='0'><tr><td><span style='white-space: nowrap;"+i+"'><img width='"+r.menumarksize+"'>"+a+"</img> "+t.value+"</span></td></tr></table>"}function MyrMenuItemSetMark(e,t,r,o){e.menu.list[t].item[r].mark=o}function MyrMenuItemSetMark(e,t,r,o){e.menu.list[t].item[r].enabled=o}function MyrMenuGetMenuIndexByTag(e,t){if(!MyrIsDefined(e.menu)||!MyrIsDefined(e.menu.list))return-1;for(var r=0;r<e.menu.list.length;r++)if(e.menu.list[r].tag==t)return r;return-1}function MyrMenuGetItemIndexByTag(e,t,r){for(var o=0;o<e.menu.list[t].item.length;o++)if(e.menu.list[t].item[o].tag==r)return o;return-1}function MyrMenuGetPaneSize(e,t,r){var o,a=document.createElement("div");a.setAttribute("unselectable","on"),a.setAttribute("draggable","false"),a.style="",MyrCompleteStyle(a,"position:absolute;width:auto;height:auto;visibility:hidden;"),MyrCompleteStyle(a,t.menupane);var i="<svg width='"+t.menumarksize+"' height='"+t.menumarksize+"' viewBox='0 0 100 100'><circle cx='50' cy='50' r='40' fill='#0000FF'/></svg>",n="font-family:"+t.menufontfamily+";font-size:"+t.menufontsize+"px;font-weight:"+t.menufontweight+";",s=[];for(o=0;o<r.item.length;o++)s[o]=document.createElement("div"),s[o].innerHTML="<table cellpadding='0' cellspacing='0'><tr><td><span style='white-space: nowrap;"+n+"'><img width='"+t.menumarksize+"'>"+i+"</img> "+r.item[o].value+"</span></td></tr></table>",MyrCompleteStyle(s[o],"position:static;width:auto;height:auto;background-color:#FF0000"),MyrCompleteStyle(s[o],t.menuitem),MyrCompleteStyle(s[o],t.menuitemidle),a.appendChild(s[o]);document.body.appendChild(a),e.menu.width=a.clientWidth,e.menu.height=a.clientHeight;var l=0;for(o=0;o<r.item.length;o++){var d=s[o].getElementsByTagName("table")[0].clientWidth;r.item[o].width=d,d>l&&(l=d);var y=s[o].getBoundingClientRect();r.item[o].height=y.bottom-y.top,r.item[o].top=y.top}e.menu.maxitemwidth=l,a.parentNode.removeChild(a)}function MyrMenuOpen(e,t,r,o,a,i,n,s){var l=e.menu.list[t];MyrMenuGetPaneSize(e,i,l),o-=e.menu.width/2,o+e.menu.width>r.clientWidth&&(o=r.clientWidth-e.menu.width),0>o&&(o=0),a-=e.menu.height/2,a+e.menu.height>r.clientHeight&&(a=r.clientHeight-e.menu.height),0>a&&(a=0),MyrIsDefined(s)||(s=MyrMenuManage),e.menu.theme=i,MyrIsDefined(e.menu.div)||(e.menu.div=document.createElement("div"),e.menu.div.setAttribute("unselectable","on"),e.menu.div.setAttribute("draggable","false"),MyrCompleteStyle(e.menu.div,"z-index:2000;position:absolute;width:auto;height:auto"),MyrCompleteStyle(e.menu.div,i.menupane),MyrSetDivBackground(e.menu.div,i.menupanebgcolor),MyrCompleteStyle(e.menu.div,i.menupaneclose),r.appendChild(e.menu.div),window.getComputedStyle(e.menu.div).transform),e.menu.processclick=n,e.menu.managemouseevt=s,MyrCompleteStyle(e.menu.div,"left:"+o+"px;top:"+a+"px;"),MyrMenuClear(e,-1);for(var d=0;d<l.item.length;d++)l.item[d].div=document.createElement("div"),MyrCompleteStyle(l.item[d].div,"position:static;width:auto;height:auto"),MyrCompleteStyle(l.item[d].div,i.menuitem),MyrCompleteStyle(l.item[d].div,i.menuitemidle),MyrMenuItemSetContent(e,l.item[d],i,MyrCtx.faux),l.item[d].div.onmouseover=MyrCallback(s,"over",e,d),l.item[d].div.onmouseout=MyrCallback(s,"out",e,d),l.item[d].div.onclick=MyrCallback(s,"click",e,d),e.menu.div.appendChild(l.item[d].div);e.menu.opened=e.menu.lastopened=t,e.menu.fatherdiv=r,MyrCompleteStyle(e.menu.div,i.menupaneopen)}function MyrMenuClose(e){e.menu.opened>=0&&(MyrCompleteStyle(e.menu.div,e.menu.theme.menupaneclose),e.menu.opened=-1)}function MyrAddMenuItemsDetune(e){var t="<path d='M 20 10 L 20 100 M 40 0 L 40 90'/><path d='M 0 37 L 60 25 M 0 73 L 60 61' stroke-width='20'/>",r="<path d='M 20 10 L 20 100 C 60 50 60 40 20 60' />",o="<path d='M 20 10 L 20 70 L 40 60 M 40 100 L 40 30 L 20 40' />",a=20,i=.7*a;t="<svg width='"+i+"' height='"+a+"' viewBox='0 0 70 100'><g stroke='#404040' stroke-width='10' fill='none'>"+t+"</g></svg>",r="<svg width='"+i+"' height='"+a+"' viewBox='0 0 70 100'><g stroke='#404040' stroke-width='10' fill='none'>"+r+"</g></svg>",o="<svg width='"+i+"' height='"+a+"' viewBox='0 0 70 100'><g stroke='#404040' stroke-width='10' fill='none'>"+o+"</g></svg>",MyrMenuAddItem(e,0,0,"-Detune",""),MyrMenuAddItem(e,0,5==e.sound.playMode.detune?1:0,t+t+t+t+t,"action_detune 5"),MyrMenuAddItem(e,0,4==e.sound.playMode.detune?1:0,t+t+t+t,"action_detune 4"),MyrMenuAddItem(e,0,3==e.sound.playMode.detune?1:0,t+t+t,"action_detune 3"),MyrMenuAddItem(e,0,2==e.sound.playMode.detune?1:0,t+t,"action_detune 2"),MyrMenuAddItem(e,0,1==e.sound.playMode.detune?1:0,t,"action_detune 1"),MyrMenuAddItem(e,0,0===e.sound.playMode.detune?1:0,o,"action_detune 0"),MyrMenuAddItem(e,0,-1==e.sound.playMode.detune?1:0,r,"action_detune -1"),MyrMenuAddItem(e,0,-2==e.sound.playMode.detune?1:0,r+r,"action_detune -2"),MyrMenuAddItem(e,0,-3==e.sound.playMode.detune?1:0,r+r+r,"action_detune -3"),MyrMenuAddItem(e,0,-4==e.sound.playMode.detune?1:0,r+r+r+r,"action_detune -4"),MyrMenuAddItem(e,0,-5==e.sound.playMode.detune?1:0,r+r+r+r+r,"action_detune -5")}function MyrAddMenuItemsMetronome(e){!e.sound.useAudioFailSafe&&MyrIsDefined(e.sync)&&MyrIsDefined(e.sync.metronome)&&(MyrMenuAddItem(e,0,0,"-"+MyrThemeGetRawIcon(e,e.theme.metronome,25,25,2,2,2,2,.3,3,"#000000","none"),""),MyrMenuAddItem(e,0,e.sound.playMode.metronome.before?1:0,MyrThemeGetRawIcon(e,e.theme.tickbefore,60,20,5,7,5,2,1,2,"#606060","#A06090"),"action_metronomebefore"),MyrMenuAddItem(e,0,e.sound.playMode.metronome.bar?1:0,MyrThemeGetRawIcon(e,e.theme.tickbar,60,20,5,7,5,2,1,2,"#606060","#A06090"),"action_metronomebar"),MyrMenuAddItem(e,0,e.sound.playMode.metronome.beat?1:0,MyrThemeGetRawIcon(e,e.theme.tickbeat,60,20,5,7,5,2,1,2,"#606060","#A06090"),"action_metronomebeat"))}function MyrAddMenuItemsTempo(e){var t=MyrThemeGetRawIcon(e,e.theme.slow,25,15,0,0,4,0,.4),r=MyrThemeGetRawIcon(e,e.theme.fast,20,19,0,0,4,0,.4);MyrMenuAddItem(e,0,0,"- "+t+r+" ",""),t=MyrThemeGetRawIcon(e,e.theme.slow,25,15,0,0,4,0,1),r=MyrThemeGetRawIcon(e,e.theme.fast,20,19,0,0,4,0,1),MyrMenuAddItem(e,0,.75==e.sound.playMode.tempo?1:0,"50% &nbsp;"+t+t+t+t,"action_tempo 0.5"),MyrMenuAddItem(e,0,.75==e.sound.playMode.tempo?1:0,"70% &nbsp;"+t+t+t,"action_tempo 0.70"),MyrMenuAddItem(e,0,.8==e.sound.playMode.tempo?1:0,"85% &nbsp;"+t+t,"action_tempo 0.80"),MyrMenuAddItem(e,0,.95==e.sound.playMode.tempo?1:0,"95% &nbsp;"+t,"action_tempo 0.95"),MyrMenuAddItem(e,0,1==e.sound.playMode.tempo?1:0,"100% &nbsp;","action_tempo 1.00"),MyrMenuAddItem(e,0,1.05==e.sound.playMode.tempo?1:0,"105% &nbsp;"+r,"action_tempo 1.05"),MyrMenuAddItem(e,0,1.15==e.sound.playMode.tempo?1:0,"115% &nbsp;"+r+r,"action_tempo 1.15"),MyrMenuAddItem(e,0,1.25==e.sound.playMode.tempo?1:0,"125% &nbsp;"+r+r+r,"action_tempo 1.25"),MyrMenuAddItem(e,0,1.25==e.sound.playMode.tempo?1:0,"150% &nbsp;"+r+r+r+r,"action_tempo 1.5")}function MyrAddMenuItemsTracks(e){for(var t=0;t<e.sound.track.length;t++)MyrMenuAddItem(e,0,e.sound.track[t].volume>0?1:0,t+1+". "+e.sound.track[t].name,"action_mixer "+t+" volume "+(e.sound.track[t].volume>0?0:1))}function MyrAddMenuItemsDownload(e,t){MyrMenuAddItem(e,0,0,"-"+MyrThemeGetRawIcon(e,e.theme.download,25,25,2,2,2,2,.3,3,"#000000","none"),"");for(var r=0;r<e.file.length;r++)MyrMenuAddItem(e,0,0,e.file[r].name+" ("+Math.floor(e.file[r].data.length/1024)+"k)","action_download "+r)}function MyrAddMenuItemsPart(e){var t;if(e.page.view.length>0){var r=MyrThemeGetRawIcon(e,e.theme.overlay,15,21,2,2,2,2,.4,2,"#404040","#808080");MyrMenuAddItem(e,0,0,"-"+r,"");var o=MyrThemeGetRawIcon(e,e.theme.barnum,35,18,2,2,2,2,1,2,"#808080","none");if(MyrMenuAddItem(e,0,e.page.displaybars?1:0,o,"action_displaybars "+(e.page.displaybars^MyrCtx.vrai),"view"==e.page.viewType),e.page.view.length+e.page.lyrics.length>1){var a=MyrThemeGetRawIcon(e,e.theme.note,8,16,0,2,0,2,.4,2,"none","#000000");for(MyrMenuAddItem(e,0,0,"-"+a+a+a,""),t=0;t<e.page.view.length;t++)MyrMenuAddItem(e,0,"view"==e.page.viewType&&e.page.viewIndex==t?1:0,e.page.view[t].name,"action_viewpart "+t)}return MyrCtx.vrai}return MyrCtx.faux}function MyrAddMenuItemsLyrics(e){var t;if(e.page.lyrics.length>0){if(e.page.view.length+e.page.lyrics.length>1){var r=MyrThemeGetRawIcon(e,e.theme.txt,20,15,2,2,2,2,.4,1,"#000000","none");for(MyrMenuAddItem(e,0,0,"-"+r,""),t=0;t<e.page.lyrics.length;t++)MyrMenuAddItem(e,0,"lyrics"==e.page.viewType&&e.page.viewIndex==t?1:0,e.page.lyrics[t].name,"action_viewlyrics "+t)}return MyrCtx.vrai}return MyrCtx.faux}function MyrAddMenuItemsZoom(e){var t;for(t=0;t<MyrCtx.zoomtab.length&&100*e.page.zoom>MyrCtx.zoomtab[t]+5;t++);MyrMenuAddItem(e,0,0,"-"+MyrThemeGetRawIcon(e,e.theme.magnifier,20,20,4,4,4,4,.3,3,"#000000","none"));for(var r=0;r<MyrCtx.zoomtab.length;r++)MyrMenuAddItem(e,0,r==t?1:0,MyrCtx.zoomtab[r]+"%","action_zoom "+MyrCtx.zoomtab[r])}function MyrAddMenuItemsKbd(e){var t,r,o;for(MyrMenuAddItem(e,0,0,"-Octave"),t=-4;4>t;t++)MyrMenuAddItem(e,0,t===e.keyboard.octaveshift?1:0,(t>0?" +":" ")+t.toString(),"action_kbd_octave "+t);for(MyrMenuAddItem(e,0,0,"-Staves"),t=0;t<e.sync.staff.length;t++)MyrBool(e.args.keyboardusenotecolor)==MyrCtx.vrai?o="":(r=MyrKbdGetStaffColor(e,t),o="<svg width='"+e.theme.menumarksize+"' height='"+e.theme.menumarksize+"' viewBox='0 0 100 100'><circle cx='50' cy='50' r='50' stroke='none' fill='"+r+"'></svg>"),MyrMenuAddItem(e,0,e.sync.staff[t].onKbd?1:0,e.sync.staff[t].name+" "+o,"action_kbd_viewstaff "+t)}function MyrPopup(e){MyrMenuOpen(e,0,e.unclippedFather,e.mouse.x,e.mouse.y,e.theme,MyrMenuClickProcess)}function MyrMenuClickProcess(e,t,r){MyrAction(e,r)}function MyrDlogNew(e,t,r,o,a,i){if(MyrIsDefined(a)||(a=0),MyrIsDefined(i)||(i=0),MyrIsDefined(e.dlog)||(e.dlog={}),MyrIsDefined(e.dlog.list)||(e.dlog.list=[]),MyrDlogGetDlogIndexByTag(e,t)>=0)return-1;var n={};return n.tag=t,n.item=[],n.minheight=i,n.minwidth=a,e.dlog.list.splice(0,0,n),MyrDlogAddItem(e,0,"title",r,"boxtitle",0,null,"left middle",0,0),o&&MyrDlogAddTool(e,0,e.theme.dlogclosebox,20,20,0,0,"boxclose",MyrDlogCloseBoxManage,"right middle",0,0),0}function MyrDlogAddItem(e,t,r,o,a,i,n,s,l,d){var y=e.dlog.list[t];MyrIsDefined(y.item)||(y.item=[]);var c={};return MyrIsDefined(r)?c.style=r:c.style="none",MyrIsDefined(o)?c.caption=o:c.caption="",MyrIsDefined(i)?c.value=i:c.value=0,MyrIsDefined(a)?c.tag=a:c.tag="undef",MyrIsDefined(n)?c.vectprocess=n:c.vectprocess=null,MyrIsDefined(s)?c.position=s:c.position="",MyrIsDefined(l)?c.offsetx=l:c.offsetx=0,MyrIsDefined(d)?c.offsety=d:c.offsety=0,y.item.push(c),y.item.length-1}function MyrDlogClear(e,t){if(MyrIsDefined(e.dlog)&&MyrIsDefined(e.dlog.list)&&MyrIsDefined(e.dlog.list[o])){for(var r=e.dlog.list[t],o=0;o<r.item.length;o++)r.item[o].div&&e.dlog.div.removeChild(r.item[o].div),r.item[o].div=null;r.box=null,r.item=[]}}function MyrDlogDelete(e,t){e.dlog.list[t]=null,e.dlog.list.splice(t,1)}function MyrDlogGetDlogIndexByTag(e,t){if(!MyrIsDefined(e.dlog)||!MyrIsDefined(e.dlog.list))return-1;for(var r=0;r<e.dlog.list.length;r++)if(e.dlog.list[r].tag==t)return r;return-1}function MyrDlogGetItemIndexByTag(e,t,r){for(var o=0;o<e.dlog.list[t].item.length;o++)if(e.dlog.list[t].item[o].tag==r)return o;return-1}function MyrDlogSetItemValue(e,t,r,o){var a=MyrDlogGetDlogIndexByTag(e,t),i=MyrDlogGetItemIndexByTag(e,a,r),n=e.dlog.list[a].item[i];if("progress"==n.style){var s=n.div.children[0],l=n.div.clientWidth;s.style.width=parseInt(l*o/100)+"px"}else n.div.innerHTML=o}function MyrDlogOpen(e,t,r,o,a,i,n){var s,l=e.dlog.list[t],d={};MyrIsDefined(l.div)||(l.div=document.createElement("div"),l.div.setAttribute("unselectable","on"),l.div.setAttribute("draggable","false"),MyrCompleteStyle(l.div,"visibility:hidden;z-index:2000;position:absolute;left:0px;top:0;width:"+r.clientWidth+"px;height:"+r.clientHeight+"px"),MyrCompleteStyle(l.div,n.dialogbox),MyrSetDivBackground(l.div,n.dialogboxbgcolor),r.appendChild(l.div),window.getComputedStyle(l.div).transform);var y={};y.y=y.lineheight=y.leftx=y.centerx=y.rightx=y.titleheight=y.line=0,MyrDlogClear(e,-1);for(var c=0;c<l.item.length;c++){s=l.item[c];var u;if(u=l.div,s.div=document.createElement("div"),s.div.setAttribute("unselectable","on"),s.div.setAttribute("draggable","false"),MyrCompleteStyle(s.div,"z-index:2002;position:absolute;width:auto;height:auto;"),"progress"==s.style){MyrCompleteStyle(s.div,"display:inline-block;backgroundColor:white;border: 1px solid black;border-radius: 7px;width:"+Math.max(l.minwidth,30)+"px;height:20px;box-shadow: 0px 2px 3px rgba(0,0,0,0.3) inset;");var f=document.createElement("div");f.setAttribute("unselectable","on"),f.setAttribute("draggable","false"),MyrCompleteStyle(f,"display: inline-block;backgroundColor:#6666FF;z-index:2003;border-radius: 7px;position:absolute;left:0px;top:0px;width:0px;height:20px;box-shadow: -1px -5px 5px rgba(0,0,0,0.3) inset;"),s.div.appendChild(f)}else s.div.innerHTML=s.caption;"title"==s.style?MyrCompleteStyle(s.div,n.titletextstyle):"static"==s.style?MyrCompleteStyle(s.div,n.statictextstyle):"button"==s.style?MyrCompleteStyle(s.div,n.buttonstyle):"none"!=s.style&&(MyrCompleteStyle(s.div,n.statictextstyle),MyrCompleteStyle(s.div,s.style)),s.size={},"boxtitle"==s.tag||"boxclose"==s.tag?(MyrIsDefined(l.titlediv)||(l.titlediv=document.createElement("div"),l.titlediv.setAttribute("unselectable","on"),l.titlediv.setAttribute("draggable","false"),MyrCompleteStyle(l.titlediv,"z-index:2001;position:absolute;width:100%;height:auto;left:0px;top:0px"),MyrCompleteStyle(l.titlediv,n.dialogtitle),MyrSetDivBackground(l.titlediv,n.dialogtitlebgcolor),l.div.appendChild(l.titlediv)),l.titlediv.appendChild(s.div),s.size.width=s.div.clientWidth+4,s.size.height=s.div.clientHeight,s.size.height>y.titleheight&&(y.titleheight=s.size.height)):(l.div.appendChild(s.div),s.size.width=s.div.clientWidth+4,s.size.height=s.div.clientHeight),s.position.indexOf("newline")>=0&&(y.y+=y.lineheight,y.line++,y.leftx=y.centerx=y.rightx=y.lineheight=0),s.y=y.y+s.offsety,s.position.indexOf("center")>=0?(s.x=y.centerx,y.centerx+=s.size.width+s.offsetx):s.position.indexOf("right")>=0?(s.x=y.rightx,y.rightx+=s.size.width+s.offsetx):(s.x=y.leftx,y.leftx+=s.size.width+s.offsetx),s.size.height+s.offsety>y.lineheight&&(y.lineheight=s.size.height+s.offsety),MyrIsDefined(d[y.line])||(d[y.line]={}),d[y.line].height=y.lineheight,d[y.line].left=y.leftx,d[y.line].right=y.rightx,d[y.line].center=y.centerx,s.line=y.line}y.y+=y.lineheight+4;var m,M,p;for(m=M=p=0,c=0;c<=y.line;c++){var g;d[c].center?(g=2*Math.max(d[c].left,d[c].right),g>M&&(M=g),d[c].center>m&&(m=d[c].center)):(g=d[c].left+d[c].right,g>p&&(p=g))}var h;for(h=Math.max(m+M,p),h<l.minwidth&&(h=l.minwidth),l.box={},l.position=o,o.indexOf("persistent")>=0&&MyrIsDefined(e.dlog.pos)&&MyrIsDefined(e.dlog.pos[l.tag])?(l.box.left=e.dlog.pos[l.tag].left,l.box.top=e.dlog.pos[l.tag].top):(o.indexOf("center")>=0?l.box.left=parseInt(2+(r.clientWidth-h)/2)+a:o.indexOf("right")>=0?l.box.left=r.clientWidth-h+a:l.box.left=a,o.indexOf("middle")>=0&&(l.box.top=parseInt(2+(r.clientHeight-y.y)/2)+i),o.indexOf("topquarter")>=0?l.box.top=parseInt(2+(r.clientHeight-y.y)/4)+i:o.indexOf("bottom")>=0?l.box.top=r.clientHeight-y.y+i:l.box.top=i),l.box.width=parseInt(h+4),l.box.height=Math.max(parseInt(y.y+4),l.minheight),MyrCompleteStyle(l.div,"left:"+l.box.left+"px;top:"+l.box.top+"px;width:"+l.box.width+"px;height:"+l.box.height+"px"),MyrIsDefined(l.titlediv)&&(l.titleheight=y.titleheight,MyrCompleteStyle(l.titlediv,"width:"+parseInt(h+4)+"px;height:"+y.titleheight+"px")),c=0;c<l.item.length;c++)s=l.item[c],s.position.indexOf("right")>=0?s.x=h-s.size.width-s.x:s.position.indexOf("center")>=0&&(s.x=parseInt(h/2-d[s.line].center/2+s.x)),s.position.indexOf("bottom")>=0?s.y+=d[s.line].height-s.size.height:s.position.indexOf("middle")>=0&&(s.y+=parseInt((d[s.line].height-s.size.height)/2)),s.x+=2,s.y+=2,MyrCompleteStyle(s.div,"left:"+s.x+"px;top:"+s.y+"px");MyrDlogUpdate(e,l),MyrCompleteStyle(l.div,"transform:scale(0);"),window.getComputedStyle(l.div).transform,MyrCompleteStyle(l.div,"visibility:visible"),MyrCompleteStyle(l.div,n.dialogboxopen)}function MyrDlogLocate(e,t,r){if(MyrIsDefined(e.dlog)&&MyrIsDefined(e.dlog.list))for(var o=0;o<e.dlog.list.length;o++){var a=e.dlog.list[o];if(MyrIsDefined(a.box)&&t>=a.box.left&&t<a.box.left+a.box.width&&r>=a.box.top&&r<a.box.top+a.box.height){t-=a.box.left,r-=a.box.top;for(var i=a.item.length-1;i>=0;i--){var n=a.item[i];if(MyrIsDefined(n.vectprocess)&&t>=n.x&&t<n.x+n.size.width&&r>=n.y&&r<n.y+n.size.height)return a.tag+" "+i}return r<a.titleheight?a.tag+" title":a.tag+" none"}}return""}function MyrDlogCloseBoxManage(e,t,r,o){"click"!=o&&"drag"!=o||MyrDlogClose(e,t.tag),console.log("ManageCloseBox")}function MyrDlogProcessItem(e,t,r,o){var a=MyrDlogGetDlogIndexByTag(t,r);if(MyrIsDefined(t)&&MyrIsDefined(t.dlog)&&MyrIsDefined(t.dlog.list[a])){var i=t.dlog.list[a];if("click"==e&&0!=a){t.dlog.list.splice(a,1),t.dlog.list.splice(0,0,i);for(var n=t.dlog.list.length-1;n>=0;n--)MyrCompleteStyle(t.dlog.list[n].div,"zIndex:"+(3e3-n));a=MyrDlogGetDlogIndexByTag(t,r)}if("title"===o){if("drag"==e){var s=t.mouse.x-t.mouse.lastdragx,l=t.mouse.y-t.mouse.lastdragy;(s||l)&&(i.box.left+=s,i.box.top+=l,i.box.left<0&&(i.box.left=0),i.box.left+i.box.width>t.fatherDiv.width&&(i.box.left=t.fatherDiv.width-i.box.width),i.box.top+i.box.height>t.fatherDiv.height&&(i.box.top=t.fatherDiv.height-i.box.height),i.box.top<0&&(i.box.top=0),MyrCompleteStyle(i.div,"left:"+i.box.left+"px;top:"+i.box.top+"px;"))}}else if("none"!==o&&(o=parseInt(o),MyrIsDefined(t.dlog.list[a].item[o]))){var d=t.dlog.list[a].item[o];return"click"!=e&&"drag"!=e||(t.mouse.clickedtype="dlog",t.mouse.clickeddata=r+" "+o),d.vectprocess&&d.vectprocess(t,t.dlog.list[a],d,e),MyrCtx.vrai}}return MyrCtx.faux}function MyrDlogClose(e,t){function r(e){for(var t=e.target.obj,r=e.target.dlog,o=0;o<t.dlog.list.length;o++)if(r.tag==t.dlog.list[o].tag){for(var a=0;a<r.item.length;a++)MyrIsDefined(r.item[a].div)&&(r.item[a].div.parentNode.removeChild(r.item[a].div),r.item[a].div=null);MyrIsDefined(r.titlediv)&&(r.titlediv.parentNode.removeChild(r.titlediv),r.titlediv=null),MyrIsDefined(r.div)&&(r.div.parentNode.removeChild(r.div),r.div=null),MyrIsDefined(t.dlog.pos)||(t.dlog.pos={}),t.dlog.pos[r.tag]={},t.dlog.pos[r.tag].left=r.box.left,t.dlog.pos[r.tag].top=r.box.top,MyrDlogDelete(t,o)}}var o=MyrDlogGetDlogIndexByTag(e,t);if(MyrIsDefined(e)&&MyrIsDefined(e.dlog)&&MyrIsDefined(e.dlog.list[o])){var a=e.dlog.list[o];a.div.dlog=a,a.div.obj=e,MyrCompleteStyle(a.div,"transform:scale(0);"),a.div.addEventListener("transitionend",r,!1)}}function MyrDlogUpdate(e,t){if(MyrIsDefined(t.div))for(var r=0;r<t.item.length;r++){var o=t.item[r];o.vectprocess&&o.vectprocess(e,t,t.item[r],"update")}}function MyrDlogAddTool(e,t,r,o,a,i,n,s,l,d,y,c){var u,f,m=/(^\d+) (.*$)/.exec(r),M=a*i/100,p=a*n/100;u=a/100,f=parseInt(o/u),r="<g id='Myr-"+e.index+"-"+s+"' fill='"+MyrCreateGradient(e.theme.fill,MyrCtx.vrai)+"' stroke='"+MyrCreateGradient(e.theme.stroke,MyrCtx.vrai)+"' stroke-width='"+e.theme.strokewidth+"' opacity='"+e.theme.opacity+"' style='transition:all "+e.theme.transition+";transform-origin: 50% 50%; transform:scale("+e.theme.scale+","+e.theme.scale+")'>"+m[2]+"</g>",r+="<g id='MyrOver-"+e.index+"-"+s+"' opacity='"+e.theme.notoveropacity+"' fill='"+MyrCreateGradient(e.theme.notoverfill,MyrCtx.vrai)+"' stroke='"+MyrCreateGradient(e.theme.notoverstroke,MyrCtx.vrai)+"' transform='scale("+e.theme.notoverscale+","+e.theme.notoverscale+")' style='transition: all "+e.theme.overtransition+";transform-origin: 50% 50%; transform:scale("+e.theme.notoverscale+","+e.theme.notoverscale+")'>"+e.theme.over+"</g>",r=MyrReplaceSVGTokens(e,s,r,f),r=MyrCtx.svgHeader+"width='"+parseInt(o+2*M)+"' height='"+(a+2*p)+"' viewBox='-"+i+" -"+n+" "+(f+2*i)+" "+(100+2*n)+"'>"+r+"</svg>";var g=MyrDlogAddItem(e,t,"none",r,s,0,l,d,-M+y,-p+c);return e.dlog.list[t].item[g].toolscale=f,g}function MyrParserError(e){return e.index>e.size}function MyrParseGetUChar(e){return e.buffer[e.index++]}function MyrParseGetUShort(e){var t,r;return t=e.buffer[e.index++],r=e.buffer[e.index++],(t<<8)+r}function MyrParseGetULong(e){var t,r,o,a;return t=e.buffer[e.index++],r=e.buffer[e.index++],o=e.buffer[e.index++],a=e.buffer[e.index++],(t<<24)+(r<<16)+(o<<8)+a>>>0}function MyrParseGetLong(e){var t=MyrParseGetULong(e);return t>=2147483648&&(t=4294967296-t),t}function MyrParseGetFloat(e){var t=new ArrayBuffer(4),r=new Uint8Array(t),o=new Float32Array(t);return r[3]=MyrParseGetUChar(e),r[2]=MyrParseGetUChar(e),r[1]=MyrParseGetUChar(e),r[0]=MyrParseGetUChar(e),o[0]}function MyrParseGetTag(e){var t,r="";const o=8;for(var a=0;o>a;a++)t=e.buffer[e.index++],t>0&&(r+=String.fromCharCode(t));return r}function MyrParseGetUTFString(e,t){for(var r="";t>0&&!MyrParserError(e);){var o;if(o=MyrParseGetUChar(e),t--,192>o)nbytes=0;else if(224>o)o-=192,nbytes=2;else if(240>o)o-=224,nbytes=3;else if(248>o)o-=240,nbytes=4;else if(252>o)o-=248,nbytes=5;else{if(!(254>o))return e.index+=t,r+"???";o-=252,nbytes=6}if(nbytes>t)return e.index+=t,r+"???";for(var a=o,i=1;i<nbytes;i++){if(o=MyrParseGetUChar(e),t--,128>o||o>=192)return e.index+=t,r+"???";a=(a<<6)+(63&o)>>>0}r+=String.fromCharCode(a)}return r}function MyrParseGetPascalStr(e){var t=MyrParseGetUShort(e);return MyrParseGetUTFString(e,t)}function MyrParseChunkHeader(e){var t={};return t._tag=tag=MyrParseGetTag(e),t._isParent=MyrParseGetUChar(e),t._datasize=MyrParseGetULong(e),MyrParserError(e)&&(t=null),t}function MyrParseChunkLevel(e,t,r,o,a){MyrIsDefined(MyrCtx.CHUNK_STR)||(MyrCtx.CHUNK_SVG="SvgFile",MyrCtx.CHUNK_PNG="PngFile",MyrCtx.CHUNK_NUMBER="Long",MyrCtx.CHUNK_FRAME="Frame",MyrCtx.CHUNK_TIME="Time",MyrCtx.CHUNK_RANGE="Range",MyrCtx.CHUNK_NOTE="Note",MyrCtx.CHUNK_EVENT="Event",MyrCtx.CHUNK_MP3="MpgFile",MyrCtx.CHUNK_TAGGED_LONG="TagLong",MyrCtx.CHUNK_TAGGED_FLOAT="TagFloat",MyrCtx.CHUNK_TAGGED_FRAME="TagFrame",MyrCtx.CHUNK_TAGGED_RGB="TagRgb",MyrCtx.CHUNK_TAGGED_STR="TagStr",MyrCtx.counter=0);for(var i,s,l,d,y,c,u,f=e.index+t,m=MyrCtx.faux;e.index<f&&!m;){var M=MyrParseChunkHeader(e);if(null!==M)if(d=M._tag,MyrIsDefined(r[d])||(r[d]=[]),n=r[d].length,r[d][n]=M,1==M._isParent)MyrParseChunkLevel(e,M._datasize,M,o+1,a)||(m=MyrCtx.vrai);else if(2==M._isParent){var p=MyrParseGetULong(e);MyrParseGetULong(e);var g={};g.index=0,g.buffer=MyrZip.UnzipBlock(e.buffer,e.index,M._datasize-8,p),g.size=p,MyrParseChunkLevel(g,p,M,o+1,a)||(m=MyrCtx.vrai),e.index+=M._datasize-8,g.buffer=null}else switch(d){case MyrCtx.CHUNK_STR:s=MyrParseGetTag(e),i=MyrParseGetUTFString(e,M._datasize-5),MyrParseGetUChar(e),M.type=s,M.str=i,r[d][s]=i;break;case MyrCtx.CHUNK_SVG:i=MyrParseGetUTFString(e,M._datasize);var h=/(id *= *\"|href *= *\"#|url[\(]#)/g;MyrIsDefined(a)||(a=0);var v=a+"-";M.str=i.replace(h,"$1"+v);break;case MyrCtx.CHUNK_NUMBER:l=MyrParseGetULong(e),M.value=l;break;case MyrCtx.CHUNK_TYPED_NUMBER:s=MyrParseGetTag(e),l=MyrParseGetULong(e),M.type=s,M.value=l,r[d][s]=l;break;case MyrCtx.CHUNK_FRAME:M.left=MyrParseGetLong(e),M.top=MyrParseGetLong(e),M.right=MyrParseGetLong(e),M.bottom=MyrParseGetLong(e);break;case MyrCtx.CHUNK_TIME:M.areaindex=MyrParseGetULong(e),M.time=MyrParseGetULong(e)/1e3;break;case MyrCtx.CHUNK_RANGE:M.from=MyrParseGetULong(e),M.to=MyrParseGetULong(e);break;case MyrCtx.CHUNK_EVENT:M.time=MyrParseGetULong(e)/1e3,M.kind=MyrParseGetUChar(e);break;case MyrCtx.CHUNK_NOTE:M.timestart=MyrParseGetULong(e)/1e3,M.timeend=MyrParseGetULong(e)/1e3,M.pitch=MyrParseGetUChar(e),M.velocity=MyrParseGetUChar(e),M.finger=MyrParseGetUChar(e),M.string=MyrParseGetUChar(e),M.fret=MyrParseGetUChar(e),M.shape=MyrParseGetUChar(e),y=MyrParseGetUChar(e),c=MyrParseGetUChar(e),u=MyrParseGetUChar(e),M.rgb=(y<<16)+(c<<8)+u;break;case MyrCtx.CHUNK_TAGGED_LONG:M._tag=MyrParseGetPascalStr(e),M.value=MyrParseGetULong(e),r["$"+M._tag]=M.value;break;case MyrCtx.CHUNK_TAGGED_FLOAT:M._tag=MyrParseGetPascalStr(e),M.value=MyrParseGetFloat(e),r["$"+M._tag]=M.value;break;case MyrCtx.CHUNK_TAGGED_FRAME:var b={};M._tag=MyrParseGetPascalStr(e),M.left=b.left=MyrParseGetFloat(e),M.top=b.top=MyrParseGetFloat(e),M.right=b.right=MyrParseGetFloat(e),M.bottom=b.bottom=MyrParseGetFloat(e),r["$"+M._tag]=b;break;case MyrCtx.CHUNK_TAGGED_RGB:var x={};M._tag=MyrParseGetPascalStr(e),M.red=x.red=MyrParseGetUShort(e),M.green=x.green=MyrParseGetUShort(e),M.blue=x.blue=MyrParseGetUShort(e),r["$"+M._tag]=x;break;case MyrCtx.CHUNK_TAGGED_STR:var D=e.index;M._tag=MyrParseGetPascalStr(e),i=MyrParseGetUTFString(e,M._datasize-(e.index-D)),r["$"+M._tag]=i;break;default:t=r[d][n]._datasize,M.data=new Uint8Array(t);for(var P=0;t>P;P++)M.data[P]=e.buffer[e.index++]}else m=MyrCtx.vrai}return!m}function MyrCreateAudioElement(e,t,r){Debug("creating Fail-safe "+r.length);for(var o="",a=0;a<r.length;a++)o+=String.fromCharCode(r[a]);var i=document.createElement("audio");return i.setAttribute("src","data:"+t+";base64,"+window.btoa(o)),e.fatherDiv.appendChild(i),i}function MyrInitSound(e){MyrIsDefined(MyrCtx.audioContext)||(MyrCtx.audioFailSafe=MyrCtx.faux,"function"==typeof window.AudioContext?MyrCtx.audioContext=new window.AudioContext:"function"==typeof window.webkitAudioContext||"object"==typeof window.webkitAudioContext?MyrCtx.audioContext=new window.webkitAudioContext:MyrCtx.audioFailSafe=MyrCtx.vrai),MyrIsDefined(e.sound.useAudioFailSafe)&&e.sound.useAudioFailSafe?e.sound.useAudioFailSafe=MyrCtx.vrai:e.sound.useAudioFailSafe=MyrCtx.audioFailSafe,e.sound.track=[],e.sound.playState=MyrCtx.STATE_STOPPED}function MyrInitSoundTrack(e,t,r,o){e.sound.track[t].active=1,e.sound.track[t].volume=1,e.sound.track[t].panning=0,console.log("Source: "+r.byteLength),console.time("Decode"+e.index+"-"+t),e.sound.useAudioFailSafe?(e.sound.track[t].audio=MyrCreateAudioElement(e,o,new Uint8Array(r)),e.sound.track[t].ready=MyrCtx.vrai,e.sound.track[t].duration=e.sound.track[t].audio.duration,e.sound.duration=Math.max(e.sound.duration,e.sound.track[t].duration),MyrToolbarChange(e)):(e.sound.track[t].ready=MyrCtx.faux,e.sound.track[t].duration=0,MyrCtx.audioContext.decodeAudioData(r,function(r){return r?(Debug(e+" --- "+t),e.sound.track[t].data=r,e.sound.track[t].originaldata=r,!e.sound.useAudioFailSafe&&r.numberOfChannels<2?(console.log("STEREO FROM MONO"+e.sound.track[t].panningtrim),e.sound.track[t].panning=e.sound.track[t].panningtrim,e.sound.track[t].panningtrim=0):(e.sound.track[t].panningtrim*=.8,console.log("STEREO FROM STEREO"+e.sound.track[t].panningtrim)),e.sound.track[t].ready=MyrCtx.vrai,e.sound.track[t].duration=r.duration,e.sound.duration=Math.max(e.sound.duration,e.sound.track[t].duration),console.timeEnd("Decode"+e.index+"-"+t),console.log("Dest: "+r.length),void MyrToolbarChange(e)):void MyrError(e,"Error decoding audio data: "+e.sound.track[t].src)}))}function MyrAreAllTracksReady(e){for(var t=0;t<e.sound.nbTracks;t++)if(!MyrIsDefined(e.sound.track[t])||!e.sound.track[t].ready)return MyrCtx.faux;return MyrCtx.vrai}function MyrSoundSetGeneralVolume(e,t){e.sound.generalVolume=t,MyrSoundUpdateLevels(e)}function MyrSetTrackActive(e,t,r){e.sound.track[t].active=r,MyrSoundUpdateTrackLevels(e,t)}function MyrSetTrackVolume(e,t,r){e.sound.track[t].volume=parseFloat(r),MyrSoundUpdateTrackLevels(e,t)}function MyrSetTrackPanning(e,t,r){e.sound.track[t].panning=r,MyrSoundUpdateTrackLevels(e,t)}function MyrSetTrackSolo(e,t,r){e.sound.solotrack==t?e.sound.solotrack=null:e.sound.solotrack=t,MyrSoundUpdateLevels(e)}function MyrSoundUpdateTrackLevels(e,t){var r,o=e.sound.track[t],a=1e-5,i=o.panning*(1-a);0===i&&(i=a),0===r&&(r=a),r=MyrIsDefined(e.sound.solotrack)?e.sound.solotrack==t?o.volume*e.sound.generalVolume:0:o.active*o.volume*e.sound.generalVolume,e.sound.useAudioFailSafe?o.audio.volume=r:(o.LLGain||o.LeftGain)&&(o.stereo?0>i?(o.LLGain.gain.value=r,o.LRGain.gain.value=a,o.RLGain.gain.value=r*-i,o.RRGain.gain.value=r*(1+i)):(o.LLGain.gain.value=r*(1-i),o.LRGain.gain.value=r*i,o.RLGain.gain.value=a,o.RRGain.gain.value=r):0>i?(o.LeftGain.gain.value=r,o.RightGain.gain.value=r*(1+i)):(o.LeftGain.gain.value=r*(1-i),o.RightGain.gain.value=r))}function MyrSoundUpdateLevels(e){var t;for(t=0;t<e.sound.track.length;t++)MyrSoundUpdateTrackLevels(e,t);e.sound.playMode.metronome.volumeNode&&(e.sound.playMode.metronome.volumeNode.gain.value=e.sound.playMode.metronome.volume*e.sound.generalVolume)}function MyrRawTimeStamp(e){return e.sound.useAudioFailSafe?e.sound.track[0].audio.currentTime:MyrCtx.audioContext.currentTime}function MyrSoundTime(e){var t=MyrRawTimeStamp(e)-e.sound.runtime.timeStampStart;if(MyrIsDefined(e.sound.playMode.end)&&e.sound.playMode.end>0){var r=e.sound.playMode.start;for(MyrIsDefined(r)&&e.sound.canJump||(r=0);t>e.sound.playMode.end;)t-=e.sound.playMode.end-r}return t}function MyrMetroMakeSound(e,t){var r,o,a,i,n,s=Math.floor(arguments.length-2)/3,l=[];for(n=0;s>n;n++)l[n]=arguments[3*n+3];for(samplerate=MyrCtx.audioContext.sampleRate,o=samplerate*e,i=MyrCtx.audioContext.createBuffer(1,o,samplerate),a=i.getChannelData(0),t=6.28*t/samplerate,n=0;o>n;n++)for(a[n]=0,r=0;s>r;r++)arguments[3*r+2]<100?a[n]+=Math.sin(t*n*arguments[3*r+2])*l[r]/100:a[n]+=(2*Math.random()-1)*l[r]/100,l[r]*=(1e4-arguments[3*r+4])/1e4;return i}function MyrMetroInit(){MyrIsDefined(MyrCtx.metrobell)||(MyrCtx.metrobell=MyrMetroMakeSound(.75,4e3,.628,2,5,1,20,1.7,2,2.5,2.5,4,5,3,5,5,3,7,15,4),MyrCtx.metroclick=MyrMetroMakeSound(.45,140,1,6,58,2.53,4,58,3.43,15,60,7.18,15,55,21.78,17,42,100,23,90))}function MyrAddMetronomeSound(e,t,r){var o={};MyrMetroInit(),o.data=0===t?MyrCtx.metroclick:MyrCtx.metrobell,o.pos=r,o.source=null,MyrIsDefined(e.sound.metrobits)||(e.sound.metrobits=[]),e.sound.metrobits.push(o)}function MyrPrepareMetronome(e){var t=e.sound.playMode.tempo;if(MyrIsDefined(t)&&0!=t||(t=1),!e.sound.useAudioFailSafe&&MyrIsDefined(e.sync.metronome)&&e.sync.metronome.note.length>1&&(e.sound.playMode.metronome.before||e.sound.playMode.metronome.beat||e.sound.playMode.metronome.bar)){var r=e.sync.metronome.note;if(e.sound.metrobits=[],e.sound.playMode.metronome.before){var o=(r[1].time-r[0].time)/t;for(pos=8*-o,i=0;i<2;i++)MyrAddMetronomeSound(e,0,pos),pos+=2*o;for(i=0;i<4;i++)MyrAddMetronomeSound(e,0,pos),pos+=o}if(e.sound.playMode.metronome.beat||e.sound.playMode.metronome.bar)for(i=0;i<r.length;i++)pos=r[i].time/t,e.sound.playMode.metronome.beat&&MyrAddMetronomeSound(e,0,pos),2==r[i].kind&&e.sound.playMode.metronome.bar&&MyrAddMetronomeSound(e,1,pos);
}}function MyrSoundPause(e){var t;if(MyrStopTimer("playedbar"),e.sound.runtime.timePause=MyrSoundTime(e),e.sound.useAudioFailSafe)for(t=0;t<e.sound.nbTracks;t++)e.sound.track[t].audio.pause();else{for(e.sound.track[0].source.onended=null,t=0;t<e.sound.nbTracks;t++)e.sound.track[t].source.stop(0),e.sound.track[t].source=null;if(MyrIsDefined(e.sound.metrobits))for(t=0;t<e.sound.metrobits.length;t++)MyrIsDefined(e.sound.metrobits[t].source)&&(e.sound.metrobits[t].source.stop(0),e.sound.metrobits[t].source=null);for(t=0;t<e.sound.nbTracks;t++)MyrIsDefined(e.sound.track[t].mergerNode)&&(e.sound.track[t].mergerNode.disconnect(),e.sound.track[t].mergerNode=null),MyrIsDefined(e.sound.track[t].RightGain)&&(e.sound.track[t].RightGain.disconnect(),e.sound.track[t].RightGain=null),MyrIsDefined(e.sound.track[t].LeftGain)&&(e.sound.track[t].LeftGain.disconnect(),e.sound.track[t].LeftGain=null),MyrIsDefined(e.sound.track[t].LLGain)&&(e.sound.track[t].LLGain.disconnect(),e.sound.track[t].LLGain=null),MyrIsDefined(e.sound.track[t].RLGain)&&(e.sound.track[t].RLGain.disconnect(),e.sound.track[t].RLGain=null),MyrIsDefined(e.sound.track[t].LRGain)&&(e.sound.track[t].LRGain.disconnect(),e.sound.track[t].LRGain=null),MyrIsDefined(e.sound.track[t].RRGain)&&(e.sound.track[t].RRGain.disconnect(),e.sound.track[t].RRGain=null),MyrIsDefined(e.sound.track[t].splitterNode)&&(e.sound.track[t].splitterNode.disconnect(),e.sound.track[t].splitterNode=null),MyrIsDefined(e.sound.playMode.metronome.volumeNode)&&(e.sound.playMode.metronome.volumeNode.disconnect(),e.sound.playMode.metronome.volumeNode=null)}e.sound.playState=MyrCtx.STATE_PAUSED}function MyrSoundDepause(e){var t,r,o,a,i=.2;if(t=MyrIsDefined(e.sound.playMode.start)&&e.sound.canJump?e.sound.playMode.start:0,r=MyrIsDefined(e.sound.playMode.end)&&e.sound.canJump?e.sound.playMode.end:e.sound.duration,e.keyboard.div.height&&MyrKbdJumpTo(e,t),o=e.sound.runtime.timePause,(t>o||o>r)&&(o=t),e.sound.useAudioFailSafe){if(e.sound.canJump||0===o)for(e.sound.runtime.timeStampStart=0,a=0;a<e.sound.nbTracks;a++)e.sound.track[a].audio.currentTime=o;for(a=0;a<e.sound.nbTracks;a++)e.sound.track[a].audio.play()}else{if(MyrIsDefined(e.sound.metrobits)){if(0===o){var n=e.sound.metrobits[0].pos;0>n&&(i-=n)}for(e.sound.playMode.metronome.volumeNode=MyrCtx.audioContext.createGain(1),a=0;a<e.sound.metrobits.length;a++)(0===o||e.sound.metrobits[a].pos>=o)&&e.sound.metrobits[a].pos<=r&&(e.sound.metrobits[a].source=MyrCtx.audioContext.createBufferSource(),e.sound.metrobits[a].source.buffer=e.sound.metrobits[a].data,e.sound.metrobits[a].source.connect(e.sound.playMode.metronome.volumeNode));e.sound.playMode.metronome.volumeNode.connect(MyrCtx.audioContext.destination)}for(a=0;a<e.sound.nbTracks;a++)e.sound.track[a].source=MyrCtx.audioContext.createBufferSource(),e.sound.track[a].source.buffer=e.sound.track[a].data,e.sound.track[a].mergerNode=MyrCtx.audioContext.createChannelMerger(2),e.sound.track[a].data.numberOfChannels>1?(e.sound.track[a].stereo=MyrCtx.vrai,e.sound.track[a].splitterNode=MyrCtx.audioContext.createChannelSplitter(2),e.sound.track[a].source.connect(e.sound.track[a].splitterNode),e.sound.track[a].LLGain=MyrCtx.audioContext.createGain(1),e.sound.track[a].LLGain.gain.value=.01,e.sound.track[a].RLGain=MyrCtx.audioContext.createGain(1),e.sound.track[a].RLGain.gain.value=.01,e.sound.track[a].LRGain=MyrCtx.audioContext.createGain(1),e.sound.track[a].LRGain.gain.value=.01,e.sound.track[a].RRGain=MyrCtx.audioContext.createGain(1),e.sound.track[a].RRGain.gain.value=.01,e.sound.track[a].splitterNode.connect(e.sound.track[a].LLGain,0,0),e.sound.track[a].splitterNode.connect(e.sound.track[a].RLGain,1,0),e.sound.track[a].splitterNode.connect(e.sound.track[a].LRGain,0,0),e.sound.track[a].splitterNode.connect(e.sound.track[a].RRGain,1,0),e.sound.track[a].LLGain.connect(e.sound.track[a].mergerNode,0,0),e.sound.track[a].RLGain.connect(e.sound.track[a].mergerNode,0,0),e.sound.track[a].LRGain.connect(e.sound.track[a].mergerNode,0,1),e.sound.track[a].RRGain.connect(e.sound.track[a].mergerNode,0,1)):(e.sound.track[a].stereo=MyrCtx.faux,e.sound.track[a].LeftGain=MyrCtx.audioContext.createGain(),e.sound.track[a].LeftGain.gain.value=.01,e.sound.track[a].RightGain=MyrCtx.audioContext.createGain(),e.sound.track[a].RightGain.gain.value=.01,e.sound.track[a].source.connect(e.sound.track[a].LeftGain),e.sound.track[a].source.connect(e.sound.track[a].RightGain),e.sound.track[a].LeftGain.connect(e.sound.track[a].mergerNode,0,0),e.sound.track[a].RightGain.connect(e.sound.track[a].mergerNode,0,1)),e.sound.track[a].mergerNode.connect(MyrCtx.audioContext.destination),e.sound.playMode.loop&&(e.sound.track[a].source.loop=!0,e.sound.track[a].source.loopStart=t,e.sound.track[a].source.loopEnd=r),e.sound.track[a].source.start||(e.sound.track[a].source.start=e.sound.track[a].source.noteOn),e.sound.track[a].source.stop||(e.sound.track[a].source.stop=e.sound.track[a].source.noteOff);for(e.sound.track[0].source.onended=function(){MyrSoundStop(e)},MyrSoundUpdateLevels(e),e.sound.runtime.timeStampStart=MyrRawTimeStamp(e)+i-o,console.log("Current time "+MyrRawTimeStamp(e)),console.log("Pos in score "+o),a=0;a<e.sound.nbTracks;a++)console.log("track "+a+" schedule at "+e.sound.runtime.timeStampStart),e.sound.track[a].source.start(e.sound.runtime.timeStampStart+o,o,r-t);if(MyrIsDefined(e.sound.metrobits))for(console.log("First metronome scheduled at "+e.sound.runtime.timeStampStart+e.sound.metrobits[0].pos),a=0;a<e.sound.metrobits.length;a++)MyrIsDefined(e.sound.metrobits[a].source)&&e.sound.metrobits[a].pos>=t-i&&e.sound.metrobits[a].source.start(.05+e.sound.runtime.timeStampStart+e.sound.metrobits[a].pos);console.log("all started at "+MyrRawTimeStamp(e))}e.sound.playState=MyrCtx.STATE_PLAYING,e.sound.pausedTime=0,MyrStartTimer("playedbar",MyrDisplayPlayedBar,MyrCtx.NB_MS_POS_MUSIQUE)}function MyrSoundJump(e,t){e.sound.playState==MyrCtx.STATE_STOPPED&&MyrSoundPlay(e),e.sound.playState==MyrCtx.STATE_PLAYING?(MyrSoundPause(e),e.sound.runtime.timePause=t,MyrSoundDepause(e)):(e.sound.runtime.timePause=t,MyrDisplayCurrentPos(e,t)),e.keyboard.div.height&&MyrKbdJumpTo(e,t)}function MyrSoundRelativeJump(e,t){var r=0;e.sound.playState==MyrCtx.STATE_PLAYING?r=MyrSoundTime(e):e.sound.playState==MyrCtx.STATE_PAUSED&&(r=e.sound.runtime.timePause),console.log("relative "+t),MyrSoundJump(e,r+t)}function MyrSoundStop(e){MyrSoundPause(e),e.sound.metrobits=null,e.sound.playState=MyrCtx.STATE_STOPPED,MyrKbdReleaseAll(e),MyrSetDivSize(e.page.divcursor,0,0),e.keyboard.div.height&&MyrKbdJumpTo(e,0),MyrResetAnnotations(e)}function MyrSoundChangeMetronome(e){e.sound.playState==MyrCtx.STATE_PLAYING?(MyrSoundPause(e),e.sound.metrobits=null,MyrPrepareMetronome(e),MyrSoundDepause(e)):e.sound.playState==MyrCtx.STATE_PAUSED&&(e.sound.metrobits=null,MyrPrepareMetronome(e))}function MyrSoundChangeData(e){var t;if(e.sound.playMode.tempo!=e.sound.playMode.scheduledtempo||e.sound.playMode.detune!=e.sound.playMode.scheduleddetune)if(e.sound.useAudioFailSafe)for(t=0;t<e.sound.track.length;t++)e.sound.playMode.tempo=e.sound.playMode.scheduledtempo,e.sound.playMode.detune=e.sound.playMode.scheduleddetune,e.sound.track[t].audio.playbackRate=e.sound.playMode.tempo;else for(MyrSoundTransform.Stop(e.sound),t=0;t<e.sound.track.length;t++)if(0==e.sound.playMode.scheduleddetune&&1==e.sound.playMode.scheduledtempo)e.sound.playMode.tempo=e.sound.playMode.scheduledtempo,e.sound.playMode.detune=e.sound.playMode.scheduleddetune,e.sound.track[t].data=e.sound.track[t].originaldata;else for(var r=e.sound.track[t].originaldata.numberOfChannels,o=0;r>o;o++){var a={};a.obj=e,a.track=t,a.nbchan=r,a.chan=o;var i=e.sound.track[t].originaldata.getChannelData(o);MyrSoundTransform.Do(e.sound,i,100*e.sound.playMode.scheduleddetune,e.sound.playMode.scheduledtempo,!1,a,SoundTransformCallback)}}function SoundTransformCallback(e,t){var r=e.identifier.obj,o=e.identifier.track,a=e.identifier.nbchan,i=e.identifier.chan,n=r.sound.track[o];if(0===t)n.ready=!1,MyrToolbarChange(e.identifier.obj),0==o&&0==i&&(MyrProgressBarOpen(r,"progressbar",2),MyrProgressBarSet(r,"progressbar",0,"-",0),MyrProgressBarSet(r,"progressbar",1,"Total",0));else if(1==t){var s=Math.floor(100*e.computedPos/e.numSampsToProcess);MyrProgressBarSet(r,"progressbar",0,n.name+" "+(i+1)+"/"+a,s);var l=100*(o*a+i+s/100)/(r.sound.track.length*a);MyrProgressBarSet(r,"progressbar",1,"Total",l),r.sound.playMode.tempo=r.sound.playMode.scheduledtempo,r.sound.playMode.detune=r.sound.playMode.scheduleddetune}else if(t>=2){var l=100*(o*a+i+1)/(r.sound.track.length*a);MyrProgressBarSet(r,"progressbar",1,"Total",l),0==i&&(n.data=MyrCtx.audioContext.createBuffer(a,e.result.length,MyrCtx.audioContext.sampleRate*e.sampleRateModifier),r.sound.track[o].duration=n.data.duration);var d=n.data.getChannelData(i);d.set(e.result),i==a-1&&(n.ready=!0,o==r.sound.track.length-1&&(MyrProgressBarClose(r,"progressbar"),r.sound.duration=r.sound.track[o].duration,MyrToolbarChange(e.identifier.obj)))}}function MyrSoundPlay(e){var t,r;for(t=0;t<MyrCtx.myrTab.length;t++)r=MyrCtx.myrTab[t],r.sound.playState!=MyrCtx.STATE_STOPPED&&MyrSoundStop(r);if(e.sound.useAudioFailSafe){for(t=0;t<e.sound.nbTracks;t++)e.sound.track[t].audio.volume=0;for(t=0;t<e.sound.nbTracks;t++)e.sound.track[t].audio.play();for(t=0;t<e.sound.nbTracks;t++)e.sound.track[t].audio.pause();for(t=0;t<e.sound.nbTracks;t++)e.sound.track[t].audio.volume=e.sound.track[t].active*e.sound.track[t].volume*e.sound.generalVolume,e.sound.track[t].audio.playbackRate=e.sound.playMode.tempo}else MyrPrepareMetronome(e);if(e.sound.runtime.timePause=0,MyrSoundDepause(e),e.sound.useAudioFailSafe)for(t=0;t<e.sound.nbTracks;t++)e.sound.track[t].audio.playbackRate=e.sound.playMode.tempo}function MyrKbdInitDrawings(){MyrIsDefined(MyrCtx.kbdsvg)||(MyrCtx.kbdsvg="<defs>	<linearGradient id='myrGradWhite' x1='00%' y1='00%' x2='100%' y2='100%'>      <stop offset='0%' style='stop-color:#FFFFD0; stop-opacity:1' />      <stop offset='55%' style='stop-color:#FFFFE0; stop-opacity:1' />      <stop offset='100%' style='stop-color:#FFFFF9; stop-opacity:1' /></linearGradient>	<linearGradient id='myrGradWhitePress' x1='00%' y1='00%' x2='0%' y2='100%'>       <stop offset='10%' style='stop-color:white;stop-opacity:0.1' />	  <stop offset='40%' style='stop-color:white;stop-opacity:0.2' />      <stop offset='100%' style='stop-color:black;stop-opacity:0.2' />    </linearGradient><linearGradient id='myrGradBlkPress' x1='50%' y1='100%' x2='50%' y2='0%'>	<stop offset='0%' style='stop-color:#303030; stop-opacity:1' /> 	<stop offset='15%' style='stop-color:#808080; stop-opacity:1' /> 	<stop offset='30%' style='stop-color:#606060; stop-opacity:1' />    <stop offset='100%' style='stop-color:black; stop-opacity:1' /></linearGradient><linearGradient id='myrGradBlkRefl' x1='0%' y1='0%' x2='100%' y2='100%'>	<stop offset='50%' style='stop-color:white; stop-opacity:0' />    <stop offset='80%' style='stop-color:white; stop-opacity:1' />	 <stop offset='100%' style='stop-color:white; stop-opacity:0.1' /></linearGradient>	<linearGradient id='myrGradBlkReflPressed' x1='00%' y1='0%' x2='140%' y2='40%'>	<stop offset='50%' style='stop-color:white; stop-opacity:0' />    <stop offset='70%' style='stop-color:white; stop-opacity:1' />	 <stop offset='90%' style='stop-color:white; stop-opacity:0.1' /></linearGradient>	<linearGradient id='myrGradWhiteRefl' x1='0%' y1='0%' x2='100%' y2='0%'>	<stop offset='0%' style='stop-color:white; stop-opacity:0.51' />	<stop offset='50%' style='stop-color:white; stop-opacity:0' />    <stop offset='100%' style='stop-color:black; stop-opacity:0.2' /></linearGradient>	<linearGradient id='myrGradWhiteRefl2' x1='40%' y1='0%' x2='0%' y2='100%'>	<stop offset='40%' style='stop-color:white; stop-opacity:0' />	<stop offset='65%' style='stop-color:white; stop-opacity:0.9' />	<stop offset='90%' style='stop-color:white; stop-opacity:0' /></linearGradient>	<path id='myrPathWhite' d='M 0 0 L 0 85 Q 0 90 5 90 L 20 90 Q 25 90 25 85 L 25 0z' />	<path id='myrPathWhiteRefl' d='M 0 0 L 0 85 Q 0 90 5 90 L 20 90 Q 25 90 25 85 L 25 0 L 23 0 L 23 83 Q 23 88 18 88 L 7 88 Q 2 88 2 83 L 2 0z' />	<path id='myrPathWhitePress' d='M 0 0 L -1 82 Q -1 87 4 87 L 19 87 Q 24 87 24 82 L 25 0z' /><path id='myrPathBlack' d='M 0 0 L 0 53 Q 0 58 5 58 L 7 58 Q 12 58 12 53 L 12 0z' /><path id='myrPathBlackRefl' d='M 10 0 L 10 49 Q 10 54 7 54 L 2 54'  /><path id='myrPathBlackReflPress' d='M 10 0 L 10 51 Q 10 56 7 56 L 2 56'  /><g id='myrKeyWhite'><use xlink:href='#myrPathWhite'  fill='url(#myrGradWhite)' stroke-width='0.8' stroke='#404040'/></g><g id='myrKeyWhitePress' ><use xlink:href='#myrPathWhite' fill='rgb(230,230,190)' stroke='none' /></g><g id='myrKeyBlack' transform='scale(1.2,1)'><use xlink:href='#myrPathBlack' fill='black' stroke='none' /><use xlink:href='#myrPathBlackRefl'  fill='none' stroke-width='2' stroke='url(#myrGradBlkRefl)'/></g><g id='myrKeyBlackPress'><use xlink:href='#myrPathBlack' fill='#707070' stroke='none' /></g></defs>",MyrCtx.kbdsvgComplex="<style> </style><defs><filter id='myrFilterDrop' x='-10%' y='-10%' width='150%' height='150%'>  <feGaussianBlur in='SourceAlpha' stdDeviation='1'/>  <feOffset dx='2' dy='3'/>  <feComponentTransfer>    <feFuncA type='linear' slope='0.4'/>  </feComponentTransfer>  <feMerge>     <feMergeNode/>    <feMergeNode in='SourceGraphic'/>  </feMerge></filter>	<linearGradient id='myrGradWhite' x1='00%' y1='00%' x2='100%' y2='100%'>      <stop offset='0%' style='stop-color:white; stop-opacity:0' />      <stop offset='55%' style='stop-color:white; stop-opacity:1' />      <stop offset='100%' style='stop-color:white; stop-opacity:0.5' /></linearGradient>	<linearGradient id='myrGradWhitePress' x1='00%' y1='00%' x2='0%' y2='100%'>       <stop offset='10%' style='stop-color:white;stop-opacity:0.1' />	  <stop offset='40%' style='stop-color:white;stop-opacity:0.2' />      <stop offset='100%' style='stop-color:black;stop-opacity:0.2' />    </linearGradient><linearGradient id='myrGradBlkPress' x1='50%' y1='100%' x2='50%' y2='0%'>	<stop offset='0%' style='stop-color:#303030; stop-opacity:1' /> 	<stop offset='15%' style='stop-color:#808080; stop-opacity:1' /> 	<stop offset='30%' style='stop-color:#606060; stop-opacity:1' />    <stop offset='100%' style='stop-color:black; stop-opacity:1' /></linearGradient><linearGradient id='myrGradBlkRefl' x1='0%' y1='0%' x2='100%' y2='100%'>	<stop offset='50%' style='stop-color:white; stop-opacity:0' />    <stop offset='80%' style='stop-color:white; stop-opacity:1' />	 <stop offset='100%' style='stop-color:white; stop-opacity:0.1' /></linearGradient>	<linearGradient id='myrGradBlkReflPressed' x1='00%' y1='0%' x2='140%' y2='40%'>	<stop offset='50%' style='stop-color:white; stop-opacity:0' />    <stop offset='70%' style='stop-color:white; stop-opacity:1' />	 <stop offset='90%' style='stop-color:white; stop-opacity:0.1' /></linearGradient>	<linearGradient id='myrGradWhiteRefl' x1='0%' y1='0%' x2='100%' y2='0%'>	<stop offset='0%' style='stop-color:white; stop-opacity:0.51' />	<stop offset='50%' style='stop-color:white; stop-opacity:0' />    <stop offset='100%' style='stop-color:black; stop-opacity:0.2' /></linearGradient>	<linearGradient id='myrGradWhiteRefl2' x1='40%' y1='0%' x2='0%' y2='100%'>	<stop offset='40%' style='stop-color:white; stop-opacity:0' />	<stop offset='65%' style='stop-color:white; stop-opacity:0.9' />	<stop offset='90%' style='stop-color:white; stop-opacity:0' /></linearGradient>	<path id='myrPathWhite' d='M 0 0 L 0 85 Q 0 90 5 90 L 20 90 Q 25 90 25 85 L 25 0z' />	<path id='myrPathWhiteRefl' d='M 0 0 L 0 85 Q 0 90 5 90 L 20 90 Q 25 90 25 85 L 25 0 L 23 0 L 23 83 Q 23 88 18 88 L 7 88 Q 2 88 2 83 L 2 0z' />	<path id='myrPathWhitePress' d='M 0 0 L -1 82 Q -1 87 4 87 L 19 87 Q 24 87 24 82 L 25 0z' /><path id='myrPathBlack' d='M 0 0 L 0 53 Q 0 58 5 58 L 7 58 Q 12 58 12 53 L 12 0z' /><path id='myrPathBlackRefl' d='M 10 0 L 10 49 Q 10 54 7 54 L 2 54'  /><path id='myrPathBlackReflPress' d='M 10 0 L 10 51 Q 10 56 7 56 L 2 56'  /><g id='myrKeyWhite'><use xlink:href='#myrPathWhite' fill='rgb(230,230,190)' stroke='none'  filter='url(#myrFilterDrop)'/><use xlink:href='#myrPathWhite'  fill='url(#myrGradWhite)' opacity='0.6' stroke='none'/><use xlink:href='#myrPathWhiteRefl'  fill='url(#myrGradWhiteRefl)' stroke='none'/><use xlink:href='#myrPathWhiteRefl'  fill='url(#myrGradWhiteRefl2)' stroke='none'/></g><g id='myrKeyWhitePress' ><use xlink:href='#myrPathWhitePress' fill='rgb(230,230,190)' stroke='none'  filter='url(#myrFilterDrop)'/><use xlink:href='#myrPathWhitePress'  fill='url(#myrGradWhitePress)' stroke='none'/></g><g id='myrKeyBlack'><use xlink:href='#myrPathBlack' fill='black' stroke='none'  filter='url(#myrFilterDrop)'/><use xlink:href='#myrPathBlackRefl'  fill='none' stroke-width='2' stroke='url(#myrGradBlkRefl)'/></g><g id='myrKeyBlackPress'><use xlink:href='#myrPathBlack' fill='url(#myrGradBlkPress)' stroke='none'  filter='url(#myrFilterDrop)'/><use xlink:href='#myrPathBlackReflPress'  fill='none' stroke-width='2' stroke='url(#myrGradBlkReflPressed)'/></g></defs>",MyrCtx.kbdDefaultColor=["#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA000","#FF00A0","#FFA0A0","#A0FF00","#00FFA0","#A0FFA0","#A000FF","#00A0FF","#A0A0FF","#FFFFA0","#FFA0FF","#A0FFFF"])}function MyrKbdGetStaffColor(e,t,r){return MyrBool(e.args.keyboardusenotecolor)==MyrCtx.vrai&&MyrIsDefined(r)&&MyrIsDefined(r.rgb)?"#"+((1<<24)+parseInt(r.rgb)).toString(16).slice(1):t>=0&&t<e.sync.staff.length&&MyrIsDefined(e.sync.staff[t].color)?e.sync.staff[t].color:MyrCtx.kbdDefaultColor[t%MyrCtx.kbdDefaultColor.length]}function MyrKbdCreateKey(e,t,r,o,a){var i,n,s,l;e.keyboard.tabSvgElm[t].white=o,o?(i=12.5,n=25*r,s="#myrKeyWhite",l=75):(i=6,n=25*r+19+a*i/2,s="#myrKeyBlack",l=35);var d=e.keyboard.tabSvgElm[t].key=document.createElementNS("http://www.w3.org/2000/svg","use");d.setAttribute("transform","translate("+n+",0)"),d.setAttributeNS("http://www.w3.org/1999/xlink","href",s),e.keyboard.drawDiv.childNodes[0].appendChild(d),d=e.keyboard.tabSvgElm[t].circle=document.createElementNS("http://www.w3.org/2000/svg","circle"),d.setAttribute("transform","translate("+n+",0)"),d.setAttribute("cx",i),d.setAttribute("cy",l),d.setAttribute("r",12),d.setAttribute("fill","#FF0000"),d.setAttribute("opacity","0"),MyrSetTransition(e,d,"all 0.2s ease"),e.keyboard.drawDiv.childNodes[0].appendChild(d),d=e.keyboard.tabSvgElm[t].finger=document.createElementNS("http://www.w3.org/2000/svg","text"),d.setAttribute("transform","translate("+n+",0)"),d.setAttribute("x",i),d.setAttribute("y",l+7),d.style.fontSize="20px",d.style.fontFamily="sans-serif",d.style.textAnchor="middle",d.style.fontWeight="bolder",d.setAttribute("opacity","0"),d.innerHTML=" ",e.keyboard.drawDiv.childNodes[0].appendChild(d)}function MyrKbdDraw(e){if(MyrKbdInitDrawings(),e.keyboard.div.height){var t,r,o=.9*e.keyboard.div.width,a=e.keyboard.div.height;a=90*a/100;var i=Math.floor(100*o/(25*a));i>84&&(i=84),o=i*a*25/100,MyrIsDefined(e.keyboard.drawDiv)||(e.keyboard.drawDiv=MyrCreateUndraggableElement("div",10),e.keyboard.drawDiv.style.position="absolute",MyrSetDivPos(e.keyboard.drawDiv,(e.keyboard.div.width-o)/2,e.keyboard.div.height-a),MyrSetDivSize(e.keyboard.drawDiv,o,a),e.keyboard.drawDiv.style.backgroundColor="#AAAAAA",e.keyboard.div.appendChild(e.keyboard.drawDiv)),t=MyrCtx.svgHeader+" width='"+o+"' height='"+a+"' viewBox='0 0 "+25*i+" 100'>"+MyrCtx.kbdsvg+"<svg>",r=document.createElement("div"),r.innerHTML=t,e.keyboard.drawDiv.appendChild(r.childNodes[0]),r=null,e.keyboard.tabSvgElm=[];for(var n=0,s=0;i>s;s++){e.keyboard.tabSvgElm[n]={},e.keyboard.tabSvgElm[n].pressed=!1,e.keyboard.tabSvgElm[n].white=!0,e.keyboard.tabSvgElm[n++].position=s;var l=s%7;i-1>s&&(0===l||1===l||3===l||4===l||5===l)&&(e.keyboard.tabSvgElm[n]={},e.keyboard.tabSvgElm[n].pressed=!1,e.keyboard.tabSvgElm[n].white=!1,0===l||3===l?e.keyboard.tabSvgElm[n].delta=-1:1===l||5===l?e.keyboard.tabSvgElm[n].delta=1:e.keyboard.tabSvgElm[n].delta=0,e.keyboard.tabSvgElm[n++].position=s)}for(s=e.keyboard.tabSvgElm.length-1;s>=0;s--)e.keyboard.tabSvgElm[s].white&&MyrKbdCreateKey(e,s,e.keyboard.tabSvgElm[s].position,!0);for(s=e.keyboard.tabSvgElm.length-1;s>=0;s--)e.keyboard.tabSvgElm[s].white||MyrKbdCreateKey(e,s,e.keyboard.tabSvgElm[s].position,!1,e.keyboard.tabSvgElm[s].delta);var d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d","M 0 100 L 0 10 Q 0 0 10 0 L "+(25*i-10)+" 0 q 10 0 10 10 l 0 100"),d.setAttribute("fill","none"),d.setAttribute("opacity","0.2"),d.setAttribute("stroke","#000000"),d.setAttribute("stroke-width","10"),e.keyboard.drawDiv.childNodes[0].appendChild(d),d=document.createElementNS("http://www.w3.org/2000/svg","path"),d.setAttribute("d","M -2 100 L -2 8 Q -2 -2 10 -2 L "+(25*i+2-10)+" -2 q 10 0 10 10 l 0 102"),d.setAttribute("fill","none"),d.setAttribute("opacity","0.2"),d.setAttribute("stroke","#000000"),d.setAttribute("stroke-width","8"),e.keyboard.drawDiv.childNodes[0].appendChild(d),d=e.keyboard.octavemark=document.createElementNS("http://www.w3.org/2000/svg","path"),d.setAttribute("d","M -5 100 L 5 100 L 0 95z"),d.setAttribute("fill","blue"),d.setAttribute("opacity","1"),d.setAttribute("stroke","none"),MyrIsDefined(e.keyboard.octaveshift)||(e.keyboard.octaveshift=0),d.setAttribute("transform","translate("+(7*(2+e.keyboard.octaveshift)*25+12.5)+",0)"),e.keyboard.drawDiv.childNodes[0].appendChild(d),MyrKbdTranspose(e,e.keyboard.octaveshift)}}function MyrKbdTranspose(e,t){var r=e.keyboard.tabSvgElm.length,o=r/12,a=Math.floor((o+.4)/2);e.keyboard.octaveshift=t,e.keyboard.firstkeypitch=60-12*(a-e.keyboard.octaveshift),e.keyboard.octavemark.setAttribute("transform","translate("+(7*(a+e.keyboard.octaveshift)*25+12.5)+",0)")}function MyrKbdPressKey(e,t,r,o){var a=t-e.keyboard.firstkeypitch;if(e.keyboard.div.height&&a>=0&&a<e.keyboard.tabSvgElm.length){var i=e.keyboard.tabSvgElm[a];i.pressed||(i.white===!0?i.key.setAttributeNS("http://www.w3.org/1999/xlink","href","#myrKeyWhitePress"):i.key.setAttributeNS("http://www.w3.org/1999/xlink","href","#myrKeyBlackPress"),MyrSetTransition(e,i.circle,"all 0s ease"),i.circle.setAttribute("fill",o),i.circle.setAttribute("opacity","0.7"),r>=0&&254>r&&(i.finger.innerHTML=r+1,MyrSetTransition(e,i.finger,"all 0s ease"),i.finger.setAttribute("opacity","1")),i.pressed=!0)}}function MyrKbdReleaseKey(e,t){var r=t-e.keyboard.firstkeypitch;if(e.keyboard.div.height&&r>=0&&r<e.keyboard.tabSvgElm.length){var o=e.keyboard.tabSvgElm[r];o.pressed&&(o.white===!0?o.key.setAttributeNS("http://www.w3.org/1999/xlink","href","#myrKeyWhite"):o.key.setAttributeNS("http://www.w3.org/1999/xlink","href","#myrKeyBlack"),MyrSetTransition(e,o.circle,"all 0.3s ease"),o.circle.setAttribute("opacity","0"),o.circle.setAttribute("fill","#FFFFFF"),MyrSetTransition(e,o.finger,"all 0.3s ease"),o.finger.setAttribute("opacity","0"),o.pressed=!1)}}function MyrKbdReleaseAll(e){var t;if(e.keyboard.div.height&&MyrIsDefined(e.keyboard.tabSvgElm)){t=e.keyboard.tabSvgElm.length;for(var r=0;t>r;r++)e.keyboard.tabSvgElm[r].pressed=!1;MyrKbdDraw(e)}}function MyrKbdManage(e,t){var r,o,a,i,n=e.sound.playMode.tempo;for(MyrIsDefined(n)&&0!=n||(n=1),t*=n,MyrIsDefined(e.keyboard.tabnote)||(e.keyboard.tabnote=[]),a=e.keyboard.tabnote,r=a.length-1;r>=0;r--)a[r].timeend<t&&(MyrKbdReleaseKey(e,a[r].pitch),a.splice(r,1));for(r=0;r<e.sync.staff.length;r++)if(e.sync.staff[r].onKbd&&MyrIsDefined(e.sync.staff[r].note)){for(i=e.sync.staff[r].note,o=e.sync.staff[r].curNoteIndex,MyrIsDefined(o)||(o=0);o<i.length&&i[o].timestart<=t;){var s={};s.staffindex=r,s.pitch=i[o].pitch,s.timeend=i[o].timeend-.2,a.push(s),MyrKbdPressKey(e,i[o].pitch,i[o].finger-1,MyrKbdGetStaffColor(e,r,i[o])),o++}e.sync.staff[r].curNoteIndex=o}}function MyrKbdJumpTo(e,t){var r,o,a,i,n=e.sound.playMode.tempo;for(MyrIsDefined(n)&&0!=n||(n=1),t*=n,MyrIsDefined(e.keyboard.tabnote)||(e.keyboard.tabnote=[]),a=e.keyboard.tabnote,r=a.length-1;r>=0;r--)MyrKbdReleaseKey(e,a[r].pitch);for(e.keyboard.tabnote=[],r=0;r<e.sync.staff.length;r++)if(e.sync.staff[r].curNoteIndex=0,e.sync.staff[r].onKbd&&MyrIsDefined(e.sync.staff[r].note)){for(i=e.sync.staff[r].note,o=0;o<i.length&&i[o].timestart<t;){if(i[o].timeend>t){var s={};s.staffindex=r,s.pitch=i[o].pitch,s.timeend=i[o].timeend-.2,a.push(s),MyrKbdPressKey(e,i[o].pitch,i[o].finger-1,MyrKbdGetStaffColor(e,r,i[o]))}o++}e.sync.staff[r].curNoteIndex=o}}var myrweb_version="0.2.2 Build 1 Compiled Fri Dec 22 13:35:16 2017",MyrWebVersion="0.1.2",MyrWebCopyright="(c) Myriad 2017";if(!MyrIsDefined(MyrCtx)){console.time("Init");var MyrCtx={};MyrCtx.vrai=MyrCtx["true"]=1,MyrCtx.faux=MyrCtx["false"]=0,MyrCtx.STATE_STOPPED=0,MyrCtx.STATE_PAUSED=1,MyrCtx.STATE_PLAYING=2,MyrCtx.NB_MS_POS_MUSIQUE=100,window.onload=function(){window.MyrInitAllAtOnLoad()}}var MyrSvgCloseBox="[X]";if(!MyrSoundTransform)var MyrSoundTransform={author:"Olivier Guillion",name:"Sound Transform"};if(function(){function e(e){void 0!==e.backtask&&null!==e.backtask&&e.backtask.timer>=0&&(callback(e.backtask.todolist[0],3),window.clearInterval(e.backtask.timer)),e.backtask={},e.backtask.todolist=[],e.backtask.timer=-1}function t(e,t,a,i,n,s,l){function d(e){var t,a=(new Date).getTime();if(e.backtask.todolist.length>0){var i=e.backtask.todolist[0];if(0==i.state){for(i.fftData=u(4096),i.lastPhase=u(1025),i.sumPhase=u(1025),i.inwindow=u(b),i.outwindow=u(b),i.power=u(1025),i.phase=u(1025),i.expectedDeviation=u(1025),t=0;b>t;t++)i.inwindow[t]=-.5*Math.cos(v*t/b)+.5,i.outwindow[t]=4*i.inwindow[t]/(b*x);for(t=0;1024>=t;t++)tmp=t%x/x,tmp>.5&&tmp--,i.expectedDeviation[t]=tmp;i.computedPos=0,i.state=1,i.process(i,0)}if(i.state=1){for(;i.computedPos<i.numSampsToProcess&&(new Date).getTime()-a<=r*o;)i.process(i,1);i.callback(i,1),i.computedPos>=i.numSampsToProcess&&(i.state=2)}2==i.state&&(i.process(i,2),1==e.backtask.todolist.length?(i.callback(i,3),e.backtask.todolist=[],e.backtask.timer>=0&&window.clearInterval(e.backtask.timer),e.backtask.timer=-1):(i.callback(i,2),e.backtask.todolist.splice(0,1)))}}function y(e,t){switch(t){case 0:e.numSampsToProcess=e.buffer.length,e.result=u(Math.floor(e.numSampsToProcess*e.tempoRate));break;case 1:var r,o,a,i,n;for(i=Math.floor(1024),a=Math.floor(b/x),o=b-a,m(e.buffer,e.computedPos-o,e.numSampsToProcess,b,e.fftData,e.inwindow,e.power,e.phase),r=0;i>=r;r++)n=e.phase[r]-e.lastPhase[r]-e.expectedDeviation[r],-.5>n&&n++,n>.5&&n--,e.sumPhase[r]+=(r/x+n)*v*e.tempoRate;e.lastPhase.set(e.phase),M(e.power,e.sumPhase,b,e.fftData,e.outwindow,e.result,Math.floor(e.computedPos*e.tempoRate),e.numSampsToProcess,x),e.computedPos+=a}}function c(e,t){switch(t){case 0:e.tempo>1&&(e.buffer=f(e.buffer,e.buffer.length,e.tempo)),e.numSampsToProcess=e.buffer.length,e.result=u(e.numSampsToProcess),e.synMagn=u(b),e.synPhase=u(b);break;case 1:var r,o,a,i,n,s,l,d,y;for(a=Math.floor(1024),o=Math.floor(b/x),i=v*o/b,r=b-o,m(e.buffer,e.computedPos-r,e.numSampsToProcess,b,e.fftData,e.inwindow,e.power,e.phase),e.synMagn.clear(0),e.synPhase.clear(0),n=0;a>=n;n++)if(y=n*e.pitchRate,d=Math.floor(y),a>=d){for(l=y-d,s=e.phase[n]-e.lastPhase[n]-e.expectedDeviation[n];-.5>s;)s++;for(;s>.5;)s--;s*=x,e.synPhase[d]=(y+s*e.pitchRate)*i,e.synMagn[d]+=e.power[n]}for(n=0;a>=n;n++)e.sumPhase[n]+=e.synPhase[n];e.lastPhase.set(e.phase),M(e.synMagn,e.sumPhase,b,e.fftData,e.outwindow,e.result,e.computedPos,e.numSampsToProcess,x),e.computedPos+=o;break;case 2:e.tempo<1&&(e.result=f(e.result,e.result.length,e.tempo))}}function u(e){function t(e,t,r){var o;for("undefined"==typeof t?(t=0,r=this.length):"undefined"==typeof r&&(r=this.length),o=t;r>o;o++)this[o]=e}var r=new Float32Array(e);return"undefined"==typeof r.fill?r.clear=t.bind(r):r.clear=r.fill,r}function f(e,t,r){var o,a,i,n,s=Math.floor(t/r),l=u(s);for(o=0;s>o;o++)a=o*r,i=Math.floor(a),n=a-i,l[o]=e[i]*(1-n)+e[i+1]*n;return l}function m(e,t,r,o,a,i,n,s){var l;for(a.clear(0),l=0;o>l;l++,t++)t>=0&&r>t&&(a[2*l]=e[t]*i[l]);for(p(a,-1),l=0;o/2>=l;l++)n[l]=2*Math.sqrt(a[2*l]*a[2*l]+a[2*l+1]*a[2*l+1]),s[l]=Math.atan2(a[2*l+1],a[2*l])/v}function M(e,t,r,o,a,i,n,s,l){for(k=0;k<=r/2;k++)o[2*k]=e[k]*Math.cos(t[k]),o[2*k+1]=e[k]*Math.sin(t[k]);for(o.clear(0,r+2,2*r),p(o,1),k=0;k<r;k++)k+n<s&&(i[k+n]+=a[k]*o[2*k])}function p(e,t){var r,o,a,i,n,s,l,d,y,c,u,f,m,M,p,g,v,b,x,D=e.length/2;if(f=2*D-2,M=2*D,"undefined"==typeof gLastBlocksize||gLastBlocksize!=D)for(gLastBlocksize=D,gFFTIndex1=new Uint16Array(D),gFFTIndex2=new Uint16Array(D),b=0,u=2;f>u;u+=2){for(m=2,p=0;M>m;m<<=1)u&m&&p++,p<<=1;p>u&&(gFFTIndex1[b]=u,gFFTIndex2[b]=p,b++)}for(f=gFFTIndex1.length,u=0;f>u;u++)p=gFFTIndex1[u],b=gFFTIndex2[u],i=e[b],e[b++]=e[p],e[p++]=i,i=e[b],e[b]=e[p],e[p]=i;for(x=Math.floor(Math.log(D)/Math.log(2)+.5),b=0,g=2;x>b;b++)for(v=g,g<<=1,l=1,d=0,a=h/(v>>1),r=Math.cos(a),o=t*Math.sin(a),p=0;v>p;p+=2){for(y=p,c=y+v,u=p;2*D>u;u+=g)n=e[c]*l-e[c+1]*d,s=e[c]*d+e[c+1]*l,e[c]=e[y]-n,e[c+1]=e[y+1]-s,e[y]+=n,e[y+1]+=s,y+=g,c+=g;n=l*r-d*o,d=l*o+d*r,l=n}}var g={};const h=3.141592653589793,v=2*h,b=2048;var x=4;g.buffer=t,g.tempo=i,g.detune=a,g.identifier=s,g.callback=l,0==a&&1==i?(g.data=u(t.length),g.data.set(t),g.isLast=0==e.backtask.todolist.length,l(g,3)):(.75>i?x=5:i>1.2&&(x=3),g.state=0,g.numSampsToProcess=1,g.computedPos=0,e.backtask.todolist.push(g),n?(g.sampleRateModifier=Math.pow(1.0005777895065548,a),g.tempoRate=g.sampleRateModifier/i,g.process=y):(g.sampleRateModifier=1,g.pitchRate=Math.pow(1.0005777895065548,a)/i,g.process=c),l(g,0),e.backtask.timer<0&&(d(e),g.state<2&&(e.backtask.timer=window.setInterval(function(){d(e)},r))))}var r=500,o=.8;MyrSoundTransform.Do=t,MyrSoundTransform.Stop=e}(),!MyrSvgToPdf)var MyrSvgToPdf={author:"Didier Guillion",name:"SVG to PDF Converter"};!function(){function e(e){alert("SVGtoPDF error :"+e)}function t(e,t,r,o,a){e.left=t,e.top=r,e.right=o,e.bottom=a}function o(t){e(t)}function a(e){var t="";return e.posData<e.data.length&&(t=e.data.substring(e.posData,e.posData+1)),t}function i(e){var t=a(e);return t.length>0&&e.posData++,t}function n(e){return e.search(/[0-9A-Za-z\-_\.]/)>=0}function s(e){return" "==e||"	"==e}function l(e){return'"'==e||":"==e||","==e||")"==e||"("==e||"'"==e||"<"==e||s(e)}function d(e,t){return'"'==e?t==e:"'"==e?t==e:":"==e?";"==t:" "==t?!0:l(t)}function y(e){var t,r="";if(r=i(e),""===r)return r;for(;r.length>0&&"<"!=r;)r=i(e);for(t=e.posData-1,r=i(e);r.length>0&&">"!=r;)r=i(e);return e.data.substring(t,e.posData)}function c(e){var t,r="",o=0;for(">"==a(e)&&e.posData++,t=e.posData,r=i(e);r.length>0&&"<"!=r;)r=i(e),o++;return e.data.substring(t,t+o)}function u(e,t){var r,o,a,i="";if(e.length>0)do{if(r=e.search(t),r>=0&&(0===r||!n(e.substring(r-1,r))&&!n(e.substring(r+t.length,r+t.length+1)))){for(r+=t.length;r<e.length&&(s(e.substring(r,r+1))||!l(e.substring(r,r+1)));)r++;if(r<e.length){for(o=e.substring(r,r+1),r++,a=r;r<e.length&&d(o,e.substring(r,r+1))===!1;)r++;return i=e.substring(a,r)}}e=e.substring(r+1)}while(r>=0);return""}function f(e,t){return u(e,t)}function m(e,t){var r=f(e,t);return 0===r.length&&(r="0"),atof(r)}function M(e,t){return m(e,t)}function p(e,t){return e.toLowerCase().substring(0,t.length)==t.toLowerCase()}function g(e,t){var r={};for(r.nbargs=0,r.args=[],r.cmd="",r.pos=t;t<e.length&&l(e.slice(t,t+1));)t++;for(;t<e.length&&!l(e.slice(t,t+1));)r.cmd+=e.slice(t,t+1),t++;for(;t<e.length&&"("!=e.slice(t,t+1);){if(!l(e.slice(t,t+1)))return r.pos=t,r;t++}for(;t<e.length&&")"!=e.slice(t,t+1)&&r.nbargs<6;){for(var o="";t<e.length&&l(e.slice(t,t+1));)t++;for(;t<e.length&&")"!=e.slice(t,t+1)&&!l(e.slice(t,t+1));)o+=e.slice(t,t+1),t++;r.args[r.nbargs]=atof(o),r.nbargs++}return r.pos=t,r}function h(e,t,r,o){MyrPDF.PDFStrokeColor(e,t,o),MyrPDF.PDFFillColor(e,r,o)}function v(e,t,r,o,a,i,n,s,l){s===!1&&(MyrPDF.PDFOpacity(e,t),MyrPDF.PDFLineWidth(e,i),h(e,r,o,l),MyrPDF.PDFLineCap(e,a))}function b(e,t,r,o,a,i,n,s,l,d){var y={};y.left=Math.min(t,o)-d/2,y.top=Math.min(r,a)-d/2,y.right=Math.max(t,o)+d/2,y.bottom=Math.max(r,a)+d/2,v(e,i,n,s,l,d,"",!1,y),MyrPDF.PDFMoveTo(e,t,r),
MyrPDF.PDFLineTo(e,o,a),MyrPDF.PDFStroke(e)}function x(e){for(var t="";" ">t&&e.pos<e.datalength;)t=e.data.substring(e.pos,e.pos+1),e.pos++;return t}function D(e){var t,r,o,a=0;for(t=x(e);" "==t;)t=x(e);for(r=e.pos-1,t=x(e);t>="0"&&"9">=t||"."==t||"-"==t;)t=x(e);return o=e.data.substring(r,e.pos),l(t)===!1&&e.pos<e.datalength&&e.pos--,a=parseFloat(o),H>0&&console.log("GetValPath :"+a),a}function P(e,t,r,o){var a=""!==r&&"none"!=r,i=""!==t&&"none"!=t;(o||a||i)&&MyrPDF.PDFComment(e,"SVGDrawPath "),o?(MyrPDF.PDFClip(e),MyrPDF.PDFEndPathNoPaint(e)):a&&i?MyrPDF.PDFFillAndStroke(e):a?MyrPDF.PDFFill(e):i&&MyrPDF.PDFStroke(e)}function k(e,t,r,o,a,i,n,s,l,d){var y={};y.left=t,y.top=r,y.right=t+o,y.bottom=r+a,v(e,i,n,s,"",l,"",d,y),MyrPDF.PDFRect(e,t,r,o,a),P(e,n,s,d)}function w(e,t,r,o,a,i,n,s,l,d){var y={};y.left=t-o,y.top=r-a,y.right=t+o,y.bottom=r+a,v(e,i,n,s,"",l,"",d,y),MyrPDF.PDFEllipse(e,t,r,o,a),P(e,n,s,d)}function F(e,t,r){var o,a,i="";return a=strexist(e,"Times")?"Times-Roman":strexist(e,"Courier")?"Courier":strexist(e,"Helvetica")?"Helvetica":e,o=MyrPDFDict.PDFSearchEntry(MyrPDF.PDFdictFonts,a),0>o?(MyrPDF.PDFComment(null,"######################## FONT ["+a+"]########################"),MyrPDF.PDFAddFont(a,a,t,r),i=a):i=MyrPDF.PDFdictFonts[o].data,i}function C(e){for(var t="",r=0;r<e.length;){if("&"===e.substring(r,r+1)&&"#"===e.substring(r+1,r+2)&&"x"===e.substring(r+2,r+3)){var o;for(r+=3,o=parseInt(e.substring(r),16),t+=o;r<e.length&&";"!=e.substring(r,r+1);)r++}else t+=e.substring(r,r+1);r++}return t=UnicodeToMacRoman(t)}function S(e,t,r,o,a,i,n,s,l,d,y,c,u){var f,m=C(u),M=[];f=F(o,"Type1","/Encoding /MacRomanEncoding"),MyrPDF.PDFComment(e,"SVGDrawText "+t+" "+r+" "+o+" "+i+" "+u),MyrPDF.PDFStartTextObject(e),MyrPDF.PDFTextFontNameAndSize(e,f,i),PMatrixIdentity(e,M),PMatrixTranslate(e,t,r,M),MyrPDF.PDFMatrixWrite(e,M),MyrPDF.PDFTextMoveTo(e,0,0),PMatrixIdentity(e,M),PMatrixRotate(e,d,y,c,M),a.length&&!strcmp(a,"italic")&&PMatrixSkewX(e,-10,M),MyrPDF.PDFMatrixWrite(e,M),h(e,s,l,null),MyrPDF.PDFTextShow(e,m),MyrPDF.PDFEndTextObject(e)}function T(t,r,o,a,i,n,s,l,d,y){var c,u,f,m,M,p,g,h=0,b=0,k=!0,w=!0,F={},C=!1;for(F.data=r,F.datalength=r.length,F.pos=0;F.pos<F.datalength&&k;){switch(g=x(F),H>0&&console.log("SVGCvtPath :"+g),g){case" ":break;case"M":c=D(F),u=D(F),MyrPDF.PDFMoveTo(t,c,u),h=c,b=u;break;case"m":c=D(F),u=D(F),MyrPDF.PDFMoveRel(t,c,u),h+=c,b+=u;break;case"L":c=D(F),u=D(F),MyrPDF.PDFLineTo(t,c,u),h=c,b=u;break;case"l":c=D(F),u=D(F),MyrPDF.PDFLineRel(t,c,u),h+=c,b+=u;break;case"C":c=D(F),u=D(F),f=D(F),m=D(F),M=D(F),p=D(F),MyrPDF.PDFCurve(t,c,u,f,m,M,p),h=M,b=p;break;case"c":c=D(F),u=D(F),f=D(F),m=D(F),M=D(F),p=D(F),MyrPDF.PDFCurveRel(t,c,u,f,m,M,p),h+=M,b+=p;break;case"Q":c=D(F),u=D(F),f=D(F),m=D(F),MyrPDF.PDFCurve(t,h+.6666*(c-h),b+.6666*(u-b),f+.6666*(c-f),m+.6666*(u-m),f,m),h=f,b=m;break;case"q":c=D(F),u=D(F),f=D(F),m=D(F),c+=h,u+=b,f+=h,m+=b,MyrPDF.PDFCurve(t,h+.6666*(c-h),b+.6666*(u-b),f+.6666*(c-f),m+.6666*(u-m),f,m),h=f,b=m;break;case"Z":case"z":MyrPDF.PDFClosePath(t),C=!0;break;default:e("Command ["+g+"] unknow in path"),k=!1}w&&(w=!1,v(t,o,a,i,n,s,l,d,y))}P(t,a,i,d)}function I(e){var t,r={};return r.data="",MyrPDF.PDFClearBBox(),T(r,e,1,"","","","","",null),t=MyrPDF.PDFGetBBox()}function A(e,t,r,o,a){var i,n,s,l,d,y=u(t,"xlink:href"),c=!0,f={};if(y.length>0){for(i=y;"#"===i.substring(0,1);)i=i.substring(1);n=MyrPDFDict.PDFSearchEntry(MyrPDF.PDFdictPaths,i),n>=0?(""===o&&(o=u(t,"stroke")),""===a&&(a=u(t,"fill")),MyrPDF.PDFPushContext(e),v(e,"",o,a,"","","",!1,""),s=m(t,"x"),l=m(t,"y"),PMatrixIdentity(e,f),PMatrixTranslate(e,s,l,f),MyrPDF.PDFMatrixWrite(e,f),d=u(t,"transform"),d.length>0&&L(e,d),MyrPDF.PDFWriteDo(e,i),o.length>0&&"none"===a&&MyrPDF.PDFStroke(e),MyrPDF.PDFPopContext(e)):c=!1}return c}function L(e,t){var r,o=0,a=[];if(t.length>0){for(PMatrixIdentity(e,a);o<t.length;)if(r=g(t,o),o=r.pos,r.cmd.length>0&&r.nbargs>0)if(strcasecmp(r.cmd,"translate"))if(strcasecmp(r.cmd,"scale"))if(strcasecmp(r.cmd,"rotate"))if(strcasecmp(r.cmd,"skewx"))if(strcasecmp(r.cmd,"skewy")){if(!strcasecmp(r.cmd,"matrix")){if(r.nbargs<6)for(;r.nbargs<6;r.nbargs++)r.args[nbargs]=0;PMatrixMult(e,a,r.args,a)}}else PMatrixSkewY(e,r.args[0],a);else PMatrixSkewX(e,r.args[0],a);else 1==r.nbargs&&(r.args[1]=r.args[2]=0),PMatrixRotate(e,r.args[0],r.args[1],r.args[2],a);else 1==r.nbargs&&(r.args[1]=r.args[0]),PMatrixScale(e,r.args[0],r.args[1],a);else 1==r.nbargs&&(r.args[1]=0),PMatrixTranslate(e,r.args[0],r.args[1],a);MyrPDF.PDFMatrixWrite(e,a)}}function G(e,t){var r,o="",a=0;if(t.length>0){for(;a<t.length;)r=g(t,a),a=r.pos,strcasecmp(r.cmd,"skewx")&&strcasecmp(r.cmd,"skewy")?strcasecmp(r.cmd,"translate")?strcasecmp(r.cmd,"scale")?strcasecmp(r.cmd,"rotate")||(1==r.nbargs&&(r.args[1]=r.args[2]=0),o=r.cmd+"("+-r.args[0]+","+r.args[1]+","+r.args[2]+") "+o):(1==r.nbargs&&(r.args[1]=r.args[0]),o=r.cmd+"("+1/r.args[0]+","+1/r.args[1]+") "+o):(1==r.nbargs&&(r.args[1]=r.args[0]),o=r.cmd+"("+-r.args[0]+","+-r.args[1]+") "+o):o=r.cmd+"("+-r.args[0]+") "+o;L(e,o)}}function E(t,r,o,a,i){var n,s,l;if(MyrPDF.PDFPushContext(t),n=u(r,"transform"),n.length>0)L(t,n);else if(o.length>0&&(s=u(o,"clip-path"),s&&(l=u(s,"url"),l.length>0))){var d;if(d=MyrPDFDict.PDFGetDataFromId(MyrPDF.PDFdictClip,l.slice(1)),d.length>0){var y={},c={};y.data=d,y.posData=0,c=O(y,a,i,!0,!1),c.data.length&&MyrPDF.PDFWriteNoRc(t,c.data)}else e("SVGDoG : entry "+l.slice(1)+" not found in dictionary for clipping.")}return!0}function _(e,t,r,a,i,n){var s,l,d,y,c,f,m=u(t,"xlink:href"),M=64738;if(m.length>0&&(y=t.indexOf("base64,"),y>=0)){if(s=t.substring(y+7),c=s.indexOf("'"),0>c&&(c=s.indexOf('"')),c>=0&&(s=s.substring(0,c)),d=atob(s),MyrPDF.PDFComment(null,"######################## IMAGE ########################"),f=PNGDecode(d),f.data.length>0){if(M=MyrPDF.PDFAddPosObject(),f.colorType==PNG_COLOR_TYPE_TRUECOLOR||f.colorType==PNG_COLOR_TYPE_TRUECOLOR_ALPHA){var p,g;if(p=MyrLZ77.inflate(f.data,2),p.length>0)if(g=PNGDecodeIDAT(p,f.aire.right,f.aire.bottom,f.colorType),g.length>0)if(f.colorType==PNG_COLOR_TYPE_TRUECOLOR_ALPHA){var h;h=PNGSplitRGBandAlpha(g,f.aire.right,f.aire.bottom),MyrPDF.PDFWriteStreamImageAndFreeSource(null,h.rgbdata,f.aire.right,f.aire.bottom,!0,M+1),MyrPDF.PDFEndPosObject(),MyrPDF.PDFAddPosObject(),MyrPDF.PDFWriteStreamImageAndFreeSource(null,h.maskdata,f.aire.right,f.aire.bottom,!1,0)}else g=MyrPNG.CvtUint8toString(g),MyrPDF.PDFWriteStreamImageAndFreeSource(null,g,f.aire.right,f.aire.bottom,!0,0);else o("PNG error: decoding error, the file is corrupted.");else o("PNG error: can't unzip data chunk")}else o("PNG error: PNG color format not managed");MyrPDF.PDFEndPosObject()}else o("PNG error: not a valid PNG file : "+messErr);var v,b;v=i/f.aire.right,b=n/f.aire.bottom,v=b=Math.min(v,b);var x,D;x=r+i/2,D=a+n/2,i=f.aire.right*v,n=f.aire.bottom*b,r=x-i/2,a=D-n/2,MyrPDF.PDFWriteImage(e,M,l,r,a,i,n)}}function z(e,t,r,o,a,i,n,s,l,d){var y,c=u(t,"id"),f=null;if(c.length>0&&d===!0){var m,M,p={},g={};MyrPDF.PDFClearBBox(),p.data=t,p.posData=0,g=O(p,o,a,!1,!1),MyrPDF.PDFComment(null,"######################## PATH ["+c+"]########################"),m=MyrPDF.PDFAddPosObject(),y=MyrPDF.PDFWriteForm(null,g.data),MyrPDF.PDFEndPosObject(),f=MyrPDF.PDFGetBBox(f),M=f.left+" "+f.top+" "+f.right+" "+f.bottom,MyrPDFDict.PDFAddEntry(MyrPDF.PDFdictPaths,c,M,m,y)}else{var h=u(t,"d");h.length>0&&((strexist(a,"url(")||strexist(o,"url("))&&(f=I(h)),T(e,h,r,o,a,i,n,s,l,f))}return!0}function R(e,t,r,o,a){var i,n,s,l,d=u(r,"id"),c=!0,f="",M="";if(d.length>0&&a===!0){for(;""!==r&&c===!0;)if(console.log(r),p(r,"</linearGradient"))c=!1;else{if(p(r,"<linearGradient")&&(i=m(r,"x1"),n=m(r,"y1"),s=m(r,"x2"),l=m(r,"y2")),p(r,"<stop")){var g=m(r,"offset");0===g?f=u(r,"style"):M=u(r,"style")}r=y(e)}if(f.length>0&&M.length>0){var h;h=s>0?"horiz":"vert",MyrPDFDict.PDFAddEntry(MyrPDF.PDFdictSVGGradients,d,h,f,M)}}return r.length>0}function N(e){var r=0,o={};if(e=e.match("<svg.*>")){if(e=e[0],r=m(e,"width"),height=m(e,"height"),0>=r||height<=0){var a=/viewBox\s*=\s*\"\s*([\-\+0-9\.]+)[,\s]+([\-\+0-9\.]+)[,\s]+([\-\+0-9\.]+)[,\s]+([\-\+0-9\.]+)\s*\"/,i=e.match(a),n=i[1],s=i[2],l=i[3],d=i[4];r=l-n,height=d-s}t(o,0,0,r,height)}return o}function O(r,o,a,i,n){var s,l,d,f,g=!0,v=0,x={},D="",P="",F="",C={},T="",I="",O="",B="",U="",H="";for(C.data="",t(x,0,0,0,0),s=y(r);""!==s&&g===!0;){if(W>0&&console.log("["+s+"]"),p(s,"<svg")===!0){var Q={};Q=N(s),l=Q.right/j,x.right=j,x.bottom=Q.bottom,K.right=j,K.bottom=x.bottom}else if(p(s,"</svg")===!0)g=!1;else if(p(s,"<clipPath"))P="",n&&(P=u(s,"id"));else if(p(s,"</clipPath"))P.length>0&&(D.length>0&&(MyrPDFDict.PDFAddEntry(MyrPDF.PDFdictClip,P,D,0,0),D=""),P="");else if(P.length>0)D+=s;else{var Y;if(Y=u(s,"stroke"),Y.length>0&&(B=Y),Y=u(s,"fill"),Y.length>0&&(U=Y),Y=u(s,"opacity"),Y.length>0&&(H=Y),Y=u(s,"stroke-width"),Y.length>0&&(I=Y),Y=u(s,"stroke-linecap"),Y.length>0&&(T=Y),Y=u(s,"stroke-linejoin"),Y.length>0&&(O=Y),F=u(s,"style"),F.length>0&&(Y=u(F,"stroke"),Y.length>0&&(B=Y),Y=u(F,"fill"),Y.length>0&&(U=Y),Y=u(F,"opacity"),Y.length>0&&(H=Y),Y=u(F,"stroke-width"),Y.length>0&&(I=Y),Y=u(F,"stroke-linecap"),Y.length>0&&(T=Y),Y=u(F,"stroke-linejoin"),Y.length>0&&(O=Y)),p(s,"<linearGradient"))g=R(r,C,s,i,n);else if(p(s,"<line"))b(C,m(s,"x1"),m(s,"y1"),m(s,"x2"),m(s,"y2"),H,B?B:o,U?U:a,T,I);else if(p(s,"<text")){var X=c(r);if(X.length>0){var Z=u(F,"font-family"),J=u(s,"font-style"),q=u(s,"transform"),ee=0,te=0,re=0;if(d=m(s,"x"),f=m(s,"y"),q.length>0){var oe=q.search("rotate");if(oe>=0)for(;"("!=q.substring(oe,oe+1);)oe++}U=u(s,"fill"),B=u(s,"stroke"),S(C,d,f,Z,J,M(F,"font-size"),H,B?B:o,U?U:a,ee,te,re,X)}}else if(p(s,"<path"))z(C,s,H,B?B:o,U?U:a,T,I,O,i,n);else if(p(s,"<rect")){var ae,ie;L(C,u(s,"transform")),d=m(s,"x"),f=m(s,"y"),ae=m(s,"width"),ie=m(s,"height"),k(C,d,f,ae,ie,H,B?B:o,U?U:a,I,i),G(C,u(s,"transform"))}else p(s,"<ellipse")?w(C,m(s,"cx"),m(s,"cy"),m(s,"rx"),m(s,"ry"),H,B?B:o,U?U:a,I,i):p(s,"<image")?_(C,s,m(s,"x"),m(s,"y"),m(s,"width"),m(s,"height")):p(s,"<use")?A(C,s,F,B,U):p(s,"<g")?(E(C,s,F,B,U),B=u(s,"stroke"),U=u(s,"fill"),h(C,B,U,null)):p(s,"</g")&&MyrPDF.PDFPopContext(C)}if(s.indexOf($)>=0){var ne=s.indexOf($)+$.length;t(x,3e5,3e5,-3e5,-3e5),x.left=parseInt(s.substring(ne)),s=s.substring(ne+1),ne=s.indexOf(" "),x.top=parseInt(s.substring(ne)),s=s.substring(ne+1),ne=s.indexOf(" "),x.right=parseInt(s.substring(ne)),s=s.substring(ne+1),ne=s.indexOf(" "),x.bottom=parseInt(s.substring(ne)),s=s.substring(ne+1),ne=s.indexOf(" "),(x.left>=x.right||x.top>=x.bottom)&&(e("SVG Encoding error on MyriadPageStartpage "+v+"/"+l),g=!1),MyrPDF.PDFSetOffset(-x.left,-x.top),t(K,0,0,x.right-x.left,x.bottom-x.top),MyrPDF.PDFOpenPage(K),v++}else s.indexOf(V)>=0&&(MyrPDF.PDFClosePage(MyrPDF.PDFWritePageContent(C,K)),C.data="");s=y(r)}return MyrPDF.PDFFill(C),C}function B(e,t,o,a){var i=0;0===t&&(t=Math.floor(o/j));var n=o/t;if(strexist(e,$)===!1){var s=new RegExp("<!-- *"+Q+".+>");if(e.search(s)>=0)for(e=e.replace(s,"<!-- MyriadPageStart "+n*i+" 0 "+n*(i+1)+" "+r.bottom+" -->\n"),i++;e.search(s)>=0;)e=e.replace(s,"<!-- MyriadPageEnd-->\n<!-- MyriadPageStart "+n*i+" 0 "+n*(i+1)+" "+r.bottom+" -->\n"),i++;else{s=/<clipPath\s+id=[\"\']([^\"\']*)[\"\']\s*><rect\s+x=[\"\']([^\"\']*)[\"\'].*<\/clipPath>/gi;for(var l=[],d=s.exec(e);null!==d;){var y=Math.floor(d[2]/n);void 0!==l[y]&&null!==l[y]||(l[y]=d[1]),d=s.exec(e)}e=e.replace(/<\/defs>/i,"</defs>\n<!-- MyriadPageStart 0 0 "+n+" "+r.bottom+" -->");for(var c=1;c<l.length;c++)s=new RegExp("(<g .*url\\(#"+l[c]+".*>)","i"),e=e.replace(s,"<!-- MyriadPageEnd-->\n<!-- MyriadPageStart "+n*c+" 0 "+n*(c+1)+" "+r.bottom+" -->\n$1")}e=e.replace("</svg>","<!-- MyriadPageEnd-->\n</svg>")}return e}function U(e,t,o){var a,i,n,s={},l={},d=(new Date).getTime(),y="";if("string"==typeof e)y=e;else{for(i=0,n=e.length;n>i;i++)y+=String.fromCharCode(e[i]);e=null}if(j=1e3,(void 0===t||null===t||1>t)&&(t=0),r=N(y),r.right>0&&(y=B(y,t,r.right,r.bottom)),void 0!==o&&null!==o){void 0!==o[0]&&null!==o[0]&&(y=y.replace("</defs>",o[0]+"</defs>")),i=1;var c=new RegExp("(<!-- MyriadPageStart.* -->)","g");y=y.replace(c,function(e){return void 0!==o[i]&&null!==o[i]?e+"\n<g transform='translate("+j*(i-1)+" 0)' >\n"+o[i++]+"</g>":(i++,e)})}for(MyrPDF.PDFInit(),s.data=y,s.posData=0,l=O(s,"","",!1,!0),y=null,s.data=null,s=null,a=MyrPDF.PDFValidate(l),l=null,MyrPDF.PDFDispose(),console.log("Conversion done in "+((new Date).getTime()-d)/1e3+" seconds"),buff=new Uint8Array(a.length),i=0,n=a.length;n>i;i++)buff[i]=a.charCodeAt(i);return a=null,buff[10]=128,buff[11]=129,buff[12]=130,buff[13]=131,buff}var H=0,W=0,j=1e3,K={};const $="MyriadPageStart",V="MyriadPageEnd";var Q="!!Myriad Page ";MyrSvgToPdf.DoConvertSVGtoPDF=U,MyrSvgToPdf.SetBigRect=t}(),DoConvertSVGtoPDF=MyrSvgToPdf.DoConvertSVGtoPDF,SetBigRect=MyrSvgToPdf.SetBigRect;var PDF_MATRIX_VERBOSE=0;if(!MyrPDFMatrix)var MyrPDFMatrix={author:"Didier Guillion",name:"Matrix"};if(function(){function e(e,t,r){if(PDF_MATRIX_VERBOSE>0){var o=t+" "+r[0]+" "+r[1]+" "+r[2]+" "+r[3]+" "+r[4]+" "+r[5];console.log(o)}}function t(e,t){var r;for(r=0;6>r;r++)t[r]=e[r]}function r(t,r,o,a,i,n,s,l){l[0]=r,l[1]=o,l[2]=a,l[3]=i,l[4]=n,l[5]=s,e(t,"PMatrixSet",l)}function o(r,o,a,i){var n=[];e(r,"PMatrixMult",o),e(r,"x",a),n[0]=o[0]*a[0]+o[2]*a[1],n[2]=o[0]*a[2]+o[2]*a[3],n[4]=o[0]*a[4]+o[2]*a[5]+o[4],n[1]=o[1]*a[0]+o[3]*a[1],n[3]=o[1]*a[2]+o[3]*a[3],n[5]=o[1]*a[4]+o[3]*a[5]+o[5],t(n,i),e(r,"=",i)}function a(e,t){r(e,1,0,0,1,0,0,t)}function i(e,t,a,i){var n=[];r(e,1,0,0,1,t,a,n),o(e,i,n,i)}function n(e,t,a,i){var n=[];r(e,t,0,0,a,0,0,n),o(e,i,n,i)}function s(e,t,a,n,s){var l=[];t=3.141592653525*t/180,(a||n)&&i(e,a,n,s),r(e,Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0,l),o(e,s,l,s),(a||n)&&i(e,-a,-n,s)}function l(e,t,a){var i=[];t=3.141592653525*t/180,r(e,1,0,Math.tan(t),1,0,0,i),o(e,a,i,a)}function d(e,t,a){var i=[];t=3.141592653525*t/180,r(e,1,tan(t),0,1,0,0,i),o(e,a,i,a)}MyrPDFMatrix.PMatrixDump=e,MyrPDFMatrix.PMatrixCopy=t,MyrPDFMatrix.PMatrixSet=r,MyrPDFMatrix.PMatrixMult=o,MyrPDFMatrix.PMatrixIdentity=a,MyrPDFMatrix.PMatrixTranslate=i,MyrPDFMatrix.PMatrixScale=n,MyrPDFMatrix.PMatrixRotate=s,MyrPDFMatrix.PMatrixSkewX=l,MyrPDFMatrix.PMatrixSkewY=d}(),PMatrixDump=MyrPDFMatrix.PMatrixDump,PMatrixCopy=MyrPDFMatrix.PMatrixCopy,PMatrixSet=MyrPDFMatrix.PMatrixSet,PMatrixMult=MyrPDFMatrix.PMatrixMult,PMatrixIdentity=MyrPDFMatrix.PMatrixIdentity,PMatrixTranslate=MyrPDFMatrix.PMatrixTranslate,PMatrixScale=MyrPDFMatrix.PMatrixScale,PMatrixRotate=MyrPDFMatrix.PMatrixRotate,PMatrixSkewX=MyrPDFMatrix.PMatrixSkewX,PMatrixSkewY=MyrPDFMatrix.PMatrixSkewY,!MyrPDFDict)var MyrPDFDict={author:"Didier Guillion",name:"Dictionnaries"};if(function(){function e(e){return e.length}function t(t,r){var o,a=e(t);for(o=0;a>o;o++)d(r,t[o].id,t[o].data,t[o].val1,t[o].val2)}function r(t){var r,o=e(t);for(console.log("Dumping array "+o+" items."),r=0;o>r;r++)console.log(r+" "+t[r].id+" "+t[r].data+" "+t[r].val1+" "+t[r].val2)}function o(e){e.splice(0)}function a(e){e.sort(function(e,t){return e.id>t.id})}function i(t){var r=e(t);return r}function n(t,r){var o,a=e(t);for(o=0;a>o;o++)if(t[o].id===r)return o;return-1}function s(t,r){var o,a=e(t);for(o=0;a>o;o++)if(t[o].data===r)return o;return-1}function l(e,t){var r=n(e,t);return r>=0?e[r].data:""}function d(e,t,r,o,a){var s=n(e,t);0>s&&(s=i(e)),e[s]={id:t,data:r,val1:o,val2:a}}MyrPDFDict.PDFNbEntryDict=e,MyrPDFDict.PDFAddDict=t,MyrPDFDict.PDFDumpDict=r,MyrPDFDict.PDFDisposeDict=o,MyrPDFDict.PDFSortDictById=a,MyrPDFDict.PDFNewEntry=i,MyrPDFDict.PDFSearchEntry=n,MyrPDFDict.PDFSearchDataEntry=s,MyrPDFDict.PDFGetDataFromId=l,MyrPDFDict.PDFAddEntry=d}(),!MyrPDF)var MyrPDF={author:"Didier Guillion",name:"PDF file format"};if(function(){function e(e){var t={};return t.red=parseInt(e.substring(0,2),16),t.green=parseInt(e.substring(2,4),16),t.blue=parseInt(e.substring(4,6),16),t}function t(){Ue.left=Ue.top=9999999,Ue.right=Ue.bottom=-9999999}function r(e,t){e<Ue.left&&(Ue.left=e),e>Ue.right&&(Ue.right=e),t<Ue.top&&(Ue.top=t),t>Ue.bottom&&(Ue.bottom=t)}function o(){return Ue}function a(e,t){ze=e,Re=t}function n(e){return null===e&&(e=Xe),e}function s(e,t){var r=n(e);r.data+=t,Fe>0&&console.log(t)}function l(e,t){s(e,t+"\n")}function d(e,t){we>0&&l(e,"% "+t)}function y(e){d(e,"PDFPushContext level "+Be),Be++,b(Je,Ze),l(e,"q")}function c(e){--Be,d(e,"PDFPopContext level "+Be),Ze=x(Je),l(e,"Q")}function u(e,t,r){var o=t.toString(),a=o.indexOf(".");a>0&&(o=o.substring(0,a+r+1)),s(e,o+" ")}function f(e,t){u(e,t,2)}function m(){return l(null,++Ne+" 0 obj"),Ne}function M(){l(null,"endobj"),l(null,"")}function p(e){return n(e).data.length}function g(e,t){var r=n(t);r.data+=e}function h(e,t){l(e,"stream"),g(t,e),l(e,""),l(e,"endstream")}function v(t,r,o,a){var i={};return null!==r&&"none"!=r&&r.length>5?("#"==r.substring(0,1)&&(r=r.substring(1)),"url"==r.substring(0,3)?(I(t,r,o,a),!1):(strexist(r,"rgb(")?(r=r.substring(r.indexOf("(")+1),i.red=atof(r),r=r.substring(r.indexOf(",")+1),i.green=atof(r),r=r.substring(r.indexOf(",")+1),i.blue=atof(r)):i=e(r),isNaN(i.red)&&(i.red=0),isNaN(i.green)&&(i.green=0),isNaN(i.blue)&&(i.blue=0),f(t,i.red/255),f(t,i.green/255),f(t,i.blue/255),!0)):!1}function b(e,t){for(var r=[],o=0;6>o;o++)r[o]=t[o];e.push(r)}function x(e){for(var t=[],r=0;6>r;r++)t[r]=e[e.length-1][r];return e.pop(),t}function D(e,t){var r,o,a,i=[],n=[],s=[],l=[];for(r=0;3>r;r++)n[r]=[],s[r]=[],l[r]=[];for(a=0,r=0;3>r;r++)for(o=0;2>o;o++)n[o][r]=e[a],s[o][r]=t[a],a++;for(n[2][0]=n[2][1]=s[2][0]=s[2][1]=0,n[2][2]=s[2][2]=1,r=0;3>r;r++)for(o=0;3>o;o++)for(l[r][o]=0,a=0;3>a;a++)l[r][o]+=n[r][a]*s[a][o];return i[0]=l[0][0],i[1]=l[1][0],i[2]=l[0][1],i[3]=l[1][1],i[4]=l[0][2],i[5]=l[1][2],i}function P(e,t){d(e,"PDFMatrixWrite data"),u(e,t[0],4),u(e,t[1],4),u(e,t[2],4),u(e,t[3],4),f(e,t[4]),f(e,t[5]),l(e,"cm"),Ze=D(Ze,t)}function k(e,t,o){d(e,"PDFMoveTo "+t+" "+o),f(e,t),f(e,o),l(e,"m"),Ee=t,_e=o,r(t,o)}function w(e,t,o){d(e,"PDFMoveRel "+t+" "+o),Ee+=t,_e+=o,f(e,Ee),f(e,_e),l(e,"m"),r(Ee,_e)}function F(e,t,o){d(e,"PDFLineTo "+t+" "+o),f(e,t),f(e,o),l(e,"l"),Ee=t,_e=o,r(t,o)}function C(e,t,o){d(e,"PDFLineRel "+t+" "+o),Ee+=t,_e+=o,f(e,Ee),f(e,_e),l(e,"l"),r(Ee,_e)}function S(e,t,r){v(e,t,r,!1)&&(d(e,"PDFStrokeColor "+t),l(e,"RG"))}function T(e,t,r,o,a,i,n){var s,d,y;return"vert"==r?i.left=i.right:i.top=i.bottom,MyrPDF.PDFComment(null,"######################## Gradient ["+t+"]########################"),s=MyrPDF.PDFAddPosObject(),l(e," << "),l(e," /FunctionType 2"),l(e,"/Domain [0.0 1.0]"),l(e,"/N 1"),l(e,"/C0 ["),v(e,o,"",n),l(e,"]"),l(e,"/C1 ["),v(e,a,""),l(e,"]"),l(e," >>"),MyrPDF.PDFEndPosObject(),d=MyrPDF.PDFAddPosObject(),l(e," <<"),l(e,"/ShadingType 2"),l(e,"/ColorSpace /DeviceRGB"),l(e,"/Function "+s+" 0 R"),l(e,"/Coords ["+i.left+" "+i.top+" "+i.right+" "+i.bottom+"]"),l(e,"/Extend [true true]"),l(e," >>"),MyrPDF.PDFEndPosObject(),y=MyrPDF.PDFAddPosObject(),l(e," <<"),l(e,"/Type /Pattern"),l(e,"/PatternType 2"),l(e,"/Shading "+d+" 0 R"),l(e,"/Matrix [ "+Ze[0]+" "+Ze[1]+" "+Ze[2]+" "+Ze[3]+" "+Ze[4]+" "+Ze[5]+" ]"),l(e," >>"),MyrPDF.PDFEndPosObject(),y}function I(e,t,r,o){var a;if(t=t.substring(t.indexOf("#")+1,t.indexOf(")")),d(e,"PDFStrokeGradient "+t),a=MyrPDFDict.PDFSearchEntry(MyrPDF.PDFdictSVGGradients,t),a>=0){var i;id=T(null,t,MyrPDF.PDFdictSVGGradients[a].data,MyrPDF.PDFdictSVGGradients[a].val1,MyrPDF.PDFdictSVGGradients[a].val2,r,o),i="Gradient_"+t+"_"+id,o?l(e,"/Pattern cs"):l(e,"/Pattern CS"),d(e,"Current Matrix: ["+Ze[0]+" "+Ze[1]+" "+Ze[2]+" "+Ze[3]+" "+Ze[4]+" "+Ze[5]+"]"),o?l(e,"/"+i+" scn"):l(e,"/"+i+" SCN"),MyrPDFDict.PDFAddEntry(MyrPDF.PDFdictGradients,i,id,id,"")}else Collapse("PDFStrokeGradient: gradient ["+t+"] not found")}function A(e,t,r){v(e,t,r,!0)&&(d(e,"PDFFillColor "+t),l(e,"rg"))}function L(e,t){t&&t.length>0&&(d(e,"PDFLineCap "+t),stricmp(t,"butt")||l(e,"0 J"),stricmp(t,"round")||l(e,"1 J"),stricmp(t,"square")||l(e,"2 J"))}function G(e,t){"none"!=t&&t.length>0}function E(e){for(var t="",r=0;r<e.length;){switch(e.substring(r,r+1)){case 10:t+="\\n";break;case 13:t+="\\r";break;case 9:t+="\\t";break;case"(":t+="\\(";break;case")":t+="\\)";break;case"\\":t+="\\\\";break;default:t+=e.substring(r,r+1)}r++}return t}function _(e){d(e,"PDFStartTextObject"),y(e),l(e,"BT")}function z(e){d(e,"PDFEndTextObject"),l(e,"ET"),c(e)}function R(e,t,r){d(e,"PDFTextMoveTo"+t+" "+r),l(e,"1 0 0 -1 "+t+" "+r+" Tm",t,r)}function N(e,t,r){d(e,"PDFTextFontNameAndSize ("+t+")  size : "+r),t.length&&l(e,"/"+t+" "+r+" Tf",t,r)}function O(e,t){t=E(t),d(e,"PDFTextShow ("+t+")"),l(e,"("+t+") Tj")}function B(e,t){"none"!=t&&t.length>0&&(d(e,"PDFLineWidth "+t),l(e,t+" w"))}function U(e){d(e,"PDFEndPathNoPaint"),l(e,"n")}function H(e){d(e,"PDFClosePath"),l(e,"h")}function W(e){d(e,"PDFClip"),l(e,"W")}function j(e){d(e,"PDFFill"),l(e,"f")}function K(e){d(e,"PDFStroke"),l(e,"S")}function $(e){d(e,"PDFFillAndStroke"),l(e,"B")}function V(e){d(e,"PDFForgetPath"),l(e,"n")}function Q(e,t,o,a,i,n,s){d(e,"PDFCurve"),f(e,t),f(e,o),f(e,a),f(e,i),f(e,n),f(e,s),l(e,"c"),r(t,o),r(a,i),r(n,s),Ee=n,_e=s}function Y(e,t,o,a,i,n,s){d(e,"PDFCurveRel"),f(e,Ee+t),f(e,_e+o),f(e,Ee+a),f(e,_e+i),f(e,Ee+n),f(e,_e+s),l(e,"c"),r(Ee+t,_e+o),r(Ee+a,_e+i),r(Ee+n,_e+s),Ee+=n,_e+=s}function X(e,t,r,o,a){d(e,"PDFRect "+t+" "+r+" "+o+" "+a),f(e,t),f(e,r),f(e,o),f(e,a),l(e,"re")}function Z(e,t,r,o,a){var i,n,s,l,y,c;d(e,"PDFEllipse "+t+" "+r+" "+o+" "+a),t=parseInt(t),r=parseInt(r),o=parseInt(o),a=parseInt(a),s=t-o,l=r-a,y=t+o,c=r+a,i=parseInt(t),n=parseInt(r),o=.552284749831*parseInt(o),a=.552284749831*parseInt(a),k(e,i,l),Q(e,i+o,l,y,n-a,y,n),Q(e,y,n+a,i+o,c,i,c),Q(e,i-o,c,s,n+a,s,n),Q(e,s,n-a,i-o,l,i,l)}function J(e,t,r,o,a,i){encoded=de(t,Le),l(e,"<</Length "+encoded.length+" /Type /XObject /Subtype /Image /Width "+r+" /Height "+o+" /BitsPerComponent 8 "+Le),a?l(e,"/ColorSpace /DeviceRGB "):l(e,"/ColorSpace /DeviceGray "),i&&l(e,"/SMask "+i+" 0 R"),l(e," >> "),h(e,encoded)}function q(e,t){var r,a,i=0;return r=o(),a=de(t,Ge),l(e,"<</Length "+a.length+" /Type /XObject /Subtype /Form /BBox ["+r.left+" "+r.top+" "+r.right+" "+r.bottom+" ] /Matrix [1 0 0 1 0 0]   >> "),h(e,a),i}function ee(e,t,r,o,a){d(e,"Font definition : "+t),l(e,"<< /Type /Font /Subtype /"+o+" /Name /"+r+" /BaseFont /"+t+" "+a+" >> ")}function te(e,t,r,o,a,i,n){var s,l=[];s="Image"+ ++Oe,MyrPDFDict.PDFAddEntry($e,s,s,t,0),y(e),PMatrixSet(e,i,0,0,-n,o,a+n,l),P(e,l),re(e,s),c(e)}function re(e,t){l(e,"/"+t+" Do")}function oe(){l(null,"%PDF-1.4"),l(null,"%####")}function ae(e,t){for(;Xe.data.indexOf(e)>=0;)Xe.data=Xe.data.replace(e,t)}function ie(e,t){ae(e,t.toString())}function ne(e,t,r,o){var a,i,n=MyrPDFDict.PDFNbEntryDict(e),s={};if(s.data="",n>0){for(l(s,"/"+t+" << "),a=0;n>a;a++)i=o===!0?e[a].data:e[a].id,l(s,"/"+i+" "+e[a].val1+" 0 R ");l(s," >> "),d(s,"End dict "+t)}ae(r,s.data)}function se(e){var t;for(0>e&&(e=4294967295+e+1),t=e.toString(16).toUpperCase();t.length<2;)t="0"+t;return t}function le(e,t){for(var r="",o=0;o<e.length;){for(i=0;i<t&&o<e.length;i++,o++)r+=se(e.charCodeAt(o));o<e.length&&(r+=" ")}return r}function de(e,t){var r;return t===Te?r=e:t===Ie&&(r=le(e,3)),r}function ye(e,t){var r,o=-1,a={},i=[];return d(null,"######################## PAGE CONTENT ########################"),o=m(),a.data="",PMatrixIdentity(e,i),PMatrixTranslate(e,ze*Se,t.bottom*Se,i),PMatrixScale(e,.6,-0.6,i),P(a,i),g(e.data,a),r=de(a.data,Ae),l(null,"<< /Length "+r.length+" "+Ae+" >> "),h(null,r),M(),o}function ce(e,t){var r=-1,o={},a={};return o.data=e,o.posData=0,a=SVGConvertDataToPDF(o,"","",!1,!0),a.data.length&&(r=ye(a,t)),r}function ue(e){var t;return d(null,"######################## PAGE ########################"),t=m(),Ye.push(t),l(null,"<< /Type /Page "),l(null,"/Parent $POSPAGES$ 0 R "),d(null,"Real media size "+e.right+"x"+e.bottom),l(null,"/MediaBox [ 0 0 "+e.right*Se+" "+e.bottom*Se+" ]"),l(null,"/Contents $POSCONTENTS$ 0 R "),l(null," >> "),M(),Ze=[Se,0,0,-0.6,ze*Se,e.bottom*Se],t}function fe(e){ie("$POSCONTENTS$",e)}function me(e,t){var r;return r=ue(t),r=ce(e,t),fe(r),r>=0}function Me(e,t,r,o){var a;return a=m(),ee(null,e,t,r,o),MyrPDFDict.PDFAddEntry(He,e,t,a,0),M(),a}function pe(){var e,t;for(d(null,"######################## PAGES LIST ########################"),t=m(),l(null,"<< /Type /Pages "),l(null,"/Count "+Ye.length+" "),s(null,"/Kids ["),e=0;e<Ye.length;e++)s(null,Ye[e]+" 0 R ");return l(null,"] "),l(null,"/Resources << /ProcSet [/PDF /Text /ImageC /ImageI /ImageB ] "),l(null,"$FONTDICT$ "),l(null,"$XOBJECTS$ "),l(null,"$PATTERN$ "),l(null," >> "),l(null," >> "),M(),ie("$POSPAGES$",t),ie("$POSRESOURCES$",Ne-1),MyrPDFDict.PDFAddDict(We,$e),ne(He,"Font","$FONTDICT$",!0),ne($e,"XObject","$XOBJECTS$",!1),ne(je,"Pattern","$PATTERN$",!1),t}function ge(e){var t;return d(null,"######################## CATALOG ########################"),t=m(),l(null,"<< /Type /Catalog "),l(null,"/Pages "+e+" 0 R >> "),d(null,"End catalog"),M(),t}function he(){for(var e=[],t=0,r=0,o=Xe.data;r<o.length;){if(" obj"==o.substring(r,r+4)){for(var a=r,i=!0,n=0;o.substring(r-1,r)>=" "&&r>=0&&i;)" "===o.substring(r,r+1)?++n>2&&(i=!1):o.substring(r,r+1)<"0"?i=!1:o.substring(r,r+1)>"9"&&(i=!1),r--;i&&(e.push(r),t++),r=a}r++}return t!=Ne&&console.log("PDFRebuildXRef err, number of objects don't match."),e}function ve(e,t){var r,o,a=he();for(d(null,"######################## XREF ########################"),r=p(null),l(null,"xref"),l(null,"0 "+(Ne+1)),l(null,"0000000000 65535 f "),o=0;Ne>o;o++)l(null,a[o]+" 00000 n ");l(null,"trailer << "),l(null,"/Size "+(Ne+1)+" "),l(null,"/Root "+e+" 0 R "),t&&l(null,"/Info "+t+" 0 R ",t),l(null," >> "),l(null,"startxref"),l(null,r),l(null,"%%EOF")}function be(){MyrPDFDict.PDFDisposeDict(He),MyrPDFDict.PDFDisposeDict(We),MyrPDFDict.PDFDisposeDict(je),MyrPDFDict.PDFDisposeDict(Ke),MyrPDFDict.PDFDisposeDict($e),MyrPDFDict.PDFDisposeDict(Ve),MyrPDFDict.PDFDisposeDict(Qe)}function xe(){be(),Ne=0,Oe=0,Ee=_e=0,a(0,0),Be=0,Ee=_e=0,Xe={},Xe.name="PDF Stream",Xe.data="",Ye=[],oe()}function De(e){d(null,"######################## FOOTER ########################"),ve(ge(pe()),e),l(null,"%____ SvgToPdf Javascript converter "+Ce+" ____"),l(null,"%____ (c) MYRIAD Software myriad-online.com 2017 ____"),l(null,"%____ "+Date()+" ____")}function Pe(e){return De(0),Xe.data}function ke(){be(),Ye=[],Xe.data=""}var we=!0,Fe=0,Ce="1.0.0";const Se=.6,Te="",Ie="/Filter /ASCIIHexDecode",Ae=Te,Le=Ie,Ge=Te;var Ee,_e,ze,Re,Ne,Oe,Be,Ue={},He=[],We=[],je=[],Ke=[],$e=[],Ve=[],Qe=[],Ye=[],Xe={},Ze=[1,0,0,1,0,0],Je=[];MyrPDF.PDFInit=xe,MyrPDF.PDFValidate=Pe,MyrPDF.PDFAddPosObject=m,MyrPDF.PDFBuildPage=me,MyrPDF.PDFBuildPageContent=ce,MyrPDF.PDFOpenPage=ue,MyrPDF.PDFClosePage=fe,MyrPDF.PDFDispose=ke,MyrPDF.PDFBuildFooter=De,MyrPDF.PDFComment=d,MyrPDF.PDFAddFont=Me,MyrPDF.PDFStartTextObject=_,MyrPDF.PDFTextFontNameAndSize=N,MyrPDF.PDFTextMoveTo=R,MyrPDF.PDFTextShow=O,MyrPDF.PDFEndTextObject=z,MyrPDF.PDFFillColor=A,MyrPDF.PDFStrokeColor=S,MyrPDF.PDFPushContext=y,MyrPDF.PDFPushContext=y,MyrPDF.PDFPopContext=c,MyrPDF.PDFOpacity=G,MyrPDF.PDFClearBBox=t,MyrPDF.PDFGetBBox=o,MyrPDF.PDFSetOffset=a,MyrPDF.PDFLineWidth=B,MyrPDF.PDFLineCap=L,MyrPDF.PDFMoveTo=k,MyrPDF.PDFMoveRel=w,MyrPDF.PDFLineTo=F,MyrPDF.PDFLineRel=C,MyrPDF.PDFCurve=Q,MyrPDF.PDFCurveRel=Y,MyrPDF.PDFStroke=K,MyrPDF.PDFClip=W,MyrPDF.PDFEndPathNoPaint=U,MyrPDF.PDFFillAndStroke=$,MyrPDF.PDFFill=j,MyrPDF.PDFStroke=K,MyrPDF.PDFForgetPath=V,MyrPDF.PDFRect=X,MyrPDF.PDFEllipse=Z,MyrPDF.PDFClosePath=H,MyrPDF.PDFEndPosObject=M,MyrPDF.PDFMatrixWrite=P,MyrPDF.PDFWriteDo=re,MyrPDF.PDFWritePageContent=ye,MyrPDF.PDFWriteNoRc=s,MyrPDF.PDFWriteForm=q,MyrPDF.PDFWriteGradient=T,MyrPDF.PDFWriteStreamImageAndFreeSource=J,MyrPDF.PDFWriteImage=te,MyrPDF.PDFdictFonts=He,MyrPDF.PDFdictPaths=We,MyrPDF.PDFdictGradients=je,MyrPDF.PDFdictSVGGradients=Ke,MyrPDF.PDFdictClip=Ve}(),!MyrZip)var MyrZip={author:"Myriad"};!function(){MyrZip.UnzipBlock=function(e,t,r,o){"use strict";function a(e,t){for(32==t?e.bitbuf=0:e.bitbuf=e.bitbuf<<t>>>0;t>e.bitcount;)e.bitbuf|=e.subbitbuf<<(t-=e.bitcount)>>>0,e.ridx!=e.rsize?e.subbitbuf=e.rdata[e.ridx++]:e.subbitbuf=0,e.bitcount=p;e.bitbuf|=e.subbitbuf>>>(e.bitcount-=t),e.bitbuf>>>=0}function i(e,t){var r;return 0===t?0:(r=e.bitbuf>>>h-t,a(e,t),r)}function n(e){e.bitbuf=0,e.subbitbuf=0,e.bitcount=0,a(e,h)}function s(e,t,r,o,a){var i,n,s,l,d,y,c,u,f,m,M=[],p=[],g=[];for(s=1;16>=s;s++)M[s]=0;for(s=0;t>s;s++)M[r[s]]++;for(g[1]=0,s=1;16>=s;s++)g[s+1]=g[s]+(M[s]<<16-s&65535)&65535;for(0!==g[17]&&alert("Bad table"),c=16-o,s=1;o>=s;s++)g[s]>>=c,p[s]=1<<o-s&65535;for(;16>=s;)p[s]=1<<16-s&65535,s++;if(s=g[o+1]>>c,65536!=s)for(l=1<<o&65535;s!=l;)a[s++]=0;for(u=t,m=1<<15-o,y=0;t>y;y++)if(0!==(d=r[y])){if(f=g[d]+p[d]>>>0,o>=d)for(s=g[d];f>s;s++)a[s]=y;else{for(l=g[d],i=a,n=l>>>c,s=d-o;0!==s;)0===i[n]&&(e.right[u]=e.left[u]=0,i[n]=u++),l&m?(n=i[n],i=e.right):(n=i[n],i=e.left),l=l<<1>>>0,s--;i[n]=y}g[d]=f}}function l(e,t,r,o){var n,l,d,y;if(d=i(e,r),0===d){for(l=i(e,r),n=0;t>n;n++)e.pt_len[n]=0;for(n=0;256>n;n++)e.pt_table[n]=l}else{for(n=0;d>n;){if(l=e.bitbuf>>>h-3,7==l)for(y=1<<h-1-3>>>0;y&e.bitbuf;)y>>>=1,l++;if(a(e,7>l?3:l-3),e.pt_len[n++]=l,n==o)for(l=i(e,2);--l>=0;)e.pt_len[n++]=0}for(;t>n;)e.pt_len[n++]=0;s(e,t,e.pt_len,8,e.pt_table)}}function d(e){var t,r,o,n;if(o=i(e,k),0===o){for(r=i(k),t=0;P>t;t++)e.c_len[t]=0;for(t=0;4096>t;t++)e.c_table[t]=r}else{for(t=0;o>t;){if(r=e.pt_table[e.bitbuf>>>h-8],r>=C){n=1<<h-1-8>>>0;do r=e.bitbuf&n?e.right[r]:e.left[r],n>>>=1;while(r>=C)}if(a(e,e.pt_len[r]),2>=r)for(r=0===r?1:1===r?i(e,4)+3:i(e,k)+20;--r>=0;)e.c_len[t++]=0;else e.c_len[t++]=r-2}for(;P>t;)e.c_len[t++]=0;s(e,P,e.c_len,12,e.c_table)}}function y(e){var t,r;if(0===e.blocksize&&(e.blocksize=i(e,16),l(e,C,T,3),d(e),l(e,F,S,-1)),e.blocksize--,t=e.c_table[e.bitbuf>>>h-12],t>=P){r=1<<h-1-12>>>0;do t=e.bitbuf&r?e.right[t]:e.left[t],r>>>=1;while(t>=P)}return a(e,e.c_len[t]),t}function c(e){var t,r;if(t=e.pt_table[e.bitbuf>>>h-8],t>=F){r=1<<h-1-8>>>0;do t=e.bitbuf&r?e.right[t]:e.left[t],r>>>=1;while(t>=F)}return a(e,e.pt_len[t]),0!==t&&(t=(1<<t-1)+i(e,t-1)>>>0),t}function u(e){n(e),e.blocksize=0}function f(e,t){var r;for(r=0;t>r&&--e.j>=0;)e.buffer[r]=e.buffer[e.i],e.i=e.i+1&b-1,r++;for(;t>r;)if(e.c=y(e),e.c<=g)e.buffer[r]=e.c,r++;else for(e.j=e.c-(g+1-x),e.i=r-c(e)-1&b-1;t>r&&--e.j>=0;)e.buffer[r]=e.buffer[e.i],e.i=e.i+1&b-1,r++;return r}var m,M={},p=8,g=255,h=4*p,v=13,b=1<<v,x=3,D=256,P=g+D+2-x,k=9,w=16,F=v+1,C=w+3,S=4,T=5;for(m=C>F?C:F,M.rdata=e,M.ridx=t,M.rsize=r+t,M.wdata=new Uint8Array(o),M.widx=0,M.wsize=o,M.buffer=new Uint8Array(b),M.j=M.i=0,M.left=new Int16Array(2*P-1),M.right=new Int16Array(2*P-1),M.c_len=new Uint8Array(P),M.pt_len=new Uint8Array(m),M.blocksize=0,M.c_table=new Int16Array(4096),M.c_code=new Int16Array(P),M.pt_table=new Int16Array(256),u(M);M.widx<M.wsize;){var I=M.wsize-M.widx>b?b:M.wsize-M.widx;if(f(M,I),I==b)M.wdata.set(M.buffer,M.widx),M.widx+=I;else for(var A=0;I>A;A++)M.wdata[M.widx++]=M.buffer[A]}M.buffer=null,M.left=null,M.right=null,M.c_len=null,M.pt_len=null,M.c_table=null,M.c_code=null;var L=M.wdata;return M.ridx==M.rsize&&M.widx==M.wsize||alert("Error unzipblock"),M=null,L}}();var PNG_COLOR_TYPE_GREYSCALE=0,PNG_COLOR_TYPE_TRUECOLOR=2,PNG_COLOR_TYPE_INDEXEDCOLOR=3,PNG_COLOR_TYPE_GREYSCALE_ALPHA=4,PNG_COLOR_TYPE_TRUECOLOR_ALPHA=6,PNG_FILTER_NONE=0,PNG_FILTER_SUB=1,PNG_FILTER_UP=2,PNG_FILTER_AVERAGE=3,PNG_FILTER_PAETH=4;if(!MyrPNG)var MyrPNG={author:"Didier Guillion",name:"PNG file format"};if(function(){function e(e){var t,r="";for(t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r}function t(e){var t,r=new Uint8Array(e.length);for(t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}function r(e){switch(e){case PNG_COLOR_TYPE_GREYSCALE:return 1;case PNG_COLOR_TYPE_TRUECOLOR:return 3;case PNG_COLOR_TYPE_INDEXEDCOLOR:return 1;case PNG_COLOR_TYPE_GREYSCALE_ALPHA:return 3;case PNG_COLOR_TYPE_TRUECOLOR_ALPHA:return 4}return 0}function o(e,t){var r,o=new Uint8Array(t);for(r=0;t>r;r++)o[r]=e.data[e.pos],e.pos++;
return o}function a(e){var t=o(e,1);return t[0]}function i(e){var t,r=0;for(t=0;4>t;t++)r=256*r+a(e);return r}function n(e){var t;for(t=0;8>t;t++)if(e[t]!=y[t])return!1;return!0}function s(e){var r,s,l,d,y,g,h,v={},b=0,x=!0,D={};if(v.data="",v.uncompressedDataSize=-1,v.aire={},SetBigRect(v.aire,0,0,0,0),v.colorType=0,v.bitDepth=0,v.palette=null,v.messErr="",v.interlaceMethod=0,v.compressionMethod=0,v.filterMethod=0,D.data=t(e),D.pos=0,d=o(D,8),n(d))for(;D.pos<D.data.length&&b!=m&&x===!0;){switch(s=i(D),b=i(D),r=D.pos,b){case c:v.aire.right=i(D),v.aire.bottom=i(D),v.bitDepth=a(D),8!=v.bitDepth&&1!=v.bitDepth&&4!=v.bitDepth&&(v.messErr="bad bitDepth: "+bitDepth,x=!1),v.colorType=a(D),v.compressionMethod=a(D),v.filterMethod=a(D),v.interlaceMethod=a(D),0!==v.interlaceMethod&&(v.messErr="bad interlace",x=!1);break;case f:v.data=o(D,s);break;case u:v.palette=o(D,s);break;case M:y=i(D),g=i(D),h=a(D);break;case p:v.uncompressedDataSize=i(D)}D.pos=r+s,l=i(D)}else v.messErr="bad header";return v.colorType==PNG_COLOR_TYPE_INDEXEDCOLOR&&null===v.palette&&(v.messErr="PNG_COLOR_TYPE_INDEXEDCOLOR with no PLTE chunk"),v}function l(e,t,o,a){var i,n,s,l,d,y,c,u,f,m,M,p,g,h,v="",b=0;for(g=r(a),h=g*t,v=new Uint8Array(h*o),n=0;o>n;n++)for(s=e[b++],d=h*n,i=0;h>i;i++){switch(l=e[b++],s){case PNG_FILTER_NONE:break;case PNG_FILTER_SUB:i>=g&&(l+=v[d-g]);break;case PNG_FILTER_UP:n>0&&(l+=v[d-h]);break;case PNG_FILTER_AVERAGE:y=i>=g?v[d-g]:0,c=n>0?v[d-h]:0,l+=(y+c)/2;break;case PNG_FILTER_PAETH:y=i>=g?v[d-g]:0,c=n>0?v[d-h]:0,u=i>=g&&n>0?v[d-h-g]:0,f=y+c-u,m=abs(f-y),M=abs(f-c),p=abs(f-u),l+=M>=m&&p>=m?y:p>=M?c:u;break;default:return v}v[d++]=l}return v}function d(t,r,o){var a,i,n,s,l={},d=0;for(n=new Uint8Array(r*o*3),s=new Uint8Array(r*o*1),i=0;o>i;i++)for(a=0;r>a;a++)n[3*i*r+3*a]=t[d++],n[3*i*r+3*a+1]=t[d++],n[3*i*r+3*a+2]=t[d++],s[i*r+a]=t[d++];return l.rgbdata=e(n),l.maskdata=e(s),l}var y=[137,80,78,71,13,10,26,10],c=1229472850,u=1347175749,f=1229209940,m=1229278788,M=1883789683,p=1936292453;MyrPNG.PNGSplitRGBandAlpha=d,MyrPNG.PNGDecodeIDAT=l,MyrPNG.PNGDecode=s,MyrPNG.IsPNGSignature=n,MyrPNG.CvtUint8toString=e,MyrPNG.CvtStringToUint8=t}(),PNGSplitRGBandAlpha=MyrPNG.PNGSplitRGBandAlpha,PNGDecodeIDAT=MyrPNG.PNGDecodeIDAT,PNGDecode=MyrPNG.PNGDecode,IsPNGSignature=MyrPNG.IsPNGSignature,!MyrLZ77)var MyrLZ77={author:"LZ77"};if(function(){var e,t,r,o,a,i,n,s,l,d,y,c,u,f,m,M,p,g=32768,h=0,v=9,b=6,x=null,D=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535),P=new Array(3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0),k=new Array(0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99),w=new Array(1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577),F=new Array(0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13),C=new Array(16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15),S=function(){this.next=null,this.list=null},T=function(){this.e=0,this.b=0,this.n=0,this.t=null},I=function(e,t,r,o,a,i){this.BMAX=16,this.N_MAX=288,this.status=0,this.root=null,this.m=0;var n,s,l,d,y,c,u,f,m,M,p,g,h,v,b,x,D,P=new Array(this.BMAX+1),k=new Array(this.BMAX+1),w=new T,F=new Array(this.BMAX),C=new Array(this.N_MAX),I=new Array(this.BMAX+1);for(D=this.root=null,c=0;c<P.length;c++)P[c]=0;for(c=0;c<k.length;c++)k[c]=0;for(c=0;c<F.length;c++)F[c]=null;for(c=0;c<C.length;c++)C[c]=0;for(c=0;c<I.length;c++)I[c]=0;s=t>256?e[256]:this.BMAX,m=e,M=0,c=t;do P[m[M]]++,M++;while(--c>0);if(P[0]==t)return this.root=null,this.m=0,void(this.status=0);for(u=1;u<=this.BMAX&&0==P[u];u++);for(f=u,u>i&&(i=u),c=this.BMAX;0!=c&&0==P[c];c--);for(d=c,i>c&&(i=c),v=1<<u;c>u;u++,v<<=1)if((v-=P[u])<0)return this.status=2,void(this.m=i);if((v-=P[c])<0)return this.status=2,void(this.m=i);for(P[c]+=v,I[1]=u=0,m=P,M=1,h=2;--c>0;)I[h++]=u+=m[M++];m=e,M=0,c=0;do 0!=(u=m[M++])&&(C[I[u]++]=c);while(++c<t);for(t=I[d],I[0]=c=0,m=C,M=0,y=-1,g=k[0]=0,p=null,b=0;d>=f;f++)for(n=P[f];n-- >0;){for(;f>g+k[1+y];){if(g+=k[1+y],y++,b=(b=d-g)>i?i:b,(l=1<<(u=f-g))>n+1)for(l-=n+1,h=f;++u<b&&!((l<<=1)<=P[++h]);)l-=P[h];for(g+u>s&&s>g&&(u=s-g),b=1<<u,k[1+y]=u,p=new Array(b),x=0;b>x;x++)p[x]=new T;D=null==D?this.root=new S:D.next=new S,D.next=null,D.list=p,F[y]=p,y>0&&(I[y]=c,w.b=k[y],w.e=16+u,w.t=p,u=(c&(1<<g)-1)>>g-k[y],F[y-1][u].e=w.e,F[y-1][u].b=w.b,F[y-1][u].n=w.n,F[y-1][u].t=w.t)}for(w.b=f-g,M>=t?w.e=99:m[M]<r?(w.e=m[M]<256?16:15,w.n=m[M++]):(w.e=a[m[M]-r],w.n=o[m[M++]-r]),l=1<<f-g,u=c>>g;b>u;u+=l)p[u].e=w.e,p[u].b=w.b,p[u].n=w.n,p[u].t=w.t;for(u=1<<f-1;0!=(c&u);u>>=1)c^=u;for(c^=u;(c&(1<<g)-1)!=I[y];)g-=k[y],y--}this.m=k[1],this.status=0!=v&&1!=d?1:0},A=function(){return M.length==p?-1:M[p++]},L=function(e){for(;e>n;)i|=A()<<n,n+=8},G=function(e){return i&D[e]},E=function(e){i>>=e,n-=e},_=function(r,o,a){var i,n,l;if(0==a)return 0;for(l=0;;){for(L(f),n=c.list[G(f)],i=n.e;i>16;){if(99==i)return-1;E(n.b),i-=16,L(i),n=n.t[G(i)],i=n.e}if(E(n.b),16!=i){if(15==i)break;for(L(i),d=n.n+G(i),E(i),L(m),n=u.list[G(m)],i=n.e;i>16;){if(99==i)return-1;E(n.b),i-=16,L(i),n=n.t[G(i)],i=n.e}for(E(n.b),L(i),y=t-n.n-G(i),E(i);d>0&&a>l;)d--,y&=g-1,t&=g-1,r[o+l++]=e[t++]=e[y++];if(l==a)return a}else if(t&=g-1,r[o+l++]=e[t++]=n.n,l==a)return a}return s=-1,l},z=function(r,o,a){var l;if(l=7&n,E(l),L(16),l=G(16),E(16),L(16),l!=(65535&~i))return-1;for(E(16),d=l,l=0;d>0&&a>l;)d--,t&=g-1,L(8),r[o+l++]=e[t++]=G(8),E(8);return 0==d&&(s=-1),l},R=function(e,t,i){if(null==x){var n,s,l=new Array(288);for(n=0;144>n;n++)l[n]=8;for(;256>n;n++)l[n]=9;for(;280>n;n++)l[n]=7;for(;288>n;n++)l[n]=8;if(o=7,s=new I(l,288,257,P,k,o),0!=s.status)return alert("HufBuild error: "+s.status),-1;for(x=s.root,o=s.m,n=0;30>n;n++)l[n]=5;if(a=5,s=new I(l,30,0,w,F,a),s.status>1)return x=null,alert("HufBuild error: "+s.status),-1;r=s.root,a=s.m}return c=x,u=r,f=o,m=a,_(e,t,i)},N=function(e,t,r){var o,a,i,n,s,l,d,y,M,p=new Array(316);for(o=0;o<p.length;o++)p[o]=0;if(L(5),d=257+G(5),E(5),L(5),y=1+G(5),E(5),L(4),l=4+G(4),E(4),d>286||y>30)return-1;for(a=0;l>a;a++)L(3),p[C[a]]=G(3),E(3);for(;19>a;a++)p[C[a]]=0;if(f=7,M=new I(p,19,19,null,null,f),0!=M.status)return-1;for(c=M.root,f=M.m,n=d+y,o=i=0;n>o;)if(L(f),s=c.list[G(f)],a=s.b,E(a),a=s.n,16>a)p[o++]=i=a;else if(16==a){if(L(2),a=3+G(2),E(2),o+a>n)return-1;for(;a-- >0;)p[o++]=i}else if(17==a){if(L(3),a=3+G(3),E(3),o+a>n)return-1;for(;a-- >0;)p[o++]=0;i=0}else{if(L(7),a=11+G(7),E(7),o+a>n)return-1;for(;a-- >0;)p[o++]=0;i=0}if(f=v,M=new I(p,d,257,P,k,f),0==f&&(M.status=1),0!=M.status)return 1==M.status,-1;for(c=M.root,f=M.m,o=0;y>o;o++)p[o]=p[o+d];return m=b,M=new I(p,y,0,w,F,m),u=M.root,m=M.m,0==m&&d>257?-1:(1==M.status,0!=M.status?-1:_(e,t,r))},O=function(){null==e&&(e=new Array(2*g)),t=0,i=0,n=0,s=-1,l=!1,d=y=0,c=null},B=function(r,o,a){var i,n;for(i=0;a>i;){if(l&&-1==s)return i;if(d>0){if(s!=h)for(;d>0&&a>i;)d--,y&=g-1,t&=g-1,r[o+i++]=e[t++]=e[y++];else{for(;d>0&&a>i;)d--,t&=g-1,L(8),r[o+i++]=e[t++]=G(8),E(8);0==d&&(s=-1)}if(i==a)return i}if(-1==s){if(l)break;L(1),0!=G(1)&&(l=!0),E(1),L(2),s=G(2),E(2),c=null,d=0}switch(s){case 0:n=z(r,o+i,a-i);break;case 1:n=null!=c?_(r,o+i,a-i):R(r,o+i,a-i);break;case 2:n=null!=c?_(r,o+i,a-i):N(r,o+i,a-i);break;default:n=-1}if(-1==n)return l?0:-1;i+=n}return i};MyrLZ77.inflate=function(e,t){var r,o;O(),M=e,p=t;for(var a=new Uint8Array(1024),i=[],n=0;(r=B(a,0,a.length))>0;){n+=r;var s=new Uint8Array(r);if(1024==r)s.set(a,0);else for(o=0;r>o;o++)s[o]=a[o];i.push(s)}M=null,a=null;var l=new Uint8Array(n),d=0;for(r=0;r<i.length;r++)l.set(i[r],d),d+=i[r].length,i[r]=null;return l}}(),!MyrStdLib)var MyrStdLib={author:"Didier Guillion",name:"CLib"};if(function(){function e(e){return e>0?e:-e}function t(e){return parseInt(e)}function r(e){return parseFloat(e)}function o(e,t){alert("strstr not implemented use strexist (or other)")}function a(e,t){return e.indexOf(t)>=0}function i(e,t){return e!=t}function n(e,t){return e.toUpperCase()!=t.toUpperCase()}function s(e,t,r){return e.substring(0,r)!=t.substring(0,r)}function l(e,t){return e.toLowerCase()!=t.toLowerCase()}MyrStdLib.abs=e,MyrStdLib.atol=t,MyrStdLib.atof=r,MyrStdLib.strstr=o,MyrStdLib.strexist=a,MyrStdLib.strcmp=i,MyrStdLib.stricmp=n,MyrStdLib.strncmp=s,MyrStdLib.strcasecmp=l}(),abs=MyrStdLib.abs,atol=MyrStdLib.atol,atof=MyrStdLib.atof,strstr=MyrStdLib.strstr,strexist=MyrStdLib.strexist,strcmp=MyrStdLib.strcmp,stricmp=MyrStdLib.stricmp,strncmp=MyrStdLib.strncmp,strcasecmp=MyrStdLib.strcasecmp,!MyrUnicode)var MyrUnicode={author:"Didier Guillion",name:"Unicode Converter"};!function(){function e(e){var t;if(128>e)return e;for(t=0;t<r.length;t++)if(r[t]==e)return t+128;return"?"}function t(t){var r,o="";for(r=0;r<t.length;r++)o+=String.fromCharCode(e(t.charCodeAt(r)));return o}const r=[196,197,199,201,209,214,220,225,224,226,228,227,229,231,233,232,234,235,237,236,238,239,241,243,242,244,246,245,250,249,251,252,8224,176,162,163,167,8226,182,223,174,169,8482,180,168,8800,198,216,8734,177,8804,8805,165,181,8706,8721,8719,960,8747,170,186,937,230,248,191,161,172,8730,402,8776,8710,171,187,8230,160,192,195,213,338,339,8211,8212,8220,8221,8216,8217,247,9674,255,376,8260,8364,8249,8250,64257,64258,8225,183,8218,8222,8240,194,202,193,203,200,205,206,207,204,211,212,63743,210,218,219,217,305,710,732,175,728,729,730,184,733,731,711];MyrUnicode.CharUnicodeToMacRoman=e,MyrUnicode.UnicodeToMacRoman=t}(),CharUnicodeToMacRoman=MyrUnicode.CharUnicodeToMacRoman,UnicodeToMacRoman=MyrUnicode.UnicodeToMacRoman;
//# sourceMappingURL=http://192.168.0.5/Developt/Maps/myrweb.map